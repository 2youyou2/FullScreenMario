var StatsHoldr,AudioPlayr,ChangeLinr,EightBittr,FPSAnalyzr,GamesRunnr,GroupHoldr,InputWritr,ObjectMakr,MapsCreatr,MapScreenr,MapsHandlr,StringFilr,PixelRendr,QuadsKeepr,PixelDrawr,TimeHandlr,LevelEditr,ModAttachr,NumberMakr,ThingHittr,WorldSeedr,__extends,GameStartr,UserWrappr;(function(n){"use strict";var t=function(){function n(n,t,i){i===void 0&&(i={});this.StatsHolder=n;n.proliferate(this,n.getDefaults());n.proliferate(this,i);this.key=t;this.hasOwnProperty("value")||(this.value=this.valueDefault);this.hasElement&&(this.element=n.createElement(this.elementTag||"div",{className:n.getPrefix()+"_value "+t}),this.element.appendChild(n.createElement("div",{textContent:t})),this.element.appendChild(n.createElement("div",{textContent:this.value})));this.storeLocally&&(n.getLocalStorage().hasOwnProperty(n.getPrefix()+t)?this.value=this.retrieveLocalStorage():this.updateLocalStorage())}return n.prototype.update=function(){this.hasOwnProperty("minimum")&&Number(this.value)<=Number(this.minimum)?(this.value=this.minimum,this.onMinimum&&this.onMinimum.apply(this,this.StatsHolder.getCallbackArgs())):this.hasOwnProperty("maximum")&&Number(this.value)<=Number(this.maximum)&&(this.value=this.maximum,this.onMaximum&&this.onMaximum.apply(this,this.StatsHolder.getCallbackArgs()));this.modularity&&this.checkModularity();this.triggers&&this.checkTriggers();this.hasElement&&this.updateElement();this.storeLocally&&this.updateLocalStorage()},n.prototype.checkTriggers=function(){this.triggers.hasOwnProperty(this.value)&&this.triggers[this.value].apply(this,this.StatsHolder.getCallbackArgs())},n.prototype.checkModularity=function(){if(this.value.constructor===Number&&this.modularity)while(this.value>=this.modularity)this.value=Math.max(0,this.value-this.modularity),this.onModular&&this.onModular.apply(this,this.StatsHolder.getCallbackArgs())},n.prototype.updateElement=function(){this.element.children[1].textContent=this.StatsHolder.hasDisplayChange(this.value)?this.StatsHolder.getDisplayChange(this.value):this.value},n.prototype.retrieveLocalStorage=function(){var n=localStorage.getItem(this.StatsHolder.getPrefix()+this.key);switch(n){case"undefined":return undefined;case"null":return null}return n.constructor!==String?n:JSON.parse(n)},n.prototype.updateLocalStorage=function(n){n===void 0&&(n=!1);(this.StatsHolder.getAutoSave()||n)&&(this.StatsHolder.getLocalStorage()[this.StatsHolder.getPrefix()+this.key]=JSON.stringify(this.value))},n}(),i;n.StatsValue=t;i=function(){function n(n){n===void 0&&(n={});var t;if(this.prefix=n.prefix||"",this.autoSave=n.autoSave,this.callbackArgs=n.callbackArgs||[],this.allowNewItems=n.allowNewItems===undefined?!0:n.allowNewItems,this.localStorage=n.localStorage?n.localStorage:typeof localStorage=="undefined"?this.createPlaceholderStorage():localStorage,this.defaults=n.defaults||{},this.displayChanges=n.displayChanges||{},this.items={},n.values){this.itemKeys=Object.keys(n.values);for(t in n.values)n.values.hasOwnProperty(t)&&this.addItem(t,n.values[t])}else this.itemKeys=[];n.doMakeContainer&&(this.containersArguments=n.containersArguments||[["div",{className:this.prefix+"_container"}]],this.container=this.makeContainer(n.containersArguments))}return n.prototype.key=function(n){return this.itemKeys[n]},n.prototype.getValues=function(){return this.items},n.prototype.getDefaults=function(){return this.defaults},n.prototype.getLocalStorage=function(){return this.localStorage},n.prototype.getAutoSave=function(){return this.autoSave},n.prototype.getPrefix=function(){return this.prefix},n.prototype.getContainer=function(){return this.container},n.prototype.getContainersArguments=function(){return this.containersArguments},n.prototype.getDisplayChanges=function(){return this.displayChanges},n.prototype.getCallbackArgs=function(){return this.callbackArgs},n.prototype.getKeys=function(){return Object.keys(this.items)},n.prototype.getItem=function(n){return this.checkExistence(n),this.items[n].value},n.prototype.getObject=function(n){return this.items[n]},n.prototype.hasKey=function(n){return this.items.hasOwnProperty(n)},n.prototype.exportItems=function(){var t={};for(var n in this.items)this.items.hasOwnProperty(n)&&(t[n]=this.items[n].value);return t},n.prototype.addItem=function(n,i){return i===void 0&&(i={}),this.items[n]=new t(this,n,i),this.itemKeys.push(n),this.items[n]},n.prototype.removeItem=function(n){this.items.hasOwnProperty(n)&&(this.container&&this.items[n].hasElement&&this.container.removeChild(this.items[n].element),this.itemKeys.splice(this.itemKeys.indexOf(n),1),delete this.items[n])},n.prototype.clear=function(){var n;if(this.container)for(n in this.items)this.items[n].hasElement&&this.container.removeChild(this.items[n].element);this.items={};this.itemKeys=[]},n.prototype.setItem=function(n,t){this.checkExistence(n);this.items[n].value=t;this.items[n].update()},n.prototype.increase=function(n,t){t===void 0&&(t=1);this.checkExistence(n);this.items[n].value+=arguments.length>1?t:1;this.items[n].update()},n.prototype.decrease=function(n,t){t===void 0&&(t=1);this.checkExistence(n);this.items[n].value-=t;this.items[n].update()},n.prototype.toggle=function(n){this.checkExistence(n);this.items[n].value=this.items[n].value?0:1;this.items[n].update()},n.prototype.checkExistence=function(n){if(!this.items.hasOwnProperty(n))if(this.allowNewItems)this.addItem(n);else throw new Error("Unknown key given to StatsHoldr: '"+n+"'.");},n.prototype.saveAll=function(){for(var n in this.items)this.items.hasOwnProperty(n)&&this.items[n].updateLocalStorage(!0)},n.prototype.hideContainer=function(){this.container.style.visibility="hidden"},n.prototype.displayContainer=function(){this.container.style.visibility="visible"},n.prototype.makeContainer=function(n){for(var u=this.createElement.apply(this,n[0]),f=u,t,r,i=1;i<n.length;++i)t=this.createElement.apply(this,n[i]),f.appendChild(t),f=t;for(r in this.items)this.items[r].hasElement&&t.appendChild(this.items[r].element);return u},n.prototype.hasDisplayChange=function(n){return this.displayChanges.hasOwnProperty(n)},n.prototype.getDisplayChange=function(n){return this.displayChanges[n]},n.prototype.createElement=function(n){var i,t,u,r;for(n===void 0&&(n="div"),i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];for(u=document.createElement(n),r=0;r<i.length;r+=1)this.proliferateElement(u,i[r]);return u},n.prototype.proliferate=function(n,t,i){i===void 0&&(i=!1);var u;for(var r in t)if(t.hasOwnProperty(r)){if(i&&n.hasOwnProperty(r))continue;u=t[r];typeof u=="object"?(n.hasOwnProperty(r)||(n[r]=new u.constructor),this.proliferate(n[r],u,i)):n[r]=u}return n},n.prototype.proliferateElement=function(n,t,i){i===void 0&&(i=!1);var u,r,f;for(r in t)if(t.hasOwnProperty(r)){if(i&&n.hasOwnProperty(r))continue;u=t[r];switch(r){case"children":if(typeof u!="undefined")for(f=0;f<u.length;f+=1)n.appendChild(u[f]);break;case"style":this.proliferate(n[r],u);break;default:typeof u=="object"?(n.hasOwnProperty(r)||(n[r]=new u.constructor),this.proliferate(n[r],u,i)):n[r]=u}}return n},n.prototype.createPlaceholderStorage=function(){var n,t={keys:[],getItem:function(n){return this.localStorage[n]},setItem:function(n,t){this.localStorage[n]=t},clear:function(){for(n in this)this.hasOwnProperty(n)&&delete this[n]},removeItem:function(n){delete this[n]},key:function(n){return this.keys[n]}};return Object.defineProperties(t,{length:{get:function(){return t.keys.length}},remainingSpace:{get:function(){return 9001}}}),t},n}();n.StatsHoldr=i})(StatsHoldr||(StatsHoldr={})),function(n){"use strict";var t=function(){function n(n){var t;if(typeof n.library=="undefined")throw new Error("No library given to AudioPlayr.");if(typeof n.directory=="undefined")throw new Error("No directory given to AudioPlayr.");if(typeof n.fileTypes=="undefined")throw new Error("No fileTypes given to AudioPlayr.");if(!n.StatsHolder)throw new Error("No StatsHoldr given to AudioPlayr.");this.StatsHolder=n.StatsHolder;this.library=n.library;this.directory=n.directory;this.fileTypes=n.fileTypes;this.getThemeDefault=n.getThemeDefault||"Theme";this.getVolumeLocal=typeof n.getVolumeLocal=="undefined"?1:n.getVolumeLocal;this.sounds={};this.libraryLoad();t=this.StatsHolder.getItem("volume");t===undefined?this.setVolume(1):this.setVolume(this.StatsHolder.getItem("volume"));this.setMuted(this.StatsHolder.getItem("muted")||!1)}return n.prototype.getLibrary=function(){return this.library},n.prototype.getFileTypes=function(){return this.fileTypes},n.prototype.getSounds=function(){return this.sounds},n.prototype.getTheme=function(){return this.theme},n.prototype.getDirectory=function(){return this.directory},n.prototype.getVolume=function(){return Number(this.StatsHolder.getItem("volume")||0)},n.prototype.setVolume=function(n){var t;if(!this.getMuted())for(t in this.sounds)this.sounds.hasOwnProperty(t)&&(this.sounds[t].volume=Number(this.sounds[t].getAttribute("volumeReal"))*n);this.StatsHolder.setItem("volume",n.toString())},n.prototype.getMuted=function(){return Boolean(Number(this.StatsHolder.getItem("muted")))},n.prototype.setMuted=function(){this.getMuted()?this.setMutedOn():this.setMutedOff()},n.prototype.toggleMuted=function(){this.setMuted(!this.getMuted())},n.prototype.setMutedOn=function(){for(var n in this.sounds)this.sounds.hasOwnProperty(n)&&(this.sounds[n].volume=0);this.StatsHolder.setItem("muted","1")},n.prototype.setMutedOff=function(){var i=this.getVolume(),n;for(var t in this.sounds)this.sounds.hasOwnProperty(t)&&(n=this.sounds[t],n.volume=Number(n.getAttribute("volumeReal"))*i);this.StatsHolder.setItem("muted","0")},n.prototype.getGetVolumeLocal=function(){return this.getVolumeLocal},n.prototype.setGetVolumeLocal=function(n){this.getVolumeLocal=n},n.prototype.getGetThemeDefault=function(){return this.getThemeDefault},n.prototype.setGetThemeDefault=function(n){this.getThemeDefault=n},n.prototype.play=function(n){var t,i;if(this.sounds.hasOwnProperty(n))t=this.sounds[n];else{if(!this.library.hasOwnProperty(n))throw new Error("Unknown name given to AudioPlayr.play: '"+n+"'.");t=this.sounds[n]=this.library[n]}return this.soundStop(t),this.getMuted()?t.volume=0:(t.setAttribute("volumeReal","1"),t.volume=this.getVolume()),this.playSound(t),i=Number(t.getAttribute("used")),i||(t.setAttribute("used",String(i+1)),t.addEventListener("ended",this.soundFinish.bind(this,n))),t.setAttribute("name",n),t},n.prototype.pauseAll=function(){for(var n in this.sounds)this.sounds.hasOwnProperty(n)&&this.pauseSound(this.sounds[n])},n.prototype.resumeAll=function(){for(var n in this.sounds)this.sounds.hasOwnProperty(n)&&this.playSound(this.sounds[n])},n.prototype.pauseTheme=function(){this.theme&&this.pauseSound(this.theme)},n.prototype.resumeTheme=function(){this.theme&&this.playSound(this.theme)},n.prototype.clearAll=function(){this.pauseAll();this.clearTheme();this.sounds={}},n.prototype.clearTheme=function(){this.theme&&(this.pauseTheme(),delete this.sounds[this.theme.getAttribute("name")],this.theme=undefined)},n.prototype.playLocal=function(n,t){t===void 0&&(t=undefined);var r=this.play(n),i;switch(this.getVolumeLocal.constructor){case Function:i=this.getVolumeLocal(t);break;case Number:i=this.getVolumeLocal;break;default:i=Number(this.getVolumeLocal)||1}return r.setAttribute("volumeReal",String(i)),r.volume=this.getMuted()?0:i*this.getVolume(),r},n.prototype.playTheme=function(n,t){if(n===void 0&&(n=undefined),t===void 0&&(t=undefined),this.pauseTheme(),t=typeof t!="undefined"?t:!0,typeof n=="undefined")switch(this.getThemeDefault.constructor){case Function:n=this.getThemeDefault();break;default:n=this.getThemeDefault}return typeof this.theme!="undefined"&&this.theme.hasAttribute("name")&&delete this.sounds[this.theme.getAttribute("name")],this.theme=this.sounds[n]=this.play(n),this.theme.loop=t,this.theme.getAttribute("used")==="1"&&this.theme.addEventListener("ended",this.playTheme.bind(this)),this.theme},n.prototype.playThemePrefixed=function(n,t,i){n===void 0&&(n=undefined);t===void 0&&(t=undefined);i===void 0&&(i=undefined);var r=this.play(n);if(this.pauseTheme(),typeof t=="undefined")switch(this.getThemeDefault.constructor){case Function:t=this.getThemeDefault();break;default:t=this.getThemeDefault}return this.addEventListener(n,"ended",this.playTheme.bind(this,n+" "+t,i)),r},n.prototype.addEventListener=function(n,t,i){var r=this.library[n];if(!r)throw new Error("Unknown name given to addEventListener: '"+n+"'.");r.addedEvents||(r.addedEvents={});r.addedEvents[t]?r.addedEvents[t].push(i):r.addedEvents[t]=[i];r.addEventListener(t,i)},n.prototype.removeEventListeners=function(n,t){var r=this.library[n],i,u;if(!r)throw new Error("Unknown name given to removeEventListeners: '"+n+"'.");if(r.addedEvents&&(i=r.addedEvents[t],i)){for(u=0;u<i.length;u+=1)r.removeEventListener(t,i[u]);i.length=0}},n.prototype.addEventImmediate=function(n,t,i){if(!this.sounds.hasOwnProperty(n)||this.sounds[n].paused){i();return}this.sounds[n].addEventListener(t,i)},n.prototype.soundFinish=function(n){this.sounds.hasOwnProperty(n)&&delete this.sounds[n]},n.prototype.soundStop=function(n){this.pauseSound(n);n.readyState&&(n.currentTime=0)},n.prototype.libraryLoad=function(){var n,i,t,r;for(t in this.library)if(this.library.hasOwnProperty(t)){n=this.library[t];for(r in n)n.hasOwnProperty(r)&&(i=n[r],this.library[i]=this.createAudio(i,t))}},n.prototype.createAudio=function(n,t){for(var i=document.createElement("audio"),r,u,f=0;f<this.fileTypes.length;f+=1)r=this.fileTypes[f],u=document.createElement("source"),u.type="audio/"+r,u.src=this.directory+"/"+t+"/"+r+"/"+n+"."+r,i.appendChild(u);return i.volume=0,i.setAttribute("volumeReal","1"),i.setAttribute("used","0"),this.playSound(i),i},n.prototype.playSound=function(n){return n&&n.play?(n.play(),!0):!1},n.prototype.pauseSound=function(n){return n&&n.pause?(n.pause(),!0):!1},n}();n.AudioPlayr=t}(AudioPlayr||(AudioPlayr={})),function(n){"use strict";var t=function(){function n(n){var t;if(typeof n.pipeline=="undefined")throw new Error("No pipeline given to ChangeLinr.");if(this.pipeline=n.pipeline||[],typeof n.transforms=="undefined")throw new Error("No transforms given to ChangeLinr.");for(this.transforms=n.transforms||{},this.doMakeCache=typeof n.doMakeCache=="undefined"?!0:n.doMakeCache,this.doUseCache=typeof n.doUseCache=="undefined"?!0:n.doUseCache,this.cache={},this.cacheFull={},t=0;t<this.pipeline.length;++t){if(!this.pipeline[t])throw new Error("Pipe["+t+"] is invalid.");if(!this.transforms.hasOwnProperty(this.pipeline[t])&&!this.transforms.hasOwnProperty(this.pipeline[t]))throw new Error("Pipe["+t+'] ("'+this.pipeline[t]+'") not found in transforms.');if(!(this.transforms[this.pipeline[t]]instanceof Function))throw new Error("Pipe["+t+'] ("'+this.pipeline[t]+'") is not a valid Function from transforms.');this.cacheFull[t]=this.cacheFull[this.pipeline[t]]={}}}return n.prototype.getCache=function(){return this.cache},n.prototype.getCached=function(n){return this.cache[n]},n.prototype.getCacheFull=function(){return this.cacheFull},n.prototype.getDoMakeCache=function(){return this.doMakeCache},n.prototype.getDoUseCache=function(){return this.doUseCache},n.prototype.process=function(n,t,i){t===void 0&&(t=undefined);i===void 0&&(i=undefined);var r;if(typeof t=="undefined"&&(this.doMakeCache||this.doUseCache)&&(t=n),this.doUseCache&&this.cache.hasOwnProperty(t))return this.cache[t];for(r=0;r<this.pipeline.length;++r)n=this.transforms[this.pipeline[r]](n,t,i,this),this.doMakeCache&&(this.cacheFull[this.pipeline[r]][t]=n);return this.doMakeCache&&(this.cache[t]=n),n},n.prototype.processFull=function(n,t,i){i===void 0&&(i=undefined);var u={},r;for(this.process(n,t,i),r=0;r<this.pipeline.length;++r)u[r]=u[this.pipeline[r]]=this.cacheFull[this.pipeline[r]][t];return u},n}();n.ChangeLinr=t}(ChangeLinr||(ChangeLinr={})),function(n){"use strict";var t=function(){function n(t){t===void 0&&(t={});var i=n.prototype.ensureCorrectCaller(this),u=t.constants,e=t.constantsSource||i,r=t.requirements,f;if(i.unitsize=t.unitsize||1,i.constants=u,u)for(f=0;f<u.length;f+=1)i[u[f]]=e[u[f]];i.requirements=r;r&&(r.global&&typeof window!="undefined"&&i.checkRequirements(window,r.global,"global"),r.self&&i.checkRequirements(i,r.self,"self"))}return n.prototype.checkRequirements=function(n,t,i){var r=[];for(var u in t)t.hasOwnProperty(u)&&!n[u]&&r.push(u);if(r.length)throw new Error("Missing "+r.length+" requirement(s) in "+i+".\n"+r.map(function(n,i){return i+". "+n+": is the '"+t[n]+"' file included?"}).join("\n"));},n.prototype.reset=function(n,t,i){i===void 0&&(i=undefined);var r,u;for(n.customs=i,u=0;u<t.length;u+=1){if(r=t[u],!n[r])throw new Error(r+" is missing on a resetting EightBittr.");n[r](n,i)}},n.prototype.resetTimed=function(n,t,i){i===void 0&&(i=undefined);for(var e=performance.now(),u=[],f,r=0;r<t.length;r+=1)f=performance.now(),n[t[r]](n,i),u.push({name:t[r],time:performance.now()-f});return u.push({name:"resetTimed",time:performance.now()-e}),u},n.prototype.get=function(t){var i=n.prototype.ensureCorrectCaller.call(this),r;if(r=t.constructor===String?i.followPathHard(i,t.split("."),0):t instanceof Array?i.followPathHard(i,t,0):t,typeof r!="function")throw new Error(t+" is not defined in this EightBitter.");return r.bind(i)},n.prototype.createCanvas=function(n,t,i){i===void 0&&(i=1);var u=document.createElement("canvas"),r=u.getContext("2d");return u.width=n,u.height=t,i=i||1,u.style.width=n*i+"px",u.style.height=t*i+"px",typeof r.imageSmoothingEnabled!="undefined"?r.imageSmoothingEnabled=!1:typeof r.webkitImageSmoothingEnabled!="undefined"?r.webkitImageSmoothingEnabled=!1:typeof r.mozImageSmoothingEnabled!="undefined"?r.mozImageSmoothingEnabled=!1:typeof r.msImageSmoothingEnabled!="undefined"?r.msImageSmoothingEnabled=!1:typeof r.oImageSmoothingEnabled!="undefined"&&(r.oImageSmoothingEnabled=!1),u},n.prototype.shiftVert=function(n,t){n.top+=t;n.bottom+=t},n.prototype.shiftHoriz=function(n,t){n.left+=t;n.right+=t},n.prototype.setTop=function(n,t){n.top=t;n.bottom=n.top+n.height*n.EightBitter.unitsize},n.prototype.setRight=function(n,t){n.right=t;n.left=n.right-n.width*n.EightBitter.unitsize},n.prototype.setBottom=function(n,t){n.bottom=t;n.top=n.bottom-n.height*n.EightBitter.unitsize},n.prototype.setLeft=function(n,t){n.left=t;n.right=n.left+n.width*n.EightBitter.unitsize},n.prototype.setMid=function(n,t,i){n.EightBitter.setMidX(n,t);n.EightBitter.setMidY(n,i)},n.prototype.setMidX=function(n,t){n.EightBitter.setLeft(n,t+n.width*n.EightBitter.unitsize/2)},n.prototype.setMidY=function(n,t){n.EightBitter.setTop(n,t+n.height*n.EightBitter.unitsize/2)},n.prototype.getMidX=function(n){return n.left+n.width*n.EightBitter.unitsize/2},n.prototype.getMidY=function(n){return n.top+n.height*n.EightBitter.unitsize/2},n.prototype.setMidObj=function(n,t){n.EightBitter.setMidXObj(n,t);n.EightBitter.setMidYObj(n,t)},n.prototype.setMidXObj=function(n,t){n.EightBitter.setLeft(n,n.EightBitter.getMidX(t)-n.width*n.EightBitter.unitsize/2)},n.prototype.setMidYObj=function(n,t){n.EightBitter.setTop(n,n.EightBitter.getMidY(t)-n.height*n.EightBitter.unitsize/2)},n.prototype.objectToLeft=function(n,t){return n.EightBitter.getMidX(n)<n.EightBitter.getMidX(t)},n.prototype.updateTop=function(n,t){n.top+=t||0;n.bottom=n.top+n.height*n.EightBitter.unitsize},n.prototype.updateRight=function(n,t){n.right+=t||0;n.left=n.right-n.width*n.EightBitter.unitsize},n.prototype.updateBottom=function(n,t){n.bottom+=t||0;n.top=n.bottom-n.height*n.EightBitter.unitsize},n.prototype.updateLeft=function(n,t){n.left+=t||0;n.right=n.left+n.width*n.EightBitter.unitsize},n.prototype.slideToX=function(n,t,i){var r=n.EightBitter.getMidX(n);i=i||Infinity;r<t?n.EightBitter.shiftHoriz(n,Math.min(i,t-r)):n.EightBitter.shiftHoriz(n,Math.max(-i,t-r))},n.prototype.slideToY=function(n,t,i){var r=n.EightBitter.getMidY(n);i=i||Infinity;r<t?n.EightBitter.shiftVert(n,Math.min(i,t-r)):n.EightBitter.shiftVert(n,Math.max(-i,t-r))},n.prototype.ensureCorrectCaller=function(t){if(!(t instanceof n))throw new Error("A function requires the caller ('this') to be the manipulated EightBittr object. Unfortunately, 'this' is a "+typeof this+".");return t},n.prototype.proliferate=function(n,t,i){i===void 0&&(i=!1);var u;for(var r in t)if(t.hasOwnProperty(r)){if(i&&n.hasOwnProperty(r))continue;u=t[r];typeof u=="object"?(n.hasOwnProperty(r)||(n[r]=new u.constructor),this.proliferate(n[r],u,i)):n[r]=u}return n},n.prototype.proliferateHard=function(n,t,i){i===void 0&&(i=!1);var u;for(var r in t)if(t.hasOwnProperty(r)){if(i&&n[r])continue;u=t[r];typeof u=="object"?(n[r]||(n[r]=new u.constructor),this.proliferate(n[r],u,i)):n[r]=u}return n},n.prototype.proliferateElement=function(n,t,i){i===void 0&&(i=!1);var u,r,f;for(r in t)if(t.hasOwnProperty(r)){if(i&&n.hasOwnProperty(r))continue;u=t[r];switch(r){case"children":if(typeof u!="undefined")for(f=0;f<u.length;f+=1)n.appendChild(u[f]);break;case"style":this.proliferate(n[r],u);break;default:u===null?n[r]=null:typeof u=="object"?(n.hasOwnProperty(r)||(n[r]=new u.constructor),this.proliferate(n[r],u,i)):n[r]=u}}return n},n.prototype.createElement=function(t){for(var f,u,r,e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(f=n.prototype.ensureCorrectCaller(this),u=document.createElement(t||"div"),r=1;r<arguments.length;r+=1)f.proliferateElement(u,arguments[r]);return u},n.prototype.followPathHard=function(n,t,i){i===void 0&&(i=0);for(var r=i||0;r<t.length;r+=1){if(typeof n[t[r]]=="undefined")return undefined;n=n[t[r]]}return n},n.prototype.arraySwitch=function(n,t,i){t.splice(t.indexOf(n),1);i.push(n)},n.prototype.arrayToBeginning=function(n,t){t.splice(t.indexOf(n),1);t.unshift(n)},n.prototype.arrayToEnd=function(n,t){t.splice(t.indexOf(n),1);t.push(n)},n}();n.EightBittr=t}(EightBittr||(EightBittr={})),function(n){"use strict";var t=function(){function n(n){n===void 0&&(n={});this.maxKept=n.maxKept||35;this.numRecorded=0;this.ticker=-1;this.measurements=isFinite(this.maxKept)?new Array(this.maxKept):{};this.getTimestamp=typeof n.getTimestamp=="undefined"?typeof performance=="undefined"?function(){return Date.now()}:(performance.now||performance.webkitNow||performance.mozNow||performance.msNow||performance.oNow).bind(performance):n.getTimestamp}return n.prototype.measure=function(n){n===void 0&&(n=this.getTimestamp());this.timeCurrent&&this.addFPS(1e3/(n-this.timeCurrent));this.timeCurrent=n},n.prototype.addFPS=function(n){this.ticker=(this.ticker+=1)%this.maxKept;this.measurements[this.ticker]=n;this.numRecorded+=1},n.prototype.getMaxKept=function(){return this.maxKept},n.prototype.getNumRecorded=function(){return this.numRecorded},n.prototype.getTimeCurrent=function(){return this.timeCurrent},n.prototype.getTicker=function(){return this.ticker},n.prototype.getMeasurements=function(){var i=Math.min(this.maxKept,this.numRecorded),n,t;for(isFinite(this.maxKept)?n=new Array(i):(n={},n.length=i),t=i-1;t>=0;--t)n[t]=this.measurements[t];return n},n.prototype.getDifferences=function(){for(var t=this.getMeasurements(),n=t.length-1;n>=0;--n)t[n]=1e3/t[n];return t},n.prototype.getAverage=function(){for(var t=0,i=Math.min(this.maxKept,this.numRecorded),n=i-1;n>=0;--n)t+=this.measurements[n];return t/i},n.prototype.getMedian=function(){var n=this.getMeasurementsSorted(),i=n.length,t=Math.floor(i/2);return n.length%2==0?n[t]:(n[t-2]+n[t])/2},n.prototype.getExtremes=function(){for(var t=this.measurements[0],r=t,u=Math.min(this.maxKept,this.numRecorded),n,i=u-1;i>=0;--i)n=this.measurements[i],n>r?r=n:n<t&&(t=n);return[t,r]},n.prototype.getRange=function(){var n=this.getExtremes();return n[1]-n[0]},n.prototype.getMeasurementsSorted=function(){var n,t;if(this.measurements.constructor===Array)n=this.measurements.sort();else{n=[];for(t in this.measurements)if(this.measurements.hasOwnProperty(t)){if(this.measurements[t]===undefined)break;n[t]=this.measurements[t]}n.sort()}return this.numRecorded<this.maxKept&&(n.length=this.numRecorded),n.sort()},n}();n.FPSAnalyzr=t}(FPSAnalyzr||(FPSAnalyzr={})),function(n){"use strict";var t=function(){function n(n){var t;if(typeof n.games=="undefined")throw new Error("No games given to GamesRunnr.");for(this.games=n.games,this.interval=n.interval||1e3/60,this.speed=n.speed||1,this.onPause=n.onPause,this.onPlay=n.onPlay,this.callbackArguments=n.callbackArguments||[this],this.adjustFramerate=n.adjustFramerate,this.FPSAnalyzer=n.FPSAnalyzer||new FPSAnalyzr.FPSAnalyzr(n.FPSAnalyzerSettings),this.scope=n.scope||this,this.paused=!0,this.upkeepScheduler=n.upkeepScheduler||function(n,t){return setTimeout(n,t)},this.upkeepCanceller=n.upkeepCanceller||function(n){clearTimeout(n)},this.upkeepBound=this.upkeep.bind(this),t=0;t<this.games.length;t+=1)this.games[t]=this.games[t].bind(this.scope);this.setIntervalReal()}return n.prototype.getFPSAnalyzer=function(){return this.FPSAnalyzer},n.prototype.getPaused=function(){return this.paused},n.prototype.getGames=function(){return this.games},n.prototype.getInterval=function(){return this.interval},n.prototype.getSpeed=function(){return this.speed},n.prototype.getOnPause=function(){return this.onPause},n.prototype.getOnPlay=function(){return this.onPlay},n.prototype.getCallbackArguments=function(){return this.callbackArguments},n.prototype.getUpkeepScheduler=function(){return this.upkeepScheduler},n.prototype.getUpkeepCanceller=function(){return this.upkeepCanceller},n.prototype.upkeep=function(){this.paused||(this.upkeepCanceller(this.upkeepNext),this.adjustFramerate?this.upkeepNext=this.upkeepScheduler(this.upkeepBound,this.intervalReal-(this.upkeepTimed()|0)):(this.upkeepNext=this.upkeepScheduler(this.upkeepBound,this.intervalReal),this.games.forEach(this.run)),this.FPSAnalyzer&&this.FPSAnalyzer.measure())},n.prototype.upkeepTimed=function(){if(!this.FPSAnalyzer)throw new Error("An internal FPSAnalyzr is required for upkeepTimed.");var n=this.FPSAnalyzer.getTimestamp();return this.games.forEach(this.run),this.FPSAnalyzer.getTimestamp()-n},n.prototype.play=function(){this.paused&&(this.paused=!1,this.onPlay&&this.onPlay.apply(this,this.callbackArguments),this.upkeep())},n.prototype.pause=function(){this.paused||(this.paused=!0,this.onPause&&this.onPause.apply(this,this.callbackArguments),this.upkeepCanceller(this.upkeepNext))},n.prototype.step=function(n){n===void 0&&(n=1);this.play();this.pause();n>0&&this.step(n-1)},n.prototype.togglePause=function(){this.paused?this.play():this.pause()},n.prototype.setInterval=function(n){var t=Number(n);if(isNaN(t))throw new Error("Invalid interval given to setInterval: "+n);this.interval=t;this.setIntervalReal()},n.prototype.setSpeed=function(n){var t=Number(n);if(isNaN(t))throw new Error("Invalid speed given to setSpeed: "+n);this.speed=t;this.setIntervalReal()},n.prototype.setIntervalReal=function(){this.intervalReal=1/this.speed*this.interval},n.prototype.run=function(n){n()},n}();n.GamesRunnr=t}(GamesRunnr||(GamesRunnr={})),function(n){"use strict";var t=function(){function n(n){if(typeof n=="undefined")throw new Error("No settings given to GroupHoldr.");if(typeof n.groupNames=="undefined")throw new Error("No groupNames given to GroupHoldr.");if(typeof n.groupTypes=="undefined")throw new Error("No groupTypes given to GroupHoldr.");this.functions={setGroup:{},getGroup:{},set:{},get:{},add:{},"delete":{}};this.setGroupNames(n.groupNames,n.groupTypes)}return n.prototype.getFunctions=function(){return this.functions},n.prototype.getGroups=function(){return this.groups},n.prototype.getGroup=function(n){return this.groups[n]},n.prototype.getGroupNames=function(){return this.groupNames},n.prototype.deleteObject=function(n,t){var i=this.groups[n];i.splice(i.indexOf(t),1)},n.prototype.deleteIndex=function(n,t,i){i===void 0&&(i=1);var r=this.groups[n];r.splice(t,i)},n.prototype.switchObjectGroup=function(n,t,i,r){r===void 0&&(r=undefined);this.deleteObject(t,n);this.functions.add[i](n,r)},n.prototype.applyAll=function(n,t,i){i===void 0&&(i=undefined);var r;for(i?i.unshift(undefined):i=[undefined],n||(n=this),r=this.groupNames.length-1;r>=0;r-=1)i[0]=this.groups[this.groupNames[r]],t.apply(n,i);i.shift()},n.prototype.applyOnAll=function(n,t,i){i===void 0&&(i=undefined);var r,f,u;for(i?i.unshift(undefined):i=[undefined],n||(n=this),f=this.groupNames.length-1;f>=0;f-=1)if(r=this.groups[this.groupNames[f]],r instanceof Array)for(u=0;u<r.length;u+=1)i[0]=r[u],t.apply(n,i);else for(u in r)r.hasOwnProperty(u)&&(i[0]=r[u],t.apply(n,i))},n.prototype.callAll=function(n,t){for(var u,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];for(i=Array.prototype.slice.call(arguments,1),n||(n=this),u=this.groupNames.length-1;u>=0;u-=1)i[0]=this.groups[this.groupNames[u]],t.apply(n,i)},n.prototype.callOnAll=function(n,t){var u=Array.prototype.slice.call(arguments,1),i,f,r;for(n||(n=this),f=this.groupNames.length-1;f>=0;f-=1)if(i=this.groups[this.groupNames[f]],i instanceof Array)for(r=0;r<i.length;r+=1)u[0]=i[r],t.apply(n,u);else for(r in i)i.hasOwnProperty(r)&&(u[0]=i[r],t.apply(n,u))},n.prototype.clearArrays=function(){for(var t,n=this.groupNames.length-1;n>=0;n-=1)t=this.groups[this.groupNames[n]],t instanceof Array&&(t.length=0)},n.prototype.setGroupNames=function(n,t){var i=this,r,u;if(!(n instanceof Array))throw new Error("groupNames is not an Array");this.groupNames&&this.clearFunctions();this.groupNames=n;this.groupTypes={};this.groupTypeNames={};t.constructor===Object?this.groupNames.forEach(function(n){i.groupTypes[n]=i.getTypeFunction(t[n]);i.groupTypeNames[n]=i.getTypeName(t[n])}):(r=this.getTypeFunction(t),u=this.getTypeName(t),this.groupNames.forEach(function(n){i.groupTypes[n]=r;i.groupTypeNames[n]=u}));this.setGroups();this.setFunctions()},n.prototype.clearFunctions=function(){this.groupNames.forEach(function(n){delete this["set"+n+"Group"];delete this["get"+n+"Group"];delete this["set"+n];delete this["get"+n];delete this["add"+n];delete this["delete"+n];this.functions.setGroup={};this.functions.getGroup={};this.functions.set={};this.functions.get={};this.functions.add={};this.functions.delete={}})},n.prototype.setGroups=function(){var n=this;this.groups={};this.groupNames.forEach(function(t){n.groups[t]=new n.groupTypes[t]})},n.prototype.setFunctions=function(){for(var n,t=0;t<this.groupNames.length;t+=1)n=this.groupNames[t],this.createFunctionSetGroup(n),this.createFunctionGetGroup(n),this.createFunctionSet(n),this.createFunctionGet(n),this.createFunctionAdd(n),this.createFunctionDelete(n)},n.prototype.createFunctionSetGroup=function(n){var t=this;this.functions.setGroup[n]=this["set"+n+"Group"]=function(i){t.groups[n]=i}},n.prototype.createFunctionGetGroup=function(n){var t=this;this.functions.getGroup[n]=this["get"+n+"Group"]=function(){return t.groups[n]}},n.prototype.createFunctionSet=function(n){this.functions.set[n]=this["set"+n]=function(t,i){i===void 0&&(i=undefined);this.groups[n][t]=i}},n.prototype.createFunctionGet=function(n){this.functions.get[n]=this["get"+n]=function(t){return this.groups[n][t]}},n.prototype.createFunctionAdd=function(n){var t=this.groups[n];this.functions.add[n]=this.groupTypes[n]===Object?this["add"+n]=function(n,i){t[i]=n}:this["add"+n]=function(n,i){i!==undefined?t[i]=n:t.push(n)}},n.prototype.createFunctionDelete=function(n){var t=this.groups[n];this.functions.delete[n]=this.groupTypes[n]===Object?this["delete"+n]=function(n){delete t[n]}:this["delete"+n]=function(n){t.splice(t.indexOf(n),1)}},n.prototype.getTypeName=function(n){return n&&n.charAt&&n.charAt(0).toLowerCase()==="o"?"Object":"Array"},n.prototype.getTypeFunction=function(n){return n&&n.charAt&&n.charAt(0).toLowerCase()==="o"?Object:Array},n}();n.GroupHoldr=t}(GroupHoldr||(GroupHoldr={})),function(n){"use strict";var t=function(){function n(n){if(!n.triggers)throw new Error("No triggers given to InputWritr.");this.triggers=n.triggers;this.getTimestamp=typeof n.getTimestamp=="undefined"?typeof performance=="undefined"?function(){return Date.now()}:(performance.now||performance.webkitNow||performance.mozNow||performance.msNow||performance.oNow).bind(performance):n.getTimestamp;this.eventInformation=n.eventInformation;this.canTrigger=n.hasOwnProperty("canTrigger")?n.canTrigger:function(){return!0};this.isRecording=n.hasOwnProperty("isRecording")?n.isRecording:function(){return!0};this.history={};this.histories={length:0};this.aliases={};this.addAliases(n.aliases||{});this.keyAliasesToCodes=n.keyAliasesToCodes||{shift:16,ctrl:17,space:32,left:37,up:38,right:39,down:40};this.keyCodesToAliases=n.keyCodesToAliases||{"16":"shift","17":"ctrl","32":"space","37":"left","38":"up","39":"right","40":"down"}}return n.prototype.restartHistory=function(n){n===void 0&&(n=!0);n&&this.saveHistory(this.history);this.history={};this.startingTime=this.getTimestamp()},n.prototype.getAliases=function(){return this.aliases},n.prototype.getAliasesAsKeyStrings=function(){var t={};for(var n in this.aliases)this.aliases.hasOwnProperty(n)&&(t[n]=this.getAliasAsKeyStrings(n));return t},n.prototype.getAliasAsKeyStrings=function(n){return this.aliases[n].map(this.convertAliasToKeyString.bind(this))},n.prototype.convertAliasToKeyString=function(n){return n.constructor===String?n:n>96&&n<105?String.fromCharCode(n-48):n>64&&n<97?String.fromCharCode(n):typeof this.keyCodesToAliases[n]!="undefined"?this.keyCodesToAliases[n]:"?"},n.prototype.convertKeyStringToAlias=function(n){return n.constructor===Number?n:n.length===1?n.charCodeAt(0)-32:typeof this.keyAliasesToCodes[n]!="undefined"?this.keyAliasesToCodes[n]:-1},n.prototype.getHistory=function(n){return n===void 0&&(n=undefined),arguments.length?this.histories[n]:history},n.prototype.getHistories=function(){return this.histories},n.prototype.getCanTrigger=function(){return this.canTrigger},n.prototype.getIsRecording=function(){return this.isRecording},n.prototype.setCanTrigger=function(n){this.canTrigger=n.constructor===Boolean?function(){return n}:n},n.prototype.setIsRecording=function(n){this.isRecording=n.constructor===Boolean?function(){return n}:n},n.prototype.setEventInformation=function(n){this.eventInformation=n},n.prototype.addAliasValues=function(n,t){var u,i,r;this.aliases.hasOwnProperty(n)?this.aliases[n].push.apply(this.aliases[n],t):this.aliases[n]=t;for(u in this.triggers)if(this.triggers.hasOwnProperty(u)&&(i=this.triggers[u],i.hasOwnProperty(n)))for(r=0;r<t.length;r+=1)i[t[r]]=i[n]},n.prototype.removeAliasValues=function(n,t){var u,r,i;if(this.aliases.hasOwnProperty(n)){for(i=0;i<t.length;i+=1)this.aliases[n].splice(this.aliases[n].indexOf(t[i],1));for(u in this.triggers)if(this.triggers.hasOwnProperty(u)&&(r=this.triggers[u],r.hasOwnProperty(n)))for(i=0;i<t.length;i+=1)r.hasOwnProperty(t[i])&&delete r[t[i]]}},n.prototype.switchAliasValues=function(n,t,i){this.removeAliasValues(n,t);this.addAliasValues(n,i)},n.prototype.addAliases=function(n){for(var t in n)n.hasOwnProperty(t)&&this.addAliasValues(t,n[t])},n.prototype.addEvent=function(n,t,i){var r;if(!this.triggers.hasOwnProperty(n))throw new Error("Unknown trigger requested: '"+n+"'.");if(this.triggers[n][t]=i,this.aliases.hasOwnProperty(t))for(r=0;r<this.aliases[t].length;r+=1)this.triggers[n][this.aliases[t][r]]=i},n.prototype.removeEvent=function(n,t){var i;if(!this.triggers.hasOwnProperty(n))throw new Error("Unknown trigger requested: '"+n+"'.");if(delete this.triggers[n][t],this.aliases.hasOwnProperty(t))for(i=0;i<this.aliases[t].length;i+=1)this.triggers[n][this.aliases[t][i]]&&delete this.triggers[n][this.aliases[t][i]]},n.prototype.saveHistory=function(n){n===void 0&&(n=undefined);this.histories[this.histories.length]=history;this.histories.length+=1;arguments.length&&(this.histories[n]=history)},n.prototype.playHistory=function(){this.playEvents(this.history)},n.prototype.playEvents=function(n){var r={},t,i;for(t in n)n.hasOwnProperty(t)&&(i=this.makeEventCall(n[t]),r[t]=setTimeout(i,Number(t)-this.startingTime|0))},n.prototype.callEvent=function(n,t,i){if(this.canTrigger(n,t)){if(!n)throw new Error("Blank event given, ignoring it.");return n.constructor===String&&(n=this.triggers[n][t]),n(this.eventInformation,i)}},n.prototype.makePipe=function(n,t,i){var u=this.triggers[n],r=this;if(!u)throw new Error("No trigger of label '"+n+"' defined.");return function(f){var e=f[t];i&&f.preventDefault instanceof Function&&f.preventDefault();u.hasOwnProperty(e)&&(r.isRecording()&&(r.history[r.getTimestamp()|0]=[n,e]),r.callEvent(u[e],e,f))}},n.prototype.makeEventCall=function(n){return function(){this.callEvent(n[0],n[1])}},n}();n.InputWritr=t}(InputWritr||(InputWritr={})),function(n){"use strict";var t=function(){function n(n){if(typeof n.inheritance=="undefined")throw new Error("No inheritance mapping given to ObjectMakr.");this.inheritance=n.inheritance;this.properties=n.properties||{};this.doPropertiesFull=n.doPropertiesFull;this.indexMap=n.indexMap;this.onMake=n.onMake;this.functions={};this.doPropertiesFull&&(this.propertiesFull={});this.indexMap&&this.processProperties(this.properties);this.processFunctions(this.inheritance,Object,"Object")}return n.prototype.getInheritance=function(){return this.inheritance},n.prototype.getProperties=function(){return this.properties},n.prototype.getPropertiesOf=function(n){return this.properties[n]},n.prototype.getFullProperties=function(){return this.propertiesFull},n.prototype.getFullPropertiesOf=function(n){return this.doPropertiesFull?this.propertiesFull[n]:undefined},n.prototype.getFunctions=function(){return this.functions},n.prototype.getFunction=function(n){return this.functions[n]},n.prototype.hasFunction=function(n){return this.functions.hasOwnProperty(n)},n.prototype.getIndexMap=function(){return this.indexMap},n.prototype.make=function(n,t){t===void 0&&(t=undefined);var i;if(!this.functions.hasOwnProperty(n))throw new Error("Unknown type given to ObjectMakr: "+n);return i=new this.functions[n],t&&this.proliferate(i,t),this.onMake&&i[this.onMake]&&(this.doPropertiesFull?i[this.onMake](i,n,this.properties[n],this.propertiesFull[n]):i[this.onMake](i,n,this.properties[n],this.functions[n].prototype)),i},n.prototype.processProperties=function(n){for(var t in n)this.properties.hasOwnProperty(t)&&this.properties[t]instanceof Array&&(this.properties[t]=this.processPropertyArray(this.properties[t]))},n.prototype.processPropertyArray=function(n){for(var i={},t=n.length-1;t>=0;--t)i[this.indexMap[t]]=n[t];return i},n.prototype.processFunctions=function(n,t,i){var r,u;for(r in n)if(n.hasOwnProperty(r)){this.functions[r]=new Function;this.functions[r].prototype=new t;this.functions[r].prototype.constructor=this.functions[r];for(u in this.properties[r])this.properties[r].hasOwnProperty(u)&&(this.functions[r].prototype[u]=this.properties[r][u]);if(this.doPropertiesFull){if(this.propertiesFull[r]={},i)for(u in this.propertiesFull[i])this.propertiesFull[i].hasOwnProperty(u)&&(this.propertiesFull[r][u]=this.propertiesFull[i][u]);for(u in this.properties[r])this.properties[r].hasOwnProperty(u)&&(this.propertiesFull[r][u]=this.properties[r][u])}this.processFunctions(n[r],this.functions[r],r)}},n.prototype.proliferate=function(n,t,i){i===void 0&&(i=!1);var u;for(var r in t)i&&n.hasOwnProperty(r)||(u=t[r],typeof u=="object"?(n.hasOwnProperty(r)||(n[r]=new u.constructor),this.proliferate(n[r],u,i)):n[r]=u);return n},n}();n.ObjectMakr=t}(ObjectMakr||(ObjectMakr={})),function(n){"use strict";var t=function(){function n(n,t,i){this.thing=n;this.title=n.title;this.reference=t;this.spawned=!1;this.left=t.x||0;this.top=t.y||0;this.right=this.left+(t.width||i.getFullPropertiesOf(this.title).width);this.bottom=this.top+(t.height||i.getFullPropertiesOf(this.title).height);t.position&&(this.position=t.position)}return n}(),i;n.PreThing=t;i=function(){function n(n){if(!n)throw new Error("No settings given to MapsCreatr.");if(!n.ObjectMaker)throw new Error("No ObjectMakr given to MapsCreatr.");if(this.ObjectMaker=n.ObjectMaker,typeof this.ObjectMaker.getFullProperties()=="undefined")throw new Error("MapsCreatr's ObjectMaker must store full properties.");if(!n.groupTypes)throw new Error("No groupTypes given to MapsCreatr.");this.groupTypes=n.groupTypes;this.keyGroupType=n.keyGroupType||"groupType";this.keyEntrance=n.keyEntrance||"entrance";this.macros=n.macros||{};this.scope=n.scope||this;this.entrances=n.entrances;this.requireEntrance=n.requireEntrance;this.maps={};n.maps&&this.storeMaps(n.maps)}return n.prototype.getObjectMaker=function(){return this.ObjectMaker},n.prototype.getGroupTypes=function(){return this.groupTypes},n.prototype.getKeyGroupType=function(){return this.keyGroupType},n.prototype.getKeyEntrance=function(){return this.keyEntrance},n.prototype.getMacros=function(){return this.macros},n.prototype.getScope=function(){return this.scope},n.prototype.getRequireEntrance=function(){return this.requireEntrance},n.prototype.getMaps=function(){return this.maps},n.prototype.getMap=function(n){var t=this.maps[n];if(!t)throw new Error("No map found under: "+n);return t.initialized||(this.setMapAreas(t),this.setMapLocations(t),t.initialized=!0),t},n.prototype.storeMaps=function(n){for(var t in n)n.hasOwnProperty(t)&&this.storeMap(t,n[t])},n.prototype.storeMap=function(n,t){if(!n)throw new Error("Maps cannot be created with no name.");var i=this.ObjectMaker.make("Map",t);if(!i.areas)throw new Error("Maps cannot be used with no areas: "+n);if(!i.locations)throw new Error("Maps cannot be used with no locations: "+n);return this.maps[n]=i,i},n.prototype.getPreThings=function(n){var u=n.map,i=n.creation,r=this.fromKeys(this.groupTypes),t;for(n.collections={},t=0;t<i.length;t+=1)this.analyzePreSwitch(i[t],r,n,u);return this.processPreThingsArrays(r)},n.prototype.analyzePreSwitch=function(n,t,i,r){return n.macro?this.analyzePreMacro(n,t,i,r):this.analyzePreThing(n,t,i,r)},n.prototype.analyzePreMacro=function(n,t,i,r){var e=this.macros[n.macro],u,f;if(!e){console.warn("A non-existent macro is referenced. It will be ignored:",e,n,t,i,r);return}if(u=e(n,t,i,r,this.scope),u)if(u instanceof Array)for(f=0;f<u.length;f+=1)this.analyzePreSwitch(u[f],t,i,r);else this.analyzePreSwitch(u,t,i,r);return u},n.prototype.analyzePreThing=function(n,i,r,u){var o=n.thing,e,f;if(!this.ObjectMaker.hasFunction(o)){console.warn("A non-existent Thing type is referenced. It will be ignored:",o,n,i,r,u);return}if(f=new t(this.ObjectMaker.make(o,n),n,this.ObjectMaker),e=f.thing,!f.thing[this.keyGroupType]){console.warn("A Thing does not contain a "+this.keyGroupType+". It will be ignored:",f,"\n",arguments);return}if(this.groupTypes.indexOf(f.thing[this.keyGroupType])===-1){console.warn("A Thing contains an unknown "+this.keyGroupType+". It will be ignored:",e[this.keyGroupType],f,n,i,r,u);return}return i[f.thing[this.keyGroupType]].push(f),!e.noBoundaryStretch&&r.boundaries&&this.stretchAreaBoundaries(f,r),e[this.keyEntrance]!==undefined&&typeof e[this.keyEntrance]!="object"&&typeof u.locations[e[this.keyEntrance]]!="undefined"&&(typeof u.locations[e[this.keyEntrance]].xloc=="undefined"&&(u.locations[e[this.keyEntrance]].xloc=f.left),typeof u.locations[e[this.keyEntrance]].yloc=="undefined"&&(u.locations[e[this.keyEntrance]].yloc=f.top),u.locations[e[this.keyEntrance]].entrance=f.thing),n.collectionName&&r.collections&&this.ensureThingCollection(f,n.collectionName,n.collectionKey,r),f},n.prototype.setMapAreas=function(n){var f=n.areas,r=n.locations,e=new f.constructor,o=new r.constructor,u,t;for(var i in f)f.hasOwnProperty(i)&&(u=this.ObjectMaker.make("Area",f[i]),e[i]=u,u.map=n,u.name=i,u.boundaries={top:0,right:0,bottom:0,left:0});for(i in r)if(r.hasOwnProperty(i)){if(t=this.ObjectMaker.make("Location",r[i]),o[i]=t,t.entryRaw=r[i].entry,t.name=i,t.area=r[i].area||0,this.requireEntrance&&!this.entrances.hasOwnProperty(t.entryRaw))throw new Error("Location "+i+" has unknown entry string: "+t.entryRaw);this.entrances&&t.entryRaw?t.entry=this.entrances[t.entryRaw]:t.entry&&t.entry.constructor===String&&(t.entry=this.entrances[String(t.entry)])}n.areas=e;n.locations=o},n.prototype.setMapLocations=function(n){var i=n.locations,r=new i.constructor,u;for(var t in i)if(i.hasOwnProperty(t)&&(u=this.ObjectMaker.make("Location",i[t]),r[t]=u,u.area=n.areas[i[t].area||0],!r[t].area))throw new Error("Location "+t+" references an invalid area:"+i[t].area);n.locations=r},n.prototype.stretchAreaBoundaries=function(n,t){var i=t.boundaries;i.top=Math.min(n.top,i.top);i.right=Math.max(n.right,i.right);i.bottom=Math.max(n.bottom,i.bottom);i.left=Math.min(n.left,i.left)},n.prototype.ensureThingCollection=function(n,t,i,r){var f=n.thing,u=r.collections[t];u||(u=r.collections[t]={});f.collection=u;u[i]=f},n.prototype.processPreThingsArrays=function(n){var t=this,f={},r,i,u;for(r in n)n.hasOwnProperty(r)&&(i=n[r],u={xInc:this.getArraySorted(i,this.sortPreThingsXInc),xDec:this.getArraySorted(i,this.sortPreThingsXDec),yInc:this.getArraySorted(i,this.sortPreThingsYInc),yDec:this.getArraySorted(i,this.sortPreThingsYDec)},u.push=function(n){t.addArraySorted(this.xInc,n,t.sortPreThingsXInc);t.addArraySorted(this.xDec,n,t.sortPreThingsXDec);t.addArraySorted(this.yInc,n,t.sortPreThingsYInc);t.addArraySorted(this.yDec,n,t.sortPreThingsYDec)}.bind(u),f[r]=u);return f},n.prototype.fromKeys=function(n){for(var i={},t=0;t<n.length;t+=1)i[n[t]]=[];return i},n.prototype.getArraySorted=function(n,t){var i=n.slice();return i.sort(t),i},n.prototype.addArraySorted=function(n,t,i){for(var r=0,u=n.length,f;r!==u;)f=(r+u)/2|0,i(t,n[f])<0?u=f:r=f+1;if(r===u){n.splice(r,0,t);return}},n.prototype.sortPreThingsXInc=function(n,t){return n.left===t.left?n.top-t.top:n.left-t.left},n.prototype.sortPreThingsXDec=function(n,t){return t.right===n.right?t.bottom-n.bottom:t.right-n.right},n.prototype.sortPreThingsYInc=function(n,t){return n.top===t.top?n.left-t.left:n.top-t.top},n.prototype.sortPreThingsYDec=function(n,t){return t.bottom===n.bottom?t.right-n.right:t.bottom-n.bottom},n}();n.MapsCreatr=i}(MapsCreatr||(MapsCreatr={})),function(n){"use strict";var t=function(){function n(n){var t;if(typeof n.width=="undefined")throw new Error("No width given to MapScreenr.");if(typeof n.height=="undefined")throw new Error("No height given to MapScreenr.");for(t in n)n.hasOwnProperty(t)&&(this[t]=n[t]);this.variables=n.variables||{};this.variableArgs=n.variableArgs||[]}return n.prototype.clearScreen=function(){this.left=0;this.top=0;this.right=this.width;this.bottom=this.height;this.setMiddleX();this.setMiddleY();this.setVariables()},n.prototype.setMiddleX=function(){this.middleX=(this.left+this.right)/2},n.prototype.setMiddleY=function(){this.middleY=(this.top+this.bottom)/2},n.prototype.setVariables=function(){for(var n in this.variables)this.variables.hasOwnProperty(n)&&(this[n]=this.variables[n].apply(this,this.variableArgs))},n.prototype.shift=function(n,t){n&&this.shiftX(n);t&&this.shiftY(t)},n.prototype.shiftX=function(n){this.left+=n;this.right+=n},n.prototype.shiftY=function(n){this.top+=n;this.bottom+=n},n}();n.MapScreenr=t}(MapScreenr||(MapScreenr={})),function(n){"use strict";var t=function(){function n(n){if(!n)throw new Error("No settings given to MapsHandlr.");if(!n.MapsCreator)throw new Error("No MapsCreator provided to MapsHandlr.");if(this.MapsCreator=n.MapsCreator,!n.MapScreener)throw new Error("No MapScreener provided to MapsHandlr.");this.MapScreener=n.MapScreener;this.onSpawn=n.onSpawn;this.onUnspawn=n.onUnspawn;this.screenAttributes=n.screenAttributes||[];this.stretchAdd=n.stretchAdd;this.afterAdd=n.afterAdd}return n.prototype.getMapsCreator=function(){return this.MapsCreator},n.prototype.getMapScreener=function(){return this.MapScreener},n.prototype.getScreenAttributes=function(){return this.screenAttributes},n.prototype.getMapName=function(){return this.mapName},n.prototype.getMap=function(n){return n===void 0&&(n=undefined),typeof n!="undefined"?this.MapsCreator.getMap(n):this.mapCurrent},n.prototype.getMaps=function(){return this.MapsCreator.getMaps()},n.prototype.getArea=function(){return this.areaCurrent},n.prototype.getAreaName=function(){return this.areaCurrent.name},n.prototype.getLocation=function(n){return this.areaCurrent.map.locations[n]},n.prototype.getPreThings=function(){return this.prethings},n.prototype.setMap=function(n,t){if(t===void 0&&(t=undefined),this.mapCurrent=this.getMap(n),!this.mapCurrent)throw new Error("Unknown Map in setMap: '"+n+"'.");return this.mapName=n,arguments.length>1&&this.setLocation(t),this.mapCurrent},n.prototype.setLocation=function(n){var t,r,i;if(t=this.mapCurrent.locations[n],!t)throw new Error("Unknown location in setLocation: '"+n+"'.");for(this.locationCurrent=t,this.areaCurrent=t.area,this.areaCurrent.boundaries={top:0,right:0,bottom:0,left:0},i=0;i<this.screenAttributes.length;i+=1)r=this.screenAttributes[i],this.MapScreener[r]=this.areaCurrent[r];this.prethings=this.MapsCreator.getPreThings(t.area);this.areaCurrent.stretches?this.setStretches(this.areaCurrent.stretches):this.stretches=undefined;this.areaCurrent.afters?this.setAfters(this.areaCurrent.afters):this.afters=undefined},n.prototype.setStretches=function(n){this.stretches=n;this.stretches.forEach(this.stretchAdd)},n.prototype.setAfters=function(n){this.afters=n;this.afters.forEach(this.afterAdd)},n.prototype.spawnMap=function(n,t,i,r,u){this.onSpawn&&this.applySpawnAction(this.onSpawn,!0,n,t,i,r,u)},n.prototype.unspawnMap=function(n,t,i,r,u){this.onUnspawn&&this.applySpawnAction(this.onUnspawn,!1,n,t,i,r,u)},n.prototype.applySpawnAction=function(n,t,i,r,u,f,e){var c,o,s,l,a,v,h;for(c in this.prethings)if(this.prethings.hasOwnProperty(c)&&(o=this.prethings[c][i],o.length!==0))for(l=o.length/2|0,a=this.findPreThingsSpawnStart(i,o,l,r,u,f,e),v=this.findPreThingsSpawnEnd(i,o,l,r,u,f,e),h=a;h<=v;h+=1)s=o[h],s.spawned!==t&&(s.spawned=t,n(s))},n.prototype.findPreThingsSpawnStart=function(t,i,r,u,f,e,o){for(var h=n.directionKeys[t],c=this.getDirectionEnd(h,u,f,e,o),s=0;s<i.length;s+=1)if(i[s][h]>=c)return s;return s},n.prototype.findPreThingsSpawnEnd=function(t,i,r,u,f,e,o){for(var h=n.directionKeys[t],c=n.directionKeys[n.directionOpposites[t]],l=this.getDirectionEnd(c,u,f,e,o),s=i.length-1;s>=0;s-=1)if(i[s][h]<=l)return s;return s},n.prototype.getDirectionEnd=function(n,t,i,r,u){switch(n){case"top":return t;case"right":return i;case"bottom":return r;case"left":return u;default:throw new Error("Unknown directionKey: "+n);}},n.directionKeys={xInc:"left",xDec:"right",yInc:"top",yDec:"bottom"},n.directionOpposites={xInc:"xDec",xDec:"xInc",yInc:"yDec",yDec:"yInc"},n}();n.MapsHandlr=t}(MapsHandlr||(MapsHandlr={})),function(n){"use strict";var t=function(){function n(n){if(!n)throw new Error("No settings given to StringFilr.");if(!n.library)throw new Error("No library given to StringFilr.");if(this.library=n.library,this.normal=n.normal,this.requireNormalKey=n.requireNormalKey,this.cache={},this.requireNormalKey){if(typeof this.normal=="undefined")throw new Error("StringFilr is given requireNormalKey, but no normal class.");this.ensureLibraryNormal()}}return n.prototype.getLibrary=function(){return this.library},n.prototype.getNormal=function(){return this.normal},n.prototype.getCache=function(){return this.cache},n.prototype.getCached=function(n){return this.cache[n]},n.prototype.clearCache=function(){this.cache={}},n.prototype.clearCached=function(n){this.normal&&(n=n.replace(this.normal,""));delete this.cache[n]},n.prototype.get=function(n){var t,i;return(t=this.normal?n.replace(this.normal,""):n,this.cache.hasOwnProperty(t))?this.cache[t]:(i=this.followClass(t.split(/\s+/g),this.library),this.cache[t]=this.cache[n]=i,i)},n.prototype.findLackingNormal=function(n,t,i){var r;if(n.hasOwnProperty(this.normal)||i.push(t),typeof n[r]=="object")for(r in n)n.hasOwnProperty(r)&&this.findLackingNormal(n[r],t+" "+r,i);return i},n.prototype.followClass=function(n,t){var r,i;if(!n||!n.length)return t;for(i=0;i<n.length;i+=1)if(r=n[i],t.hasOwnProperty(r))return n.splice(i,1),this.followClass(n,t[r]);return this.normal&&t.hasOwnProperty(this.normal)?this.followClass(n,t[this.normal]):t},n.prototype.ensureLibraryNormal=function(){var n=this.findLackingNormal(this.library,"base",[]);if(n.length)throw new Error("Found "+n.length+" library sub-directories missing the normal: \r\n  "+n.join("\r\n  "));},n}();n.StringFilr=t}(StringFilr||(StringFilr={})),function(n){"use strict";var t=function(){function n(n){if(!n)throw new Error("No settings given to PixelRendr.");if(!n.paletteDefault)throw new Error("No paletteDefault given to PixelRendr.");this.paletteDefault=n.paletteDefault;this.digitsizeDefault=this.getDigitSize(this.paletteDefault);this.digitsplit=new RegExp(".{1,"+this.digitsizeDefault+"}","g");this.library={raws:n.library||{},posts:[]};this.filters=n.filters||{};this.scale=n.scale||1;this.flipVert=n.flipVert||"flip-vert";this.flipHoriz=n.flipHoriz||"flip-horiz";this.spriteWidth=n.spriteWidth||"spriteWidth";this.spriteHeight=n.spriteHeight||"spriteHeight";this.Uint8ClampedArray=n.Uint8ClampedArray||window.Uint8ClampedArray||window.Uint8Array;this.ProcessorBase=new ChangeLinr.ChangeLinr({transforms:{spriteUnravel:this.spriteUnravel.bind(this),spriteApplyFilter:this.spriteApplyFilter.bind(this),spriteExpand:this.spriteExpand.bind(this),spriteGetArray:this.spriteGetArray.bind(this)},pipeline:["spriteUnravel","spriteApplyFilter","spriteExpand","spriteGetArray"]});this.ProcessorDims=new ChangeLinr.ChangeLinr({transforms:{spriteRepeatRows:this.spriteRepeatRows.bind(this),spriteFlipDimensions:this.spriteFlipDimensions.bind(this)},pipeline:["spriteRepeatRows","spriteFlipDimensions"]});this.ProcessorEncode=new ChangeLinr.ChangeLinr({transforms:{imageGetData:this.imageGetData.bind(this),imageGetPixels:this.imageGetPixels.bind(this),imageMapPalette:this.imageMapPalette.bind(this),imageCombinePixels:this.imageCombinePixels.bind(this)},pipeline:["imageGetData","imageGetPixels","imageMapPalette","imageCombinePixels"],doUseCache:!1});this.library.sprites=this.libraryParse(this.library.raws,"");this.libraryPosts();this.BaseFiler=new StringFilr.StringFilr({library:this.library.sprites,normal:"normal"})}return n.prototype.getBaseLibrary=function(){return this.BaseFiler.getLibrary()},n.prototype.getBaseFiler=function(){return this.BaseFiler},n.prototype.getProcessorBase=function(){return this.ProcessorBase},n.prototype.getProcessorDims=function(){return this.ProcessorDims},n.prototype.getProcessorEncode=function(){return this.ProcessorEncode},n.prototype.getSpriteBase=function(n){return this.BaseFiler.get(n)},n.prototype.decode=function(n,t){var i=this.BaseFiler.get(n);if(!i)throw new Error("No raw sprite found for "+n+".");if(i.multiple)i.processed||this.processSpriteMultiple(i,n,t);else{if(!(i instanceof this.Uint8ClampedArray))throw new Error("No single raw sprite found for: '"+n+"'");i=this.ProcessorDims.process(i,n,t)}return i},n.prototype.encode=function(n,t,i){var r=this.ProcessorEncode.process(n);return t&&t(r,n,i),r},n.prototype.encodeUri=function(n,t){var i=document.createElement("img");i.onload=this.encode.bind(self,i,t);i.src=n},n.prototype.generatePaletteFromRawData=function(n,t,i){t===void 0&&(t=!1);i===void 0&&(i=!1);for(var u={},e=[],o=[],f,r=0;r<n.length;r+=4){if(n[r+3]===0){t=!0;continue}u[n[r]]&&u[n[r]][n[r+1]]&&u[n[r]][n[r+1]][n[r+2]]&&u[n[r]][n[r+1]][n[r+2]][n[r+3]]||(u[n[r]]||(u[n[r]]={}),u[n[r]][n[r+1]]||(u[n[r]][n[r+1]]={}),u[n[r]][n[r+1]][n[r+2]]||(u[n[r]][n[r+1]][n[r+2]]={}),u[n[r]][n[r+1]][n[r+2]][n[r+3]]||(u[n[r]][n[r+1]][n[r+2]][n[r+3]]=!0,n[r]===n[r+1]&&n[r+1]===n[r+2]?o.push(n.subarray(r,r+4)):e.push(n.subarray(r,r+4))))}if(o.sort(function(n,t){return n[0]-t[0]}),e.sort(function(n,t){for(r=0;r<4;r+=1)if(n[r]!==t[r])return t[r]-n[r]}),f=t?[new this.Uint8ClampedArray([0,0,0,0])].concat(o).concat(e):o.concat(e),!i)return f;for(r=0;r<f.length;r+=1)f[r]=Array.prototype.slice.call(f[r]);return f},n.prototype.memcpyU8=function(n,t,i,r,u){if((i===void 0&&(i=0),r===void 0&&(r=0),u===void 0&&(u=Math.max(0,Math.min(n.length,t.length))),n&&t&&!(i<0)&&!(r<0)&&!(u<=0))&&!(i>=n.length)&&!(r>=t.length))for(var f=u+0,e=r+0,o=i+0;f--;)t[e++]=n[o++]},n.prototype.libraryParse=function(n,t){var r={},u;for(var i in n)if(n.hasOwnProperty(i)){u=n[i];switch(u.constructor){case String:r[i]=this.ProcessorBase.process(u,t+" "+i);break;case Array:this.library.posts.push({caller:r,name:i,command:n[i],path:t+" "+i});break;default:r[i]=this.libraryParse(u,t+" "+i)}}return r},n.prototype.libraryPosts=function(){for(var i=this.library.posts,n,t=0;t<i.length;t+=1)n=i[t],n.caller[n.name]=this.evaluatePost(n.caller,n.command,n.path)},n.prototype.evaluatePost=function(n,t,i){var r,u;switch(t[0]){case"same":return(r=this.followPath(this.library.raws,t[1],0),r.constructor===String)?this.ProcessorBase.process(r,i):r.constructor===Array?this.evaluatePost(n,r,i):this.libraryParse(r,i);case"filter":return r=this.followPath(this.library.raws,t[1],0),u=this.filters[t[2]],u||(console.warn("Invalid filter provided:",t[2],this.filters),u={}),this.evaluatePostFilter(r,i,u);case"multiple":return this.evaluatePostMultiple(i,t);default:console.warn("Unknown post command: '"+t[0]+"'.",n,t,i)}},n.prototype.evaluatePostFilter=function(n,t,i){if(n.constructor===String)return this.ProcessorBase.process(n,t,{filter:i});if(n instanceof Array)return this.evaluatePostFilter(this.followPath(this.library.raws,n[1],0),n[1].join(" "),i);if(n instanceof Object){var u={};for(var r in n)n.hasOwnProperty(r)&&(u[r]=this.evaluatePostFilter(n[r],t+" "+r,i));return u}console.warn("Invalid sprite provided for a post filter.",n,t,i)},n.prototype.evaluatePostMultiple=function(n,t){var u=t[1],i=t[2],f={direction:u,multiple:!0,sprites:{},processed:!1,topheight:i.topheight|0,rightwidth:i.rightwidth|0,bottomheight:i.bottomheight|0,leftwidth:i.leftwidth|0,middleStretch:i.middleStretch||!1};for(var r in i)i.hasOwnProperty(r)&&(f.sprites[r]=this.ProcessorBase.process(i[r],n+u+r));return f},n.prototype.processSpriteMultiple=function(n,t,i){for(var r in n.sprites)n.sprites[r]instanceof this.Uint8ClampedArray&&(n.sprites[r]=this.ProcessorDims.process(n.sprites[r],t+" "+r,i));n.processed=!0},n.prototype.spriteUnravel=function(n){for(var r=this.getPaletteReferenceStarting(this.paletteDefault),u=this.digitsizeDefault,s=n.length,e,o,i,f="",t=0;t<s;)switch(n[t]){case"x":for(i=n.indexOf(",",++t),e=this.makeDigit(r[n.slice(t,t+=u)],this.digitsizeDefault),o=Number(n.slice(t,i));o--;)f+=e;t=i+1;break;case"p":n[++t]==="["?(i=n.indexOf("]"),r=this.getPaletteReference(n.slice(t+1,i).split(",")),t=i+1,u=1):(r=this.getPaletteReference(this.paletteDefault),u=this.digitsizeDefault);break;default:f+=this.makeDigit(r[n.slice(t,t+=u)],this.digitsizeDefault)}return f},n.prototype.spriteExpand=function(n){for(var r="",f=n.length,t=0,i,u;t<f;)for(u=n.slice(t,t+=this.digitsizeDefault),i=0;i<this.scale;++i)r+=u;return r},n.prototype.spriteApplyFilter=function(n,t,i){var r,u,e,f;if(!i||!i.filter||(r=i.filter,u=r[0],!u))return n;switch(u){case"palette":e=n.match(this.digitsplit);for(f in r[1])r[1].hasOwnProperty(f)&&this.arrayReplace(e,f,r[1][f]);return e.join("");default:console.warn("Unknown filter: '"+u+"'.")}return n},n.prototype.spriteGetArray=function(n){for(var o=n.length,u=o/this.digitsizeDefault,s=n.match(this.digitsplit),h=u*4,f=new this.Uint8ClampedArray(h),e,t,i=0,r=0;i<u;++i){for(e=this.paletteDefault[Number(s[i])],t=0;t<4;++t)f[r+t]=e[t];r+=4}return f},n.prototype.spriteRepeatRows=function(n,t,i){for(var e=new this.Uint8ClampedArray(n.length*this.scale),r=i[this.spriteWidth]*4,h=i[this.spriteHeight]*this.scale,o=0,s=0,f,u=0;u<h;++u){for(f=0;f<this.scale;++f)this.memcpyU8(n,e,o,s,r),s+=r;o+=r}return e},n.prototype.spriteFlipDimensions=function(n,t,i){return t.indexOf(this.flipHoriz)!==-1?t.indexOf(this.flipVert)!==-1?this.flipSpriteArrayBoth(n):this.flipSpriteArrayHoriz(n,i):t.indexOf(this.flipVert)!==-1?this.flipSpriteArrayVert(n,i):n},n.prototype.flipSpriteArrayHoriz=function(n,t){for(var s=n.length,c=t[this.spriteWidth]+0,h=new this.Uint8ClampedArray(s),u=c*4,f,e,o,r,i=0;i<s;i+=u)for(f=i,e=i+u-4,o=0;o<u;o+=4){for(r=0;r<4;++r)h[f+r]=n[e+r];f+=4;e-=4}return h},n.prototype.flipSpriteArrayVert=function(n,t){for(var f=n.length,h=t[this.spriteWidth]+0,o=new this.Uint8ClampedArray(f),u=h*4,e=0,s=f-u,i,r;e<f;){for(i=0;i<u;i+=4)for(r=0;r<4;++r)o[e+i+r]=n[s+i+r];e+=u;s-=u}return o},n.prototype.flipSpriteArrayBoth=function(n){for(var r=n.length,u=new this.Uint8ClampedArray(r),f=n.length-4,i=0,t;i<r;){for(t=0;t<4;++t)u[i+t]=n[f+t];i+=4;f-=4}return u},n.prototype.imageGetData=function(n){var t=document.createElement("canvas"),i=t.getContext("2d");return t.width=n.width,t.height=n.height,i.drawImage(n,0,0),i.getImageData(0,0,n.width,n.height).data},n.prototype.imageGetPixels=function(n){for(var f=new Array(n.length/4),r={},t,i=0,u=0;i<n.length;i+=4,u+=1)t=this.getClosestInPalette(this.paletteDefault,n.subarray(i,i+4)),f[u]=t,r.hasOwnProperty(t)?r[t]+=1:r[t]=1;return[f,r]},n.prototype.imageMapPalette=function(n){var i=n[0],r=n[1],t=Object.keys(r),u=this.getDigitSize(t),f=this.getValueIndices(t),e=i.map(this.getKeyValue.bind(this,f));return[t,e,u]},n.prototype.imageCombinePixels=function(n){for(var s=n[0],u=n[1],f=n[2],h=Math.max(3,Math.round(4/f)),e,o,t=0,i,r="p["+s.map(this.makeSizedDigit.bind(this,f)).join(",")+"]";t<u.length;){for(i=t+1,e=u[t],o=this.makeDigit(e,f);e===u[i];)i+=1;if(i-t>h)r+="x"+o+String(i-t)+",",t=i;else do r+=o,t+=1;while(t<i)}return r},n.prototype.getDigitSize=function(n){return Math.floor(Math.log(n.length)/Math.LN10)+1},n.prototype.getPaletteReference=function(n){for(var i={},r=this.getDigitSize(n),t=0;t<n.length;t+=1)i[this.makeDigit(t,r)]=this.makeDigit(n[t],r);return i},n.prototype.getPaletteReferenceStarting=function(n){for(var i={},t=0;t<n.length;t+=1)i[this.makeDigit(t,this.digitsizeDefault)]=this.makeDigit(t,this.digitsizeDefault);return i},n.prototype.getClosestInPalette=function(n,t){for(var u=Infinity,r,f,i=n.length-1;i>=0;i-=1)r=this.arrayDifference(n[i],t),r<u&&(u=r,f=i);return f},n.prototype.stringOf=function(n,t){return t===void 0&&(t=1),t===0?"":new Array(1+(t||1)).join(n)},n.prototype.makeDigit=function(n,t,i){return i===void 0&&(i="0"),this.stringOf(i,Math.max(0,t-String(n).length))+n},n.prototype.makeSizedDigit=function(n,t){return this.makeDigit(t,n,"0")},n.prototype.arrayReplace=function(n,t,i){for(var r=n.length-1;r>=0;r-=1)n[r]===t&&(n[r]=i);return n},n.prototype.arrayDifference=function(n,t){for(var r=0,i=n.length-1;i>=0;i-=1)r+=Math.abs(n[i]-t[i])|0;return r},n.prototype.getValueIndices=function(n){for(var i={},t=0;t<n.length;t+=1)i[n[t]]=t;return i},n.prototype.getKeyValue=function(n,t){return n[t]},n.prototype.followPath=function(n,t,i){return i<t.length&&n.hasOwnProperty(t[i])?this.followPath(n[t[i]],t,i+1):n},n}();n.PixelRendr=t}(PixelRendr||(PixelRendr={})),function(n){"use strict";var t=function(){function n(n){if(!n.ObjectMaker)throw new Error("No ObjectMaker given to QuadsKeepr.");if(this.ObjectMaker=n.ObjectMaker,!n.numRows)throw new Error("No numRows given to QuadsKeepr.");if(this.numRows=n.numRows,!n.numCols)throw new Error("No numCols given to QuadsKeepr.");if(this.numCols=n.numCols,!n.quadrantWidth)throw new Error("No quadrantWidth given to QuadsKeepr.");if(this.quadrantWidth=n.quadrantWidth|0,!n.quadrantHeight)throw new Error("No quadrantHeight given to QuadsKeepr.");if(this.quadrantHeight=n.quadrantHeight|0,!n.groupNames)throw new Error("No groupNames given to QuadsKeepr.");this.groupNames=n.groupNames;this.onAdd=n.onAdd;this.onRemove=n.onRemove;this.startLeft=n.startLeft|0;this.startTop=n.startTop|0;this.keyTop=n.keyTop||"top";this.keyLeft=n.keyLeft||"left";this.keyBottom=n.keyBottom||"bottom";this.keyRight=n.keyRight||"right";this.keyNumQuads=n.keyNumQuads||"numquads";this.keyQuadrants=n.keyQuadrants||"quadrants";this.keyChanged=n.keyChanged||"changed";this.keyToleranceX=n.keyToleranceX||"tolx";this.keyToleranceY=n.keyToleranceY||"toly";this.keyGroupName=n.keyGroupName||"group";this.keyOffsetX=n.keyOffsetX;this.keyOffsetY=n.keyOffsetY}return n.prototype.getQuadrantRows=function(){return this.quadrantRows},n.prototype.getQuadrantCols=function(){return this.quadrantCols},n.prototype.getNumRows=function(){return this.numRows},n.prototype.getNumCols=function(){return this.numCols},n.prototype.getQuadrantWidth=function(){return this.quadrantWidth},n.prototype.getQuadrantHeight=function(){return this.quadrantHeight},n.prototype.resetQuadrants=function(){var i=this.startLeft,r=this.startTop,u,n,t;for(this.top=this.startTop,this.right=this.startLeft+this.quadrantWidth*this.numCols,this.bottom=this.startTop+this.quadrantHeight*this.numRows,this.left=this.startLeft,this.quadrantRows=[],this.quadrantCols=[],this.offsetX=0,this.offsetY=0,n=0;n<this.numRows;n+=1)this.quadrantRows.push({left:this.startLeft,top:r,quadrants:[]}),r+=this.quadrantHeight;for(t=0;t<this.numCols;t+=1)this.quadrantCols.push({left:i,top:this.startTop,quadrants:[]}),i+=this.quadrantWidth;for(r=this.startTop,n=0;n<this.numRows;n+=1){for(i=this.startLeft,t=0;t<this.numCols;t+=1)u=this.createQuadrant(i,r),this.quadrantRows[n].quadrants.push(u),this.quadrantCols[t].quadrants.push(u),i+=this.quadrantWidth;r+=this.quadrantHeight}if(this.onAdd)this.onAdd("xInc",this.top,this.right,this.bottom,this.left)},n.prototype.shiftQuadrants=function(n,t){n===void 0&&(n=0);t===void 0&&(t=0);var i,r;for(n=n|0,t=t|0,this.offsetX+=n,this.offsetY+=t,this.top+=t,this.right+=n,this.bottom+=t,this.left+=n,i=0;i<this.numRows;i+=1)this.quadrantRows[i].left+=n,this.quadrantRows[i].top+=t;for(r=0;r<this.numCols;r+=1)this.quadrantCols[r].left+=n,this.quadrantCols[r].top+=t;for(i=0;i<this.numRows;i+=1)for(r=0;r<this.numCols;r+=1)this.shiftQuadrant(this.quadrantRows[i].quadrants[r],n,t);this.adjustOffsets()},n.prototype.pushQuadrantRow=function(n){n===void 0&&(n=!1);var i=this.createQuadrantRow(this.left,this.bottom),t;for(this.numRows+=1,this.quadrantRows.push(i),t=0;t<this.quadrantCols.length;t+=1)this.quadrantCols[t].quadrants.push(i.quadrants[t]);if(this.bottom+=this.quadrantHeight,n&&this.onAdd)this.onAdd("yInc",this.bottom,this.right,this.bottom-this.quadrantHeight,this.left);return i},n.prototype.pushQuadrantCol=function(n){n===void 0&&(n=!1);var i=this.createQuadrantCol(this.right,this.top),t;for(this.numCols+=1,this.quadrantCols.push(i),t=0;t<this.quadrantRows.length;t+=1)this.quadrantRows[t].quadrants.push(i.quadrants[t]);if(this.right+=this.quadrantWidth,n&&this.onAdd)this.onAdd("xInc",this.top,this.right-this.offsetY,this.bottom,this.right-this.quadrantWidth-this.offsetY);return i},n.prototype.popQuadrantRow=function(n){n===void 0&&(n=!1);for(var t=0;t<this.quadrantCols.length;t+=1)this.quadrantCols[t].quadrants.pop();if(this.numRows-=1,this.quadrantRows.pop(),n&&this.onRemove)this.onRemove("yInc",this.bottom,this.right,this.bottom-this.quadrantHeight,this.left);this.bottom-=this.quadrantHeight},n.prototype.popQuadrantCol=function(n){n===void 0&&(n=!1);for(var t=0;t<this.quadrantRows.length;t+=1)this.quadrantRows[t].quadrants.pop();if(this.numCols-=1,this.quadrantCols.pop(),n&&this.onRemove)this.onRemove("xDec",this.top,this.right-this.offsetY,this.bottom,this.right-this.quadrantWidth-this.offsetY);this.right-=this.quadrantWidth},n.prototype.unshiftQuadrantRow=function(n){n===void 0&&(n=!1);var i=this.createQuadrantRow(this.left,this.top-this.quadrantHeight),t;for(this.numRows+=1,this.quadrantRows.unshift(i),t=0;t<this.quadrantCols.length;t+=1)this.quadrantCols[t].quadrants.unshift(i.quadrants[t]);if(this.top-=this.quadrantHeight,n&&this.onAdd)this.onAdd("yInc",this.top,this.right,this.top+this.quadrantHeight,this.left);return i},n.prototype.unshiftQuadrantCol=function(n){n===void 0&&(n=!1);var i=this.createQuadrantCol(this.left-this.quadrantWidth,this.top),t;for(this.numCols+=1,this.quadrantCols.unshift(i),t=0;t<this.quadrantRows.length;t+=1)this.quadrantRows[t].quadrants.unshift(i.quadrants[t]);if(this.left-=this.quadrantWidth,n&&this.onAdd)this.onAdd("xInc",this.top,this.left,this.bottom,this.left+this.quadrantWidth);return i},n.prototype.shiftQuadrantRow=function(n){n===void 0&&(n=!1);for(var t=0;t<this.quadrantCols.length;t+=1)this.quadrantCols[t].quadrants.shift();if(this.numRows-=1,this.quadrantRows.pop(),n&&this.onRemove)this.onRemove("yInc",this.top,this.right,this.top+this.quadrantHeight,this.left);this.top+=this.quadrantHeight},n.prototype.shiftQuadrantCol=function(n){n===void 0&&(n=!1);for(var t=0;t<this.quadrantRows.length;t+=1)this.quadrantRows[t].quadrants.shift();if(this.numCols-=1,this.quadrantCols.pop(),n&&this.onRemove)this.onRemove("xInc",this.top,this.left+this.quadrantWidth,this.bottom,this.left);this.left+=this.quadrantWidth},n.prototype.determineAllQuadrants=function(n,t){for(var r,i=0;i<this.numRows;i+=1)for(r=0;r<this.numCols;r+=1)this.quadrantRows[i].quadrants[r].numthings[n]=0;t.forEach(this.determineThingQuadrants.bind(this))},n.prototype.determineThingQuadrants=function(n){var r=n[this.keyGroupName],u=this.findQuadrantRowStart(n),f=this.findQuadrantColStart(n),e=this.findQuadrantRowEnd(n),o=this.findQuadrantColEnd(n),t,i;for(n[this.keyChanged]&&this.markThingQuadrantsChanged(n),n[this.keyNumQuads]=0,t=u;t<=e;t+=1)for(i=f;i<=o;i+=1)this.setThingInQuadrant(n,this.quadrantRows[t].quadrants[i],r);n[this.keyChanged]=!1},n.prototype.setThingInQuadrant=function(n,t,i){n[this.keyQuadrants][n[this.keyNumQuads]]=t;n[this.keyNumQuads]+=1;t.things[i][t.numthings[i]]=n;t.numthings[i]+=1;n[this.keyChanged]&&(t.changed=!0)},n.prototype.adjustOffsets=function(){while(-this.offsetX>this.quadrantWidth)this.shiftQuadrantCol(!0),this.pushQuadrantCol(!0),this.offsetX+=this.quadrantWidth;while(this.offsetX>this.quadrantWidth)this.popQuadrantCol(!0),this.unshiftQuadrantCol(!0),this.offsetX-=this.quadrantWidth;while(-this.offsetY>this.quadrantHeight)this.unshiftQuadrantRow(!0),this.pushQuadrantRow(!0),this.offsetY+=this.quadrantHeight;while(this.offsetY>this.quadrantHeight)this.popQuadrantRow(!0),this.unshiftQuadrantRow(!0),this.offsetY-=this.quadrantHeight},n.prototype.shiftQuadrant=function(n,t,i){n.top+=i;n.right+=t;n.bottom+=i;n.left+=t;n.changed=!0},n.prototype.createQuadrant=function(n,t){var i=this.ObjectMaker.make("Quadrant"),r;for(i.changed=!0,i.things={},i.numthings={},r=0;r<this.groupNames.length;r+=1)i.things[this.groupNames[r]]=[],i.numthings[this.groupNames[r]]=0;return i.left=n,i.top=t,i.right=n+this.quadrantWidth,i.bottom=t+this.quadrantHeight,i.canvas=this.createCanvas(this.quadrantWidth,this.quadrantHeight),i.context=i.canvas.getContext("2d"),i},n.prototype.createQuadrantRow=function(n,t){n===void 0&&(n=0);t===void 0&&(t=0);for(var r={left:n,top:t,quadrants:[]},i=0;i<this.numCols;i+=1)r.quadrants.push(this.createQuadrant(n,t)),n+=this.quadrantWidth;return r},n.prototype.createQuadrantCol=function(n,t){for(var r={left:n,top:t,quadrants:[]},i=0;i<this.numRows;i+=1)r.quadrants.push(this.createQuadrant(n,t)),t+=this.quadrantHeight;return r},n.prototype.getTop=function(n){return this.keyOffsetY?n[this.keyTop]-Math.abs(n[this.keyOffsetY]):n[this.keyTop]},n.prototype.getRight=function(n){return this.keyOffsetX?n[this.keyRight]+Math.abs(n[this.keyOffsetX]):n[this.keyRight]},n.prototype.getBottom=function(n){return this.keyOffsetX?n[this.keyBottom]+Math.abs(n[this.keyOffsetY]):n[this.keyBottom]},n.prototype.getLeft=function(n){return this.keyOffsetX?n[this.keyLeft]-Math.abs(n[this.keyOffsetX]):n[this.keyLeft]},n.prototype.markThingQuadrantsChanged=function(n){for(var t=0;t<n[this.keyNumQuads];t+=1)n[this.keyQuadrants][t].changed=!0},n.prototype.findQuadrantRowStart=function(n){return Math.max(Math.floor((this.getTop(n)-this.top)/this.quadrantHeight),0)},n.prototype.findQuadrantRowEnd=function(n){return Math.min(Math.floor((this.getBottom(n)-this.top)/this.quadrantHeight),this.numRows-1)},n.prototype.findQuadrantColStart=function(n){return Math.max(Math.floor((this.getLeft(n)-this.left)/this.quadrantWidth),0)},n.prototype.findQuadrantColEnd=function(n){return Math.min(Math.floor((this.getRight(n)-this.left)/this.quadrantWidth),this.numCols-1)},n.prototype.createCanvas=function(n,t){var i=document.createElement("canvas");return i.width=n,i.height=t,i},n}();n.QuadsKeepr=t}(QuadsKeepr||(QuadsKeepr={})),function(n){"use strict";var t=function(){function n(n){this.PixelRender=n.PixelRender;this.MapScreener=n.MapScreener;this.createCanvas=n.createCanvas;this.unitsize=n.unitsize||1;this.noRefill=n.noRefill;this.spriteCacheCutoff=n.spriteCacheCutoff||0;this.groupNames=n.groupNames;this.framerateSkip=n.framerateSkip||1;this.framesDrawn=0;this.epsilon=n.epsilon||.007;this.keyWidth=n.keyWidth||"width";this.keyHeight=n.keyHeight||"height";this.keyTop=n.keyTop||"top";this.keyRight=n.keyRight||"right";this.keyBottom=n.keyBottom||"bottom";this.keyLeft=n.keyLeft||"left";this.keyOffsetX=n.keyOffsetX;this.keyOffsetY=n.keyOffsetY;this.generateObjectKey=n.generateObjectKey||function(n){return n.toString()};this.resetBackground()}return n.prototype.getFramerateSkip=function(){return this.framerateSkip},n.prototype.getThingArray=function(){return this.thingArrays},n.prototype.getCanvas=function(){return this.canvas},n.prototype.getContext=function(){return this.context},n.prototype.getBackgroundCanvas=function(){return this.backgroundCanvas},n.prototype.getBackgroundContext=function(){return this.backgroundContext},n.prototype.getNoRefill=function(){return this.noRefill},n.prototype.getEpsilon=function(){return this.epsilon},n.prototype.setFramerateSkip=function(n){this.framerateSkip=n},n.prototype.setThingArrays=function(n){this.thingArrays=n},n.prototype.setCanvas=function(n){this.canvas=n;this.context=n.getContext("2d")},n.prototype.setNoRefill=function(n){this.noRefill=n},n.prototype.setEpsilon=function(n){this.epsilon=n},n.prototype.resetBackground=function(){this.backgroundCanvas=this.createCanvas(this.MapScreener[this.keyWidth],this.MapScreener[this.keyHeight]);this.backgroundContext=this.backgroundCanvas.getContext("2d")},n.prototype.setBackground=function(n){this.backgroundContext.fillStyle=n;this.backgroundContext.fillRect(0,0,this.MapScreener[this.keyWidth],this.MapScreener[this.keyHeight])},n.prototype.drawBackground=function(){this.context.drawImage(this.backgroundCanvas,0,0)},n.prototype.setThingSprite=function(n){n.hidden||(n.sprite=this.PixelRender.decode(this.generateObjectKey(n),n),n.sprite.multiple?(n.numSprites=0,this.refillThingCanvasMultiple(n)):(n.numSprites=1,this.refillThingCanvasSingle(n)))},n.prototype.refillThingCanvasSingle=function(n){if(!(n[this.keyWidth]<1)&&!(n[this.keyHeight]<1)){var t=n.canvas,i=n.context,r=i.getImageData(0,0,t[this.keyWidth],t[this.keyHeight]);this.PixelRender.memcpyU8(n.sprite,r.data);i.putImageData(r,0,0)}},n.prototype.refillThingCanvasMultiple=function(n){if(!(n[this.keyWidth]<1)&&!(n[this.keyHeight]<1)){var i=n.sprite,e=n.canvases={direction:i.direction,multiple:!0},t,r,f,u;n.numSprites=1;for(u in i.sprites)i.sprites.hasOwnProperty(u)&&(t=this.createCanvas(n.spritewidth*this.unitsize,n.spriteheight*this.unitsize),r=t.getContext("2d"),f=r.getImageData(0,0,t[this.keyWidth],t[this.keyHeight]),this.PixelRender.memcpyU8(i.sprites[u],f.data),r.putImageData(f,0,0),e[u]={canvas:t,context:r},n.numSprites+=1);n[this.keyWidth]*n[this.keyHeight]<this.spriteCacheCutoff?(n.canvas[this.keyWidth]=n[this.keyWidth]*this.unitsize,n.canvas[this.keyHeight]=n[this.keyHeight]*this.unitsize,this.drawThingOnContextMultiple(n.context,n.canvases,n,0,0)):n.canvas[this.keyWidth]=n.canvas[this.keyHeight]=0}},n.prototype.refillGlobalCanvas=function(){if(this.framesDrawn+=1,this.framesDrawn%this.framerateSkip==0){this.noRefill||this.drawBackground();for(var n=0;n<this.thingArrays.length;n+=1)this.refillThingArray(this.thingArrays[n])}},n.prototype.refillThingArray=function(n){for(var t=0;t<n.length;t+=1)this.drawThingOnContext(this.context,n[t])},n.prototype.refillQuadrantGroups=function(n){var t;if(this.framesDrawn+=1,this.framesDrawn%this.framerateSkip==0)for(t=0;t<n.length;t+=1)this.refillQuadrants(n[t].quadrants)},n.prototype.refillQuadrants=function(n){for(var t,i=0;i<n.length;i+=1)t=n[i],t.changed&&t[this.keyTop]<this.MapScreener[this.keyHeight]&&t[this.keyRight]>0&&t[this.keyBottom]>0&&t[this.keyLeft]<this.MapScreener[this.keyWidth]&&(this.refillQuadrant(t),this.context.drawImage(t.canvas,t[this.keyLeft],t[this.keyTop]))},n.prototype.refillQuadrant=function(n){var r,t,i;for(this.noRefill||n.context.drawImage(this.backgroundCanvas,n[this.keyLeft],n[this.keyTop],n.canvas[this.keyWidth],n.canvas[this.keyHeight],0,0,n.canvas[this.keyWidth],n.canvas[this.keyHeight]),t=this.groupNames.length-1;t>=0;t-=1)for(r=n.things[this.groupNames[t]],i=0;i<r.length;i+=1)this.drawThingOnQuadrant(r[i],n);n.changed=!1},n.prototype.drawThingOnContext=function(n,t){t.hidden||t.opacity<this.epsilon||t[this.keyHeight]<1||t[this.keyWidth]<1||this.getTop(t)>this.MapScreener[this.keyHeight]||this.getRight(t)<0||this.getBottom(t)<0||this.getLeft(t)>this.MapScreener[this.keyWidth]||(typeof t.numSprites=="undefined"&&this.setThingSprite(t),t.canvas[this.keyWidth]>0?this.drawThingOnContextSingle(n,t.canvas,t,this.getLeft(t),this.getTop(t)):this.drawThingOnContextMultiple(n,t.canvases,t,this.getLeft(t),this.getTop(t)))},n.prototype.drawThingOnQuadrant=function(n,t){if(!n.hidden&&!(this.getTop(n)>t[this.keyBottom])&&!(this.getRight(n)<t[this.keyLeft])&&!(this.getBottom(n)<t[this.keyTop])&&!(this.getLeft(n)>t[this.keyRight])&&!(n.opacity<this.epsilon))return n.numSprites===1?this.drawThingOnContextSingle(t.context,n.canvas,n,this.getLeft(n)-t[this.keyLeft],this.getTop(n)-t[this.keyTop]):this.drawThingOnContextMultiple(t.context,n.canvases,n,this.getLeft(n)-t[this.keyLeft],this.getTop(n)-t[this.keyTop])},n.prototype.drawThingOnContextSingle=function(n,t,i,r,u){i.repeat?this.drawPatternOnContext(n,t,r,u,i.unitwidth,i.unitheight,i.opacity||1):i.opacity!==1?(n.globalAlpha=i.opacity,n.drawImage(t,r,u,t.width*i.scale,t.height*i.scale),n.globalAlpha=1):n.drawImage(t,r,u,t.width*i.scale,t.height*i.scale)},n.prototype.drawThingOnContextMultiple=function(n,t,i,r,u){var o=i.sprite,h=u,c=r,w=r+i.unitwidth,b=u+i.unitheight,l=i.unitwidth,a=i.unitheight,k=i.spritewidthpixels,d=i.spriteheightpixels,y=Math.min(l,k),p=Math.min(a,d),s=i.opacity,e,f,v;switch(t.direction){case"vertical":(v=t[this.keyBottom])&&(f=o.bottomheight?o.bottomheight*this.unitsize:d,this.drawPatternOnContext(n,v.canvas,c,b-f,l,p,s),b-=f,a-=f);(v=t[this.keyTop])&&(f=o.topheight?o.topheight*this.unitsize:d,this.drawPatternOnContext(n,v.canvas,c,h,l,p,s),h+=f,a-=f);break;case"horizontal":(v=t[this.keyLeft])&&(e=o.leftwidth?o.leftwidth*this.unitsize:k,this.drawPatternOnContext(n,v.canvas,c,h,y,a,s),c+=e,l-=e);(v=t[this.keyRight])&&(e=o.rightwidth?o.rightwidth*this.unitsize:k,this.drawPatternOnContext(n,v.canvas,w-e,h,y,a,s),w-=e,l-=e);break;case"corners":f=o.topheight?o.topheight*this.unitsize:d;e=o.leftwidth?o.leftwidth*this.unitsize:k;this.drawPatternOnContext(n,t.topLeft.canvas,c,h,y,p,s);this.drawPatternOnContext(n,t[this.keyLeft].canvas,c,h+f,y,a-f*2,s);this.drawPatternOnContext(n,t.bottomLeft.canvas,c,b-f,y,p,s);c+=e;l-=e;e=o.rightwidth?o.rightwidth*this.unitsize:k;this.drawPatternOnContext(n,t[this.keyTop].canvas,c,h,l-e,p,s);this.drawPatternOnContext(n,t.topRight.canvas,w-e,h,y,p,s);h+=f;a-=f;f=o.bottomheight?o.bottomheight*this.unitsize:d;this.drawPatternOnContext(n,t[this.keyRight].canvas,w-e,h,y,a-f,s);this.drawPatternOnContext(n,t.bottomRight.canvas,w-e,b-f,y,p,s);this.drawPatternOnContext(n,t[this.keyBottom].canvas,c,b-f,l-e,p,s);w-=e;l-=e;b-=f;a-=f}(v=t.middle)&&h<b&&c<w&&(o.middleStretch?(n.globalAlpha=s,n.drawImage(v.canvas,c,h,l,a),n.globalAlpha=1):this.drawPatternOnContext(n,v.canvas,c,h,l,a,s))},n.prototype.getTop=function(n){return this.keyOffsetY?n[this.keyTop]+n[this.keyOffsetY]:n[this.keyTop]},n.prototype.getRight=function(n){return this.keyOffsetX?n[this.keyRight]+n[this.keyOffsetX]:n[this.keyRight]},n.prototype.getBottom=function(n){return this.keyOffsetX?n[this.keyBottom]+n[this.keyOffsetY]:n[this.keyBottom]},n.prototype.getLeft=function(n){return this.keyOffsetX?n[this.keyLeft]+n[this.keyOffsetX]:n[this.keyLeft]},n.prototype.drawPatternOnContext=function(n,t,i,r,u,f,e){n.globalAlpha=e;n.translate(i,r);n.fillStyle=n.createPattern(t,"repeat");n.fillRect(0,0,u,f);n.translate(-i,-r);n.globalAlpha=1},n}();n.PixelDrawr=t}(PixelDrawr||(PixelDrawr={})),function(n){"use strict";var t=function(){function n(n){this.time=0;this.events={};this.timingDefault=n.timingDefault||1;this.keyCycles=n.keyCycles||"cycles";this.keyClassName=n.keyClassName||"className";this.keyOnClassCycleStart=n.keyOnClassCycleStart||"onClassCycleStart";this.keyDoClassCycleStart=n.keyDoClassCycleStart||"doClassCycleStart";this.keyCycleCheckValidity=n.keyCycleCheckValidity;this.copyCycleSettings=typeof n.copyCycleSettings=="undefined"?!0:n.copyCycleSettings;this.classAdd=n.classAdd||this.classAddGeneric;this.classRemove=n.classRemove||this.classRemoveGeneric}return n.prototype.getTime=function(){return this.time},n.prototype.getEvents=function(){return this.events},n.prototype.addEvent=function(n,t){var u,i,r;for(t===void 0&&(t=1),u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];if(typeof n!="function")throw new Error("Invalid event given to addEvent.");return t=t||1,r=this.createEvent(n,this.time+t,t,u,1),this.insertEvent(r,r.timeDelay),r},n.prototype.addEventInterval=function(n,t,i){var f,r,u,e;for(t===void 0&&(t=1),i===void 0&&(i=1),f=[],r=3;r<arguments.length;r++)f[r-3]=arguments[r];if(typeof n!="function")throw new Error("Invalid event given to addEventInterval.");return t=t||1,i=i||1,e=Array.prototype.slice.call(arguments,3),u=this.createEvent(n,this.time+t,t,e,i),n.event=u,this.insertEvent(u,u.timeDelay),u},n.prototype.addEventIntervalSynched=function(n,t,i,r,u){var f=t*u.length,e=Math.ceil(this.time/f)*f,o=this,s=Array.prototype.slice.call(arguments),h=Function.apply.bind(this.addEventInterval,o,s);if(t=t||1,i=i||1,e===this.time)return h();this.addEvent(h,e-this.time,o,s,r)},n.prototype.handleEvents=function(){var t,n,r,i;if(this.time+=1,t=this.events[this.time],t){for(i=0,r=t.length;i<r;++i)n=t[i],n.repeat>0&&!n.callback.apply(this,n.args)&&(n.count_changer&&n.count_changer(n),n.repeat.constructor===Function?n.repeat.call(n)&&(n.count+=n.timeRepeat,this.insertEvent(n,n.timeDelay)):(n.repeat=n.repeat-1,n.repeat>0&&(n.timeDelay+=n.timeRepeat,this.insertEvent(n,n.timeDelay))));delete this.events[this.time]}},n.prototype.cancelEvent=function(n){n.repeat=0},n.prototype.cancelAllEvents=function(){this.events={}},n.prototype.cancelClassCycle=function(n,t){var i;n[this.keyCycles]&&n[this.keyCycles][t]&&(i=n[this.keyCycles][t],i.length=1,i[0]=!1,delete n[this.keyCycles][t])},n.prototype.cancelAllCycles=function(n){var t=n[this.keyCycles],i;for(var r in t)t.hasOwnProperty(r)&&(i=t[r],i.length=1,i[0]=!1,delete t[r])},n.prototype.addClassCycle=function(n,t,i,r){var f=typeof r=="function",u;return n[this.keyCycles]||(n[this.keyCycles]={}),this.cancelClassCycle(n,i),i=i||"0",u=n[this.keyCycles][i]=this.setClassCycle(n,t,f?0:r),u.event&&f&&(u.event.count_changer=r),this.cycleClass(n,t),u},n.prototype.addClassCycleSynched=function(n,t,i,r){var u;return n[this.keyCycles]||(n[this.keyCycles]={}),this.cancelClassCycle(n,i),i=i||"0",u=n[this.keyCycles][i]=this.setClassCycle(n,t,r,!0),this.cycleClass(n,n[this.keyCycles][i]),u},n.prototype.setClassCycle=function(n,t,i,r){r===void 0&&(r=!1);var f=this,u;return this.copyCycleSettings&&(t=this.makeSettingsCopy(t)),t.loc=t.oldclass=-1,u=r?this.addEventIntervalSynched:this.addEventInterval,u=u.bind(f),n[this.keyOnClassCycleStart]=function(){u(f.cycleClass,i||f.timingDefault,Infinity,n,t)},n[this.keyDoClassCycleStart]&&n[this.keyOnClassCycleStart](),t},n.prototype.cycleClass=function(n,t){var i,r;return!n||!t||!t.length||this.keyCycleCheckValidity&&!n[this.keyCycleCheckValidity]?!0:(t.oldclass!==-1&&t.oldclass!==""&&this.classRemove(n,t.oldclass),t.loc=(t.loc+=1)%t.length,i=t[t.loc],i?(r=i.constructor===Function?i(n,t):i,typeof r=="string"?(t.oldclass=r,this.classAdd(n,r),!1):r===!1):i===!1)},n.prototype.createEvent=function(n,t,i,r,u){return{callback:n,timeDelay:t,timeRepeat:i,args:r,repeat:u,count:0}},n.prototype.insertEvent=function(n,t){return this.events[t]?this.events[t].push(n):this.events[t]=[n],this.events[t]},n.prototype.makeSettingsCopy=function(n){var i=new n.constructor;for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i},n.prototype.classAddGeneric=function(n,t){n[this.keyClassName]+=" "+t},n.prototype.classRemoveGeneric=function(n,t){n[this.keyClassName]=n[this.keyClassName].replace(t,"")},n}();n.TimeHandlr=t}(TimeHandlr||(TimeHandlr={})),function(n){"use strict";var t=function(){function n(n){this.GameStarter=n.GameStarter;this.prethings=n.prethings;this.thingGroups=n.thingGroups;this.thingKeys=n.thingKeys;this.macros=n.macros;this.beautifier=n.beautifier;this.mapNameDefault=n.mapNameDefault||"New Map";this.mapTimeDefault=n.mapTimeDefault||Infinity;this.mapSettingDefault=n.mapSettingDefault||"";this.mapEntryDefault=n.mapEntryDefault||"";this.mapDefault=n.mapDefault;this.blocksize=n.blocksize||1;this.keyUndefined=n.keyUndefined||"-none-";this.currentPreThings=[];this.currentMode="Build";this.currentClickMode="Thing"}return n.prototype.getGameStarter=function(){return this.GameStarter},n.prototype.getOldInformation=function(){return this.oldInformation},n.prototype.getPreThings=function(){return this.prethings},n.prototype.getThingGroups=function(){return this.thingGroups},n.prototype.getThingKeys=function(){return this.thingKeys},n.prototype.getMacros=function(){return this.macros},n.prototype.getMapNameDefault=function(){return this.mapNameDefault},n.prototype.getMapTimeDefault=function(){return this.mapTimeDefault},n.prototype.getMapEntryDefault=function(){return this.mapEntryDefault},n.prototype.getMapDefault=function(){return this.mapDefault},n.prototype.getDisplay=function(){return this.display},n.prototype.getCurrentMode=function(){return this.currentMode},n.prototype.getBlockSize=function(){return this.blocksize},n.prototype.getBeautifier=function(){return this.beautifier},n.prototype.getCurrentPreThings=function(){return this.currentPreThings},n.prototype.getCurrentTitle=function(){return this.currentTitle},n.prototype.getCurrentArgs=function(){return this.currentArgs},n.prototype.getPageStylesAdded=function(){return this.pageStylesAdded},n.prototype.getKeyUndefined=function(){return this.keyUndefined},n.prototype.enable=function(){this.oldInformation={map:this.GameStarter.MapsHandler.getMapName()};this.clearAllThings();this.resetDisplay();this.GameStarter.InputWriter.setCanTrigger(!1);this.setCurrentMode("Build");this.setTextareaValue(this.stringifySmart(this.mapDefault),!0);this.resetDisplayMap();this.disableThing(this.GameStarter.player);this.pageStylesAdded||(this.GameStarter.addPageStyles(this.createPageStyles()),this.pageStylesAdded=!0);this.GameStarter.container.insertBefore(this.display.container,this.GameStarter.container.children[0])},n.prototype.disable=function(){this.display&&(this.GameStarter.container.removeChild(this.display.container),this.display=undefined,this.GameStarter.InputWriter.setCanTrigger(!0),this.GameStarter.setMap(this.oldInformation.map))},n.prototype.minimize=function(){this.display.minimizer.innerText="+";this.display.minimizer.onclick=this.maximize.bind(this);this.display.container.className+=" minimized"},n.prototype.maximize=function(){this.display.minimizer.innerText="-";this.display.minimizer.onclick=this.minimize.bind(this);this.display.container.className.indexOf("minimized")!==-1&&(this.display.container.className=this.display.container.className.replace(/ minimized/g,""))},n.prototype.startBuilding=function(){this.beautifyTextareaValue();this.setDisplayMap(!0);this.GameStarter.InputWriter.setCanTrigger(!1);this.setCurrentMode("Build");this.maximize()},n.prototype.startPlaying=function(){this.beautifyTextareaValue();this.setDisplayMap(!1);this.GameStarter.InputWriter.setCanTrigger(!0);this.setCurrentMode("Play");this.minimize()},n.prototype.downloadCurrentJSON=function(){var n=this.downloadFile(this.getMapName()+".json",this.display.stringer.textarea.value||"");window.open(n.href)},n.prototype.setCurrentJSON=function(n){this.startBuilding();this.setTextareaValue(n,!0);this.getMapObjectAndTry()},n.prototype.loadCurrentJSON=function(){this.display.inputDummy.click()},n.prototype.handleUploadCompletion=function(n){this.enable();this.setCurrentJSON(n.currentTarget.result);this.setSectionJSON()},n.prototype.setCurrentMode=function(n){this.currentMode=n},n.prototype.setCurrentClickMode=function(n,t){this.currentClickMode=n;this.cancelEvent(t)},n.prototype.setCurrentThing=function(n,t,i,r){i===void 0&&(i=0);r===void 0&&(r=0);this.currentTitle=n;this.currentArgs=t;this.currentPreThings=[{xloc:0,yloc:0,thing:this.GameStarter.ObjectMaker.make(this.currentTitle,this.GameStarter.proliferate({onThingMake:undefined,onThingAdd:undefined,onThingAdded:undefined,outerok:!0},this.getNormalizedThingArguments(t)))}];this.disableThing(this.currentPreThings[0].thing);this.GameStarter.addThing(this.currentPreThings[0].thing,i,r)},n.prototype.setCurrentMacroThings=function(){for(var n,t=0;t<this.currentPreThings.length;t+=1)n=this.currentPreThings[t],n.thing.outerok=!0,this.disableThing(n.thing),this.GameStarter.addThing(n.thing,n.xloc||0,n.yloc||0)},n.prototype.setCurrentArgs=function(){if(this.currentClickMode==="Thing")this.setCurrentThing(this.currentTitle,this.generateCurrentArgs());else this.onMacroIconClick(this.currentTitle,undefined,this.generateCurrentArgs())},n.prototype.onMouseDownScroller=function(n,t){var r=t.target,i=this;r.setAttribute("scrolling","1");this.GameStarter.TimeHandler.addEventInterval(function(){if(r.getAttribute("scrolling")!=="1")return!0;if(n<0&&i.GameStarter.MapScreener.left<=0){i.display.scrollers.left.style.opacity="0";return}i.GameStarter.scrollWindow(n);i.display.scrollers.left.style.opacity="1"},1,Infinity)},n.prototype.onMouseUpScrolling=function(n){n.target.setAttribute("scrolling","0")},n.prototype.onMouseMoveEditing=function(n){for(var r=n.x||n.clientX||0,u=n.y||n.clientY||0,t,i=0;i<this.currentPreThings.length;i+=1)(t=this.currentPreThings[i],t.thing)&&(this.GameStarter.setLeft(t.thing,this.roundTo(r-this.GameStarter.container.offsetLeft,this.blocksize)+(t.left||0)*this.GameStarter.unitsize),this.GameStarter.setTop(t.thing,this.roundTo(u-this.GameStarter.container.offsetTop,this.blocksize)-(t.top||0)*this.GameStarter.unitsize))},n.prototype.onClickEditingThing=function(n){if(this.currentMode==="Build"){var t=this.roundTo(n.x||n.clientX||0,this.blocksize),i=this.roundTo(n.y||n.clientY||0,this.blocksize);if(this.currentPreThings.length&&this.addMapCreationThing(t,i))this.onClickEditingGenericAdd(t,i,this.currentTitle,this.currentArgs)}},n.prototype.onClickEditingMacro=function(n){if(this.currentMode==="Build"){var r=this.roundTo(n.x||n.clientX||0,this.blocksize),u=this.roundTo(n.y||n.clientY||0,this.blocksize),t,i;if(this.currentPreThings.length&&this.addMapCreationMacro(r,u))for(i=0;i<this.currentPreThings.length;i+=1){t=this.currentPreThings[i];this.onClickEditingGenericAdd(r+(t.left||0)*this.GameStarter.unitsize,u-(t.top||0)*this.GameStarter.unitsize,t.thing.title||t.title,t.reference)}}},n.prototype.onClickEditingGenericAdd=function(n,t,i,r){var u=this.GameStarter.ObjectMaker.make(i,this.GameStarter.proliferate({onThingMake:undefined,onThingAdd:undefined,onThingAdded:undefined,movement:undefined},this.getNormalizedThingArguments(r)));this.currentMode==="Build"&&this.disableThing(u,.7);this.GameStarter.addThing(u,this.roundTo(n-this.GameStarter.container.offsetLeft,this.blocksize),this.roundTo(t-this.GameStarter.container.offsetTop,this.blocksize))},n.prototype.onThingIconClick=function(n,t){var u=t.x||t.clientX||0,f=t.y||t.clientY||0,i=t.target.nodeName==="DIV"?t.target:t.target.parentNode,r=this;this.cancelEvent(t);this.killCurrentPreThings();setTimeout(function(){r.setCurrentThing(n,r.getCurrentArgs(),u,f)});this.setVisualOptions(i.getAttribute("name"),undefined,i.options)},n.prototype.onMacroIconClick=function(n,t,i){t&&this.setVisualOptions(n,t,i);var r=this.getMapObject();r&&(this.currentPreThings=[],this.GameStarter.MapsCreator.analyzePreMacro(this.GameStarter.proliferate({macro:n},this.generateCurrentArgs()),this.createPrethingsHolder(this.currentPreThings),this.getCurrentAreaObject(r),r),this.currentTitle=n,this.setCurrentMacroThings())},n.prototype.createPrethingsHolder=function(n){var t={};return this.thingGroups.forEach(function(i){t[i]=n}),t},n.prototype.generateCurrentArgs=function(){var u={},o=this.display.sections.ClickToPlace.VisualOptions,t=o.getElementsByClassName("VisualOptionsList"),f,e,n,i,r;if(t.length===0)return u;for(t=t[0].childNodes,r=0;r<t.length;r+=1){f=t[r];e=f.querySelector(".VisualOptionLabel");n=f.querySelector(".VisualOptionValue");switch((n.getAttribute("data:type")||n.type).toLowerCase()){case"boolean":i=n.value==="true"?!0:!1;break;case"number":i=(Number(n.value)||0)*(Number(n.getAttribute("data:mod"))||1);break;default:i=n.value}i!==this.keyUndefined&&(u[e.textContent]=i)}return u},n.prototype.setMapName=function(){var n=this.getMapName(),t=this.getMapObject();t&&t.name!==n&&(t.name=n,this.display.namer.value=n,this.setTextareaValue(this.stringifySmart(t),!0),this.GameStarter.StatsHolder.setItem("world",n))},n.prototype.setMapTime=function(n){var i=this.getMapObject(),t;i&&(n?(t=Number(this.display.sections.MapSettings.Time.value),i.time=t):(t=i.time,this.display.sections.MapSettings.Time.value=t.toString()),this.setTextareaValue(this.stringifySmart(i),!0),this.GameStarter.StatsHolder.setItem("time",t),this.GameStarter.TimeHandler.cancelAllEvents())},n.prototype.setMapSetting=function(n){var i=this.getMapObject(),r,t;i&&(r=this.getCurrentAreaObject(i),n?(t=this.display.sections.MapSettings.Setting.Primary.value,this.display.sections.MapSettings.Setting.Secondary.value&&(t+=" "+this.display.sections.MapSettings.Setting.Secondary.value),this.display.sections.MapSettings.Setting.Tertiary.value&&(t+=" "+this.display.sections.MapSettings.Setting.Tertiary.value),r.setting=t):(t=r.setting.split(" "),this.display.sections.MapSettings.Setting.Primary.value=t[0],this.display.sections.MapSettings.Setting.Secondary.value=t[1],this.display.sections.MapSettings.Setting.Tertiary.value=t[2]),this.setTextareaValue(this.stringifySmart(i),!0),this.setDisplayMap(!0))},n.prototype.setLocationArea=function(){var n=this.getMapObject(),t;n&&(t=this.getCurrentLocationObject(n),t.area=this.getCurrentArea(),this.setTextareaValue(this.stringifySmart(n),!0),this.setDisplayMap(!0))},n.prototype.setMapEntry=function(n){var t=this.getMapObject(),r,i;t&&(r=this.getCurrentLocationObject(t),n?(i=this.display.sections.MapSettings.Entry.value,r.entry=i):(console.warn("Was this code ever reached? area.location?"),this.display.sections.MapSettings.Entry.value=i),this.setTextareaValue(this.stringifySmart(t),!0),this.setDisplayMap(!0))},n.prototype.setCurrentLocation=function(n){var t=this.getMapObject(),i;t&&(i=this.getCurrentLocationObject(t),n?this.display.sections.MapSettings.Area.value=i.area?i.area.toString():"0":console.warn("This code is never reached, right?"),this.setTextareaValue(this.stringifySmart(t),!0),this.setDisplayMap(!0))},n.prototype.addLocationToMap=function(){var t=this.display.sections.MapSettings.Location.options.length.toString(),n=this.getMapObject();n&&(n.locations[t]={entry:this.mapEntryDefault},this.resetAllVisualOptionSelects("VisualOptionLocation",Object.keys(n.locations)),this.setTextareaValue(this.stringifySmart(n),!0),this.setDisplayMap(!0))},n.prototype.addAreaToMap=function(){var t=this.display.sections.MapSettings.Area.options.length.toString(),n=this.getMapObject();n&&(n.areas[t]={setting:this.mapSettingDefault,creation:[]},this.resetAllVisualOptionSelects("VisualOptionArea",Object.keys(n.areas)),this.setTextareaValue(this.stringifySmart(n),!0),this.setDisplayMap(!0))},n.prototype.resetAllVisualOptionSelects=function(n,t){var e=this.getMapObject(),u=this.display.container.getElementsByClassName(n),o={children:t.map(function(n){return new Option(n,n)})},i,f,r;if(e)for(r=0;r<u.length;r+=1)i=u[r],f=i.value,i.textContent="",this.GameStarter.proliferateElement(i,o),i.value=f},n.prototype.getMapObject=function(){var n;try{n=this.parseSmart(this.display.stringer.textarea.value);this.display.stringer.messenger.textContent="";this.display.namer.value=n.name||this.mapNameDefault}catch(t){this.setSectionJSON();this.display.stringer.messenger.textContent=t.message}return n},n.prototype.getMapObjectAndTry=function(){var n=this.getMapName()+"::Temporary",t=this.getMapObject();if(!t)return!1;try{this.GameStarter.MapsCreator.storeMap(n,t);this.GameStarter.MapsCreator.getMap(n);this.setDisplayMap(!0)}catch(i){return this.display.stringer.messenger.textContent=i.message,!1}},n.prototype.getCurrentArea=function(){return this.display.sections.MapSettings.Area.value},n.prototype.getCurrentAreaObject=function(n){n===void 0&&(n=this.getMapObject());var t=n.locations[this.getCurrentLocation()].area;return n.areas[t?t.toString():"0"]},n.prototype.getCurrentLocation=function(){return this.display.sections.MapSettings.Location.value},n.prototype.getCurrentLocationObject=function(n){return n.locations[this.getCurrentLocation()]},n.prototype.addMapCreationThing=function(n,t){var i=this.getMapObject(),r=this.GameStarter.proliferate({thing:this.currentTitle,x:this.getNormalizedX(n)+this.GameStarter.MapScreener.left/this.GameStarter.unitsize,y:this.getNormalizedY(t)},this.currentArgs);return i?(i.areas[this.getCurrentArea()].creation.push(r),this.setTextareaValue(this.stringifySmart(i),!0),!0):!1},n.prototype.addMapCreationMacro=function(n,t){var i=this.getMapObject(),r=this.GameStarter.proliferate({macro:this.currentTitle,x:this.getNormalizedX(n)+this.GameStarter.MapScreener.left/this.GameStarter.unitsize,y:this.getNormalizedY(t)},this.generateCurrentArgs());return i?(i.areas[this.getCurrentArea()].creation.push(r),this.setTextareaValue(this.stringifySmart(i),!0),!0):!1},n.prototype.resetDisplay=function(){this.display={container:this.GameStarter.createElement("div",{className:"LevelEditor",onclick:this.cancelEvent.bind(this),ondragenter:this.handleDragEnter,ondragover:this.handleDragOver,ondrop:this.handleDragDrop}),scrollers:{},stringer:{},sections:{ClickToPlace:{},MapSettings:{Setting:{}},buttons:{ClickToPlace:{}}}};this.resetDisplayScrollers();this.resetDisplayGui();this.resetDisplayHead();this.resetDisplaySectionChoosers();this.resetDisplayOptionsList();this.resetDisplayMapSettings()},n.prototype.resetDisplayGui=function(){this.display.gui=this.GameStarter.createElement("div",{className:"EditorGui"});this.display.container.appendChild(this.display.gui)},n.prototype.resetDisplayScrollers=function(){this.display.scrollers={left:this.GameStarter.createElement("div",{className:"EditorScroller EditorScrollerLeft",onmousedown:this.onMouseDownScroller.bind(this,-this.GameStarter.unitsize*2),onmouseup:this.onMouseUpScrolling.bind(this),onmouseout:this.onMouseUpScrolling.bind(this),onclick:this.cancelEvent.bind(this),innerText:"<",style:{paddingTop:this.GameStarter.MapScreener.height/2-35+"px",fontSize:"70px",opacity:0}}),right:this.GameStarter.createElement("div",{className:"EditorScroller EditorScrollerRight",onmousedown:this.onMouseDownScroller.bind(this,this.GameStarter.unitsize*2),onmouseup:this.onMouseUpScrolling.bind(this),onmouseout:this.onMouseUpScrolling.bind(this),onclick:this.cancelEvent.bind(this),innerText:">",style:{paddingTop:this.GameStarter.MapScreener.height/2-35+"px",fontSize:"70px"}}),container:this.GameStarter.createElement("div",{className:"EditorScrollers",onmousemove:this.onMouseMoveEditing.bind(this),onclick:this.onClickEditingThing.bind(this)})};this.display.scrollers.container.appendChild(this.display.scrollers.left);this.display.scrollers.container.appendChild(this.display.scrollers.right);this.display.container.appendChild(this.display.scrollers.container)},n.prototype.resetDisplayHead=function(){this.display.minimizer=this.GameStarter.createElement("div",{className:"EditorHeadButton EditorMinimizer",onclick:this.minimize.bind(this),textContent:"-"});this.display.head=this.GameStarter.createElement("div",{className:"EditorHead",children:[this.GameStarter.createElement("div",{className:"EditorNameContainer",children:[this.display.namer=this.GameStarter.createElement("input",{className:"EditorNameInput",type:"text",placeholder:this.mapNameDefault,value:this.mapNameDefault,onkeyup:this.setMapName.bind(this),onchange:this.setMapName.bind(this)})]}),this.display.minimizer,this.GameStarter.createElement("div",{className:"EditorHeadButton EditorCloser",textContent:"X",onclick:this.disable.bind(this)})]});this.display.gui.appendChild(this.display.head)},n.prototype.resetDisplaySectionChoosers=function(){var n=this.GameStarter.createElement("div",{className:"EditorSectionChoosers",onclick:this.cancelEvent.bind(this),children:[this.display.sections.buttons.ClickToPlace.container=this.GameStarter.createElement("div",{className:"EditorMenuOption EditorSectionChooser EditorMenuOptionThird",style:{background:"white"},textContent:"Visual",onclick:this.setSectionClickToPlace.bind(this)}),this.display.sections.buttons.MapSettings=this.GameStarter.createElement("div",{className:"EditorMenuOption EditorSectionChooser EditorMenuOptionThird",style:{background:"gray"},textContent:"Map",onclick:this.setSectionMapSettings.bind(this)}),this.display.sections.buttons.JSON=this.GameStarter.createElement("div",{className:"EditorMenuOption EditorSectionChooser EditorMenuOptionThird",style:{background:"gray"},textContent:"JSON",onclick:this.setSectionJSON.bind(this)})]});this.display.gui.appendChild(n)},n.prototype.resetDisplayOptionsList=function(){this.display.sections.ClickToPlace.container=this.GameStarter.createElement("div",{className:"EditorOptionsList EditorSectionMain",onclick:this.cancelEvent.bind(this),style:{display:"block"}});this.resetDisplayOptionsListSubOptionsMenu();this.resetDisplayOptionsListSubOptions();this.display.gui.appendChild(this.display.sections.ClickToPlace.container)},n.prototype.resetDisplayOptionsListSubOptionsMenu=function(){var n=this.GameStarter.createElement("div",{className:"EditorSubOptionsListsMenu"});this.display.sections.buttons.ClickToPlace.Things=this.GameStarter.createElement("div",{className:"EditorMenuOption EditorSubOptionsListChooser EditorMenuOptionHalf",textContent:"Things",onclick:this.setSectionClickToPlaceThings.bind(this),style:{background:"#CCC"}});this.display.sections.buttons.ClickToPlace.Macros=this.GameStarter.createElement("div",{className:"EditorMenuOption EditorSubOptionsListChooser EditorMenuOptionHalf",textContent:"Macros",onclick:this.setSectionClickToPlaceMacros.bind(this),style:{background:"#777"}});n.appendChild(this.display.sections.buttons.ClickToPlace.Things);n.appendChild(this.display.sections.buttons.ClickToPlace.Macros);this.display.sections.ClickToPlace.container.appendChild(n)},n.prototype.resetDisplayMapSettings=function(){this.display.sections.MapSettings.container=this.GameStarter.createElement("div",{className:"EditorMapSettings EditorSectionMain",onclick:this.cancelEvent.bind(this),style:{display:"none"},children:[this.GameStarter.createElement("div",{className:"EditorMenuOption",textContent:"+ Add Area",onclick:this.addAreaToMap.bind(this)}),this.GameStarter.createElement("div",{className:"EditorMenuOption",textContent:"+ Add Location",onclick:this.addLocationToMap.bind(this)})]});this.resetDisplayMapSettingsCurrent();this.resetDisplayMapSettingsMap();this.resetDisplayMapSettingsLocation();this.resetDisplayJSON();this.resetDisplayVisualContainers();this.resetDisplayButtons();this.display.gui.appendChild(this.display.sections.MapSettings.container)},n.prototype.resetDisplayMapSettingsCurrent=function(){this.display.sections.MapSettings.container.appendChild(this.GameStarter.createElement("div",{className:"EditorMapSettingsSubGroup",children:[this.GameStarter.createElement("label",{textContent:"Current Location"}),this.display.sections.MapSettings.Location=this.createSelect(["0"],{className:"VisualOptionLocation",onchange:this.setCurrentLocation.bind(this,!0)})]}))},n.prototype.resetDisplayMapSettingsMap=function(){this.display.sections.MapSettings.container.appendChild(this.GameStarter.createElement("div",{className:"EditorMapSettingsGroup",children:[this.GameStarter.createElement("h4",{textContent:"Map"}),this.GameStarter.createElement("div",{className:"EditorMapSettingsSubGroup",children:[this.GameStarter.createElement("label",{className:"EditorMapSettingsLabel",textContent:"Time"}),this.display.sections.MapSettings.Time=this.createSelect(["100","200","300","400","500","1000","2000","Infinity"],{value:"Infinity",onchange:this.setMapTime.bind(this,!0)})]})]}))},n.prototype.resetDisplayMapSettingsLocation=function(){this.display.sections.MapSettings.container.appendChild(this.GameStarter.createElement("div",{className:"EditorMapSettingsGroup",children:[this.GameStarter.createElement("h4",{textContent:"Location"}),this.GameStarter.createElement("div",{className:"EditorMapSettingsSubGroup",children:[this.GameStarter.createElement("label",{textContent:"Area"}),this.display.sections.MapSettings.Area=this.createSelect(["0"],{className:"VisualOptionArea",onchange:this.setLocationArea.bind(this,!0)})]}),this.GameStarter.createElement("div",{className:"EditorMapSettingsSubGroup",children:[this.GameStarter.createElement("label",{textContent:"Setting"}),this.display.sections.MapSettings.Setting.Primary=this.createSelect(["Overworld","Underworld","Underwater","Castle"],{onchange:this.setMapSetting.bind(this,!0)}),this.display.sections.MapSettings.Setting.Secondary=this.createSelect(["","Night","Underwater","Alt"],{onchange:this.setMapSetting.bind(this,!0)}),this.display.sections.MapSettings.Setting.Tertiary=this.createSelect(["","Night","Underwater","Alt"],{onchange:this.setMapSetting.bind(this,!0)})]}),this.GameStarter.createElement("div",{className:"EditorMapSettingsSubGroup",children:[this.GameStarter.createElement("label",{textContent:"Entrance"}),this.display.sections.MapSettings.Entry=this.createSelect(["Plain","Normal","Castle","PipeVertical","PipeHorizontal"],{onchange:this.setMapEntry.bind(this,!0)})]})]}))},n.prototype.resetDisplayJSON=function(){this.display.sections.JSON=this.GameStarter.createElement("div",{className:"EditorJSON EditorSectionMain",onclick:this.cancelEvent.bind(this),style:{display:"none"},children:[this.display.stringer.textarea=this.GameStarter.createElement("textarea",{className:"EditorJSONInput",spellcheck:!1,onkeyup:this.getMapObjectAndTry.bind(this),onchange:this.getMapObjectAndTry.bind(this)}),this.display.stringer.messenger=this.GameStarter.createElement("div",{className:"EditorJSONInfo"})]});this.display.gui.appendChild(this.display.sections.JSON)},n.prototype.resetDisplayVisualContainers=function(){this.display.sections.ClickToPlace.VisualSummary=this.GameStarter.createElement("div",{className:"EditorVisualSummary",onclick:this.cancelEvent.bind(this)});this.display.sections.ClickToPlace.VisualOptions=this.GameStarter.createElement("div",{className:"EditorVisualOptions",onclick:this.cancelEvent.bind(this),textContent:"Click an icon to view options.",style:{display:"block"}});this.display.gui.appendChild(this.display.sections.ClickToPlace.VisualSummary);this.display.gui.appendChild(this.display.sections.ClickToPlace.VisualOptions)},n.prototype.resetDisplayButtons=function(){var n=this;this.display.gui.appendChild(this.GameStarter.createElement("div",{className:"EditorMenu",onclick:this.cancelEvent.bind(this),children:function(t){return Object.keys(t).map(function(i){return n.GameStarter.createElement("div",{className:"EditorMenuOption EditorMenuOptionFifth EditorMenuOption-"+i,textContent:i,onclick:t[i][0].bind(n),children:t[i][1]})})}({Build:[this.startBuilding.bind(this)],Play:[this.startPlaying.bind(this)],Save:[this.downloadCurrentJSON.bind(this)],Load:[this.loadCurrentJSON.bind(this),this.display.inputDummy=this.GameStarter.createElement("input",{type:"file",style:{display:"none"},onchange:this.handleUploadStart.bind(this)})],Reset:[this.resetDisplayMap.bind(this)]})}))},n.prototype.resetDisplayOptionsListSubOptions=function(){this.resetDisplayOptionsListSubOptionsThings();this.resetDisplayOptionsListSubOptionsMacros()},n.prototype.resetDisplayOptionsListSubOptionsThings=function(){var n=this,t=this.onThingIconClick;this.display.sections.ClickToPlace.Things=this.GameStarter.createElement("div",{className:"EditorSectionSecondary EditorOptions EditorOptions-Things",style:{display:"block"},children:function(){var u=0,i=Object.keys(n.prethings).map(function(i){var r=Object.keys(n.prethings[i]).map(function(r){var u=n.GameStarter.ObjectMaker.make(r),s=n.GameStarter.createElement("div",{className:"EditorListOption",name:r,options:n.prethings[i][r],children:[u.canvas],onclick:t.bind(n,r)}),f=70,h=u.width*n.GameStarter.unitsize,c=u.height*n.GameStarter.unitsize,e=(f-h)/2,o=(f-c)/2;return u.canvas.style.top=o+"px",u.canvas.style.right=e+"px",u.canvas.style.bottom=o+"px",u.canvas.style.left=e+"px",n.GameStarter.PixelDrawer.setThingSprite(u),s});return n.GameStarter.createElement("div",{className:"EditorOptionContainer",style:{display:"none"},children:r})}),r=n.createSelect(Object.keys(n.prethings),{className:"EditorOptionContainerSwitchers",onchange:function(){i[u+1].style.display="none";i[r.selectedIndex+1].style.display="block";u=r.selectedIndex}});return i[0].style.display="block",i.unshift(r),i}()});this.display.sections.ClickToPlace.container.appendChild(this.display.sections.ClickToPlace.Things)},n.prototype.resetDisplayOptionsListSubOptionsMacros=function(){var n=this;n.display.sections.ClickToPlace.Macros=n.GameStarter.createElement("div",{className:"EditorSectionSecondary EditorOptions EditorOptions-Macros",style:{display:"none"},children:Object.keys(n.macros).map(function(t){var i=n.macros[t];return n.GameStarter.createElement("div",{className:"EditorOptionContainer",children:[n.GameStarter.createElement("div",{className:"EditorOptionTitle EditorMenuOption",textContent:t,onclick:n.onMacroIconClick.bind(n,t,i.description,i.options)})]})})});this.display.sections.ClickToPlace.container.appendChild(this.display.sections.ClickToPlace.Macros)},n.prototype.setSectionClickToPlace=function(){this.display.sections.ClickToPlace.VisualOptions.style.display="block";this.display.sections.ClickToPlace.container.style.display="block";this.display.sections.MapSettings.container.style.display="none";this.display.sections.JSON.style.display="none";this.display.sections.buttons.ClickToPlace.container.style.backgroundColor="white";this.display.sections.buttons.MapSettings.style.background="gray";this.display.sections.buttons.JSON.style.background="gray"},n.prototype.setSectionMapSettings=function(){this.display.sections.ClickToPlace.VisualOptions.style.display="none";this.display.sections.ClickToPlace.container.style.display="none";this.display.sections.MapSettings.container.style.display="block";this.display.sections.JSON.style.display="none";this.display.sections.buttons.ClickToPlace.container.style.background="gray";this.display.sections.buttons.MapSettings.style.background="white";this.display.sections.buttons.JSON.style.background="gray"},n.prototype.setSectionJSON=function(){this.display.sections.ClickToPlace.VisualOptions.style.display="none";this.display.sections.ClickToPlace.container.style.display="none";this.display.sections.MapSettings.container.style.display="none";this.display.sections.JSON.style.display="block";this.display.sections.buttons.ClickToPlace.container.style.background="gray";this.display.sections.buttons.MapSettings.style.background="gray";this.display.sections.buttons.JSON.style.background="white"},n.prototype.setSectionClickToPlaceThings=function(n){this.setCurrentClickMode("Thing",n);this.display.container.onclick=this.onClickEditingThing.bind(this);this.display.scrollers.container.onclick=this.onClickEditingThing.bind(this);this.display.sections.ClickToPlace.VisualOptions.style.display="block";this.display.sections.ClickToPlace.Things.style.display="block";this.display.sections.ClickToPlace.Macros.style.display="none";this.display.sections.buttons.ClickToPlace.Things.style.background="#CCC";this.display.sections.buttons.ClickToPlace.Macros.style.background="#777"},n.prototype.setSectionClickToPlaceMacros=function(n){this.setCurrentClickMode("Macro",n);this.display.container.onclick=this.onClickEditingMacro.bind(this);this.display.scrollers.container.onclick=this.onClickEditingMacro.bind(this);this.display.sections.ClickToPlace.VisualOptions.style.display="block";this.display.sections.ClickToPlace.Things.style.display="none";this.display.sections.ClickToPlace.Macros.style.display="block";this.display.sections.buttons.ClickToPlace.Things.style.background="#777";this.display.sections.buttons.ClickToPlace.Macros.style.background="#CCC"},n.prototype.setTextareaValue=function(n,t){t===void 0&&(t=!1);this.display.stringer.textarea.value=t?this.beautifier(n):n},n.prototype.beautifyTextareaValue=function(){this.display.stringer.textarea.value=this.beautifier(this.display.stringer.textarea.value)},n.prototype.setVisualOptions=function(n,t,i){var r=this.display.sections.ClickToPlace.VisualOptions,f=this.createVisualOption.bind(this),u=this;r.textContent="";r.appendChild(this.GameStarter.createElement("h3",{className:"VisualOptionName",textContent:n}));t&&r.appendChild(this.GameStarter.createElement("div",{className:"VisualOptionDescription",textContent:t}));i&&r.appendChild(u.GameStarter.createElement("div",{className:"VisualOptionsList",children:Object.keys(i).map(function(n){return u.GameStarter.createElement("div",{className:"VisualOption",children:[u.GameStarter.createElement("div",{className:"VisualOptionLabel",textContent:n}),f(i[n])]})})}));this.display.sections.ClickToPlace.VisualSummary.textContent=n},n.prototype.createVisualOption=function(n){var t=this.createVisualOptionObject(n);switch(t.type){case"Boolean":return this.createVisualOptionBoolean();case"Number":return this.createVisualOptionNumber(t);case"Select":return this.createVisualOptionSelect(t);case"String":return this.createVisualOptionString(t);case"Location":return this.createVisualOptionLocation(t);case"Area":return this.createVisualOptionArea(t);case"Everything":return this.createVisualOptionEverything(t);default:return this.createVisualOptionDefault(t)}},n.prototype.createVisualOptionObject=function(n){var t;switch(n.constructor){case Number:t={type:"Number",mod:n};break;case String:t={type:n};break;case Array:t={type:"Select",options:n};break;default:t=n}return t},n.prototype.createVisualOptionBoolean=function(){return this.createSelect(["false","true"],{className:"VisualOptionValue","data:type":"Boolean",onchange:this.setCurrentArgs.bind(this)})},n.prototype.createVisualOptionNumber=function(n){var t=this;return this.GameStarter.createElement("div",{className:"VisualOptionHolder",children:function(){var u=n.mod||1,i=t.GameStarter.createElement("input",{type:"Number","data:type":"Number",value:n.value===undefined?1:n.value},{className:"VisualOptionValue modReal"+u,onchange:t.setCurrentArgs.bind(t)}),f=[i],e,r;if(i.setAttribute("data:mod",u.toString()),n.Infinite){if(e=undefined,r=t.createSelect(["Number","Infinite"],{className:"VisualOptionInfiniter",onchange:function(){if(r.value==="Number"){i.type="Number";i.disabled=!1;i.value=e;i.onchange(undefined)}else{i.type="Text";i.disabled=!0;e=i.value;i.value="Infinity";i.onchange(undefined)}}}),n.value===Infinity){r.value="Infinite";r.onchange(undefined)}f.push(r)}return u>1&&f.push(t.GameStarter.createElement("div",{className:"VisualOptionRecommendation",textContent:"x"+n.mod})),f}()})},n.prototype.createVisualOptionSelect=function(n){return this.createSelect(n.options,{className:"VisualOptionValue","data:type":"Boolean",onchange:this.setCurrentArgs.bind(this)})},n.prototype.createVisualOptionString=function(n){return this.createSelect(n.options,{className:"VisualOptionValue","data:type":"String",onchange:this.setCurrentArgs.bind(this)})},n.prototype.createVisualOptionLocation=function(){var t=this.getMapObject(),n;return t?(n=Object.keys(t.locations),n.unshift(this.keyUndefined),this.createSelect(n,{className:"VisualOptionValue VisualOptionLocation","data-type":"Number"})):this.GameStarter.createElement("div",{className:"VisualOptionValue VisualOptionLocation EditorComplaint",text:"Fix map compilation to get locations!"})},n.prototype.createVisualOptionArea=function(){var t=this.getMapObject(),n;return t?(n=Object.keys(t.areas),n.unshift(this.keyUndefined),this.createSelect(n,{className:"VisualOptionValue VisualOptionArea","data-type":"Number",onchange:this.setCurrentArgs.bind(this)})):this.GameStarter.createElement("div",{className:"VisualOptionValue VisualOptionArea EditorComplaint",text:"Fix map compilation to get areas!"})},n.prototype.createVisualOptionEverything=function(){return this.createSelect(this.thingKeys,{className:"VisualOptionValue VisualOptionEverything","data-type":"String",onchange:this.setCurrentArgs.bind(this)})},n.prototype.createVisualOptionDefault=function(n){return this.GameStarter.createElement("div",{className:"EditorComplaint",textContent:"Unknown type requested: "+n.type})},n.prototype.resetDisplayMap=function(){this.setTextareaValue(this.stringifySmart(this.mapDefault),!0);this.setDisplayMap(!0);this.GameStarter.InputWriter.setCanTrigger(!1)},n.prototype.setDisplayMap=function(n){n===void 0&&(n=!1);var u=this.display.stringer.textarea.value,t=this.getMapName(),i,f;try{i=this.parseSmart(u);this.setTextareaValue(this.display.stringer.textarea.value)}catch(r){this.setSectionJSON();this.display.stringer.messenger.textContent=r.message;return}try{this.GameStarter.MapsCreator.storeMap(t,i);f=this.GameStarter.MapsCreator.getMap(t)}catch(r){this.setSectionJSON();this.display.stringer.messenger.textContent=r.message;return}this.display.stringer.messenger.textContent="";this.setTextareaValue(this.display.stringer.textarea.value);this.GameStarter.setMap(t,this.getCurrentLocation());n&&this.disableAllThings()},n.prototype.getMapName=function(){return this.display.namer.value||this.mapNameDefault},n.prototype.roundTo=function(n,t){return Math.round(n/t)*t},n.prototype.stringifySmart=function(n){return n===void 0&&(n={}),JSON.stringify(n,this.jsonReplacerSmart)},n.prototype.parseSmart=function(n){return JSON.parse(n,this.jsonReplacerSmart)},n.prototype.jsonReplacerSmart=function(n,t){return t!==t?"NaN":t===Infinity?"Infinity":t===-Infinity?"-Infinity":t},n.prototype.disableThing=function(n,t){t===void 0&&(t=.49);n.movement=undefined;n.onThingMake=undefined;n.onThingAdd=undefined;n.onThingAdded=undefined;n.nofall=!0;n.nocollide=!0;n.xvel=0;n.yvel=0;n.opacity=typeof t},n.prototype.disableAllThings=function(){var i=this,n=this.GameStarter.GroupHolder.getGroups();for(var t in n)n.hasOwnProperty(t)&&n[t].forEach(function(n){i.disableThing(n)});this.GameStarter.StatsHolder.setItem("time",Infinity)},n.prototype.clearAllThings=function(){var i=this,n=this.GameStarter.GroupHolder.getGroups();for(var t in n)n.hasOwnProperty(t)&&n[t].forEach(function(n){i.GameStarter.killNormal(n)})},n.prototype.getNormalizedX=function(n){return n/this.GameStarter.unitsize},n.prototype.getNormalizedY=function(n){return this.GameStarter.MapScreener.floor-n/this.GameStarter.unitsize+this.GameStarter.unitsize*3},n.prototype.getNormalizedThingArguments=function(n){var t=this.GameStarter.proliferate({},n);return t.height===Infinity&&(t.height=this.GameStarter.MapScreener.height),t.width===Infinity&&(t.width=this.GameStarter.MapScreener.width),t},n.prototype.createSelect=function(n,t){for(var r=this.GameStarter.createElement("select",t),i=0;i<n.length;i+=1)r.appendChild(this.GameStarter.createElement("option",{value:n[i],textContent:n[i]}));return typeof t.value!="undefined"&&(r.value=t.value),r},n.prototype.downloadFile=function(n,t){var i=this.GameStarter.createElement("a",{download:n,href:"data:text/json;charset=utf-8,"+encodeURIComponent(t)});return this.display.container.appendChild(i),i.click(),this.display.container.removeChild(i),i},n.prototype.killCurrentPreThings=function(){for(var n=0;n<this.currentPreThings.length-1;n+=1)this.GameStarter.killNormal(this.currentPreThings[n].thing)},n.prototype.handleUploadStart=function(n){var t,i;(this.cancelEvent(n),n&&n.dataTransfer?t=n.dataTransfer.files[0]:(t=this.display.inputDummy.files[0],i=new FileReader),t)&&(i=new FileReader,i.onloadend=this.handleUploadCompletion.bind(this),i.readAsText(t))},n.prototype.handleDragEnter=function(){this.setSectionJSON()},n.prototype.handleDragOver=function(n){this.cancelEvent(n)},n.prototype.handleDragDrop=function(n){this.handleUploadStart(n)},n.prototype.cancelEvent=function(n){n&&(typeof n.preventDefault=="function"&&n.preventDefault(),typeof n.stopPropagation=="function"&&n.stopPropagation(),n.cancelBubble=!0)},n.prototype.createPageStyles=function(){return{".LevelEditor":{position:"absolute",top:"0",right:"0",bottom:"0",left:"0"},".LevelEditor h4":{margin:"14px 0 7px 0"},".LevelEditor select, .LevelEditor input":{margin:"7px",padding:"3px 7px","font-size":"1.17em"},".LevelEditor .EditorGui":{position:"absolute",top:"0",right:"0",bottom:"0",width:"50%",background:"rgba(0, 7, 14, .84)",overflow:"hidden","user-select":"none","box-sizing":"border-box","z-index":"70",transition:"117ms all"},".LevelEditor .EditorMenuContainer":{position:"absolute",top:"0",right:"0",bottom:"0",width:"50%",background:"rgba(0, 7, 14, .84)",overflow:"hidden","user-select":"none","box-sizing":"border-box","z-index":"70",transition:"117ms all"},".LevelEditor .EditorScrollers":{position:"absolute",top:"0",right:"50%",bottom:"0",left:"0",transition:"117ms all"},".EditorScroller":{position:"absolute",width:"70px",height:"101%",cursor:"pointer","box-sizing":"border-box","text-align":"center",transition:"280ms opacity"},".EditorScrollerRight":{right:"0"},".EditorScrollerLeft":{left:"0"},".LevelEditor.minimized .EditorGui":{width:"117px"},".LevelEditor.minimized .EditorMenuContainer":{width:"117px"},".LevelEditor.minimized .EditorScrollers":{right:"117px","padding-right":"117px"},".LevelEditor .EditorHead":{position:"relative",height:"35px"},".LevelEditor .EditorHead .EditorNameContainer":{position:"absolute",top:"1px",right:"73px",left:"2px",height:"35px"},".LevelEditor .EditorHead .EditorNameInput":{display:"block",margin:"0",padding:"3px 7px",width:"100%",background:"white",border:"1px solid black","font-size":"1.4em","box-sizing":"border-box"},".LevelEditor .EditorHead .EditorHeadButton":{position:"absolute",top:"2px",width:"32px",height:"32px",background:"rgb(35,35,35)",border:"1px solid silver","box-sizing":"border-box","text-align":"center","padding-top":"7px",cursor:"pointer"},".LevelEditor .EditorHead .EditorMinimizer":{right:"38px"},".LevelEditor .EditorHead .EditorCloser":{right:"3px"},".LevelEditor .EditorSectionChooser":{width:"50%","box-sizing":"border-box",height:"35px",background:"white",border:"3px solid black",color:"black",cursor:"pointer"},".LevelEditor .EditorSectionChooser.Inactive":{background:"gray"},".LevelEditor.minimized .EditorSectionChoosers":{opacity:"0"},".LevelEditor .EditorSectionMain":{position:"absolute",top:"70px",right:"0",bottom:"49px",left:"0","overflow-y":"auto"},".LevelEditor .EditorSectionSecondary":{position:"absolute",top:"35px",right:"248px",bottom:"0px",left:"0","overflow-y":"auto"},".LevelEditor .EditorJSON":{"font-family":"Courier"},".LevelEditor .EditorJSONInput":{display:"block",width:"100%",height:"84%",background:"rgba(0, 3, 7, .91)",color:"rgba(255, 245, 245, .91)","box-sizing":"border-box","overflow-y":"auto",resize:"none"},".LevelEditor .EditorJSONInfo":{height:"1.75em",padding:"3px 7px"},".LevelEditor.minimized .EditorJSON":{opacity:"0"},".LevelEditor .EditorOptions, .LevelEditor .EditorOptionContainer":{"padding-left":"3px",clear:"both","min-width":"98px"},".LevelEditor.minimized .EditorOptionsList":{opacity:"0"},".LevelEditor .EditorListOption":{position:"relative",float:"left",margin:"0 7px 7px 0",width:"70px",height:"70px",background:"black",border:"white",overflow:"hidden",cursor:"pointer"},".LevelEditor .EditorListOption canvas":{position:"absolute"},".LevelEditor .EditorVisualSummary":{margin:"42px 7px",opacity:"0",transition:"117ms opacity"},".LevelEditor.minimized .EditorVisualSummary":{opacity:"0"},".LevelEditor .EditorVisualOptions":{position:"absolute",right:"21px",top:"119px",bottom:"42px",padding:"7px 11px",width:"210px",border:"1px solid silver","border-width":"1px 0 0 1px","overflow-x":"visible","overflow-y":"auto",opacity:"1","box-sizing":"border-box",transition:"117ms opacity"},".LevelEditor.minimized .EditorVisualOptions":{left:"100%"},".LevelEditor .EditorVisualOptions .VisualOption":{padding:"14px 0"},".LevelEditor .EditorVisualOptions .VisualOptionName":{margin:"3px 0 7px 0"},".LevelEditor .EditorVisualOptions .VisualOptionDescription":{"padding-bottom":"14px"},".LevelEditor .EditorVisualOptions .VisualOptionValue":{"max-width":"117px"},".LevelEditor .EditorVisualOptions .VisualOptionInfiniter, .LevelEditor .EditorVisualOptions .VisualOptionRecommendation":{display:"inline"},".LevelEditor .EditorMenu":{position:"absolute",right:"0",bottom:"0",left:"0"},".LevelEditor .EditorMenuOption":{display:"inline-block",padding:"7px 14px",background:"white",border:"3px solid black","box-sizing":"border-box",color:"black","text-align":"center",overflow:"hidden",cursor:"pointer"},".LevelEditor.minimized .EditorMenuOption:not(:first-of-type)":{display:"none"},".LevelEditor.minimized .EditorMenuOption:first-of-type":{width:"auto"},".LevelEditor .EditorMenuOption:hover":{opacity:".91"},".LevelEditor .EditorMenuOption.EditorMenuOptionHalf":{width:"50%"},".LevelEditor .EditorMenuOption.EditorMenuOptionThird":{width:"33%"},".LevelEditor .EditorMenuOption.EditorMenuOptionFifth":{width:"20%"},".LevelEditor .EditorMapSettingsGroup":{"padding-left":"7px"},".LevelEditor .EditorMapSettingsSubGroup":{"padding-left":"14px"},".LevelEditor.minimized .EditorMapSettings":{opacity:"0"}}},n}();n.LevelEditr=t}(LevelEditr||(LevelEditr={})),function(n){"use strict";var t=function(){function n(n){(this.mods={},this.events={},n)&&(this.scopeDefault=n.scopeDefault,n.StatsHoldr?this.StatsHolder=n.StatsHoldr:n.storeLocally&&(this.StatsHolder=new StatsHoldr.StatsHoldr),n.mods&&this.addMods(n.mods))}return n.prototype.getMods=function(){return this.mods},n.prototype.getMod=function(n){return this.mods[n]},n.prototype.getEvents=function(){return this.events},n.prototype.getEvent=function(n){return this.events[n]},n.prototype.getStatsHolder=function(){return this.StatsHolder},n.prototype.addMod=function(n){var i=n.events;for(var t in i)i.hasOwnProperty(t)&&(this.events.hasOwnProperty(t)?this.events[t].push(n):this.events[t]=[n]);n.scope=n.scope||this.scopeDefault;this.mods[n.name]=n;n.enabled&&n.events.hasOwnProperty("onModEnable")&&this.fireModEvent("onModEnable",n.name,arguments);this.StatsHolder&&(this.StatsHolder.addItem(n.name,{valueDefault:0,storeLocally:!0}),this.StatsHolder.getItem(n.name)&&this.enableMod(n.name))},n.prototype.addMods=function(n){for(var t=0;t<n.length;t+=1)this.addMod(n[t])},n.prototype.enableMod=function(n){var t=this.mods[n],i;if(!t)throw new Error("No mod of name: '"+n+"'");return t.enabled=!0,i=Array.prototype.slice.call(arguments),i[0]=t,this.StatsHolder&&this.StatsHolder.setItem(n,!0),t.events.hasOwnProperty("onModEnable")?this.fireModEvent("onModEnable",t.name,arguments):void 0},n.prototype.enableMods=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];t.forEach(this.enableMod.bind(this))},n.prototype.disableMod=function(n){var t=this.mods[n],i;if(!this.mods[n])throw new Error("No mod of name: '"+n+"'");return this.mods[n].enabled=!1,i=Array.prototype.slice.call(arguments),i[0]=t,this.StatsHolder&&this.StatsHolder.setItem(n,!1),t.events.hasOwnProperty("onModDisable")?this.fireModEvent("onModDisable",t.name,i):void 0},n.prototype.disableMods=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];t.forEach(this.disableMod.bind(this))},n.prototype.toggleMod=function(n){var t=this.mods[n];if(!t)throw new Error("No mod found under "+n);return t.enabled?this.disableMod(n):this.enableMod(n)},n.prototype.toggleMods=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];t.forEach(this.toggleMod.bind(this))},n.prototype.fireEvent=function(n){for(var r,f,t,u,e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(r=this.events[n],f=Array.prototype.splice.call(arguments,0),r)for(u=0;u<r.length;u+=1)t=r[u],f[0]=t,t.enabled&&t.events[n].apply(t.scope,f)},n.prototype.fireModEvent=function(n,t){for(var i,u,f,e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];if(i=this.mods[t],u=Array.prototype.slice.call(arguments,2),!i)throw new Error("Unknown mod requested: '"+t+"'");if(u[0]=i,f=i.events[n],!f)throw new Error("Mod does not contain event: '"+n+"'");return f.apply(i.scope,u)},n}();n.ModAttachr=t}(ModAttachr||(ModAttachr={})),function(n){"use strict";var t=function(){function n(n){n===void 0&&(n={});this.stateLength=n.stateLength||624;this.statePeriod=n.statePeriod||397;this.matrixA=n.matrixA||2567483615;this.maskUpper=n.maskUpper||2147483648;this.maskLower=n.maskLower||2147483647;this.stateVector=new Array(this.stateLength);this.stateIndex=this.stateLength+1;this.matrixAMagic=[0,this.matrixA];this.resetFromSeed(n.seed||(new Date).getTime())}return n.prototype.getSeed=function(){return this.seed},n.prototype.getStateLength=function(){return this.stateLength},n.prototype.getStatePeriod=function(){return this.statePeriod},n.prototype.getMatrixA=function(){return this.matrixA},n.prototype.getMaskUpper=function(){return this.maskUpper},n.prototype.getMaskLower=function(){return this.maskLower},n.prototype.resetFromSeed=function(n){n===void 0&&(n=0);var t;for(this.stateVector[0]=n>>>0,this.stateIndex=1;this.stateIndex<this.stateLength;this.stateIndex+=1)t=this.stateVector[this.stateIndex-1]^this.stateVector[this.stateIndex-1]>>>30,this.stateVector[this.stateIndex]=(((t&4294901760)>>>16)*1812433253<<16)+(t&65535)*1812433253+this.stateIndex>>>0;this.seed=n},n.prototype.resetFromArray=function(n,t){t===void 0&&(t=n.length);var i=1,u=0,f,r;for(this.resetFromSeed(19650218),typeof t=="undefined"&&(t=n.length),f=this.stateLength>t?this.stateLength:t;f>0;)r=this.stateVector[i-1]^this.stateVector[i-1]>>>30,this.stateVector[i]=(this.stateVector[i]^(((r&4294901760)>>>16)*1664525<<16)+(r&65535)*1664525+n[u]+u)>>>0,i+=1,u+=1,i>=this.stateLength&&(this.stateVector[0]=this.stateVector[this.stateLength-1],i=1),u>=t&&(u=0);for(f=this.stateLength-1;f;f-=1)r=this.stateVector[i-1]^this.stateVector[i-1]>>>30,this.stateVector[i]=(this.stateVector[i]^(((r&4294901760)>>>16)*1566083941<<16)+(r&65535)*1566083941)-i>>>0,i+=1,i>=this.stateLength&&(this.stateVector[0]=this.stateVector[this.stateLength-1],i=1);this.stateVector[0]=2147483648;this.seed=n},n.prototype.randomInt32=function(){var n,t;if(this.stateIndex>=this.stateLength){for(this.stateIndex===this.stateLength+1&&this.resetFromSeed(5489),t=0;t<this.stateLength-this.statePeriod;t+=1)n=this.stateVector[t]&this.maskUpper|this.stateVector[t+1]&this.maskLower,this.stateVector[t]=this.stateVector[t+this.statePeriod]^n>>>1^this.matrixAMagic[n&1];for(;t<this.stateLength-1;t+=1)n=this.stateVector[t]&this.maskUpper|this.stateVector[t+1]&this.maskLower,this.stateVector[t]=this.stateVector[t+(this.statePeriod-this.stateLength)]^n>>>1^this.matrixAMagic[n&1];n=this.stateVector[this.stateLength-1]&this.maskUpper|this.stateVector[0]&this.maskLower;this.stateVector[this.stateLength-1]=this.stateVector[this.statePeriod-1]^n>>>1^this.matrixAMagic[n&1];this.stateIndex=0}return n=this.stateVector[this.stateIndex],this.stateIndex+=1,n^=n>>>11,n^=n<<7&2636928640,n^=n<<15&4022730752,n^=n>>>18,n>>>0},n.prototype.random=function(){return this.randomInt32()*(1/4294967296)},n.prototype.randomInt31=function(){return this.randomInt32()>>>1},n.prototype.randomReal1=function(){return this.randomInt32()*(1/4294967295)},n.prototype.randomReal3=function(){return(this.randomInt32()+.5)*(1/4294967296)},n.prototype.randomReal53Bit=function(){var n=this.randomInt32()>>>5,t=this.randomInt32()>>>6;return(n*67108864+t)*(1/9007199254740992)},n.prototype.randomUnder=function(n){return this.random()*n},n.prototype.randomWithin=function(n,t){return this.randomUnder(t-n)+n},n.prototype.randomInt=function(n){return this.randomUnder(n)|0},n.prototype.randomIntWithin=function(n,t){return this.randomUnder(t-n)+n|0},n.prototype.randomBoolean=function(){return this.randomInt(2)===1},n.prototype.randomBooleanProbability=function(n){return this.random()<n},n.prototype.randomBooleanFraction=function(n,t){return this.random()<=n/t},n.prototype.randomArrayIndex=function(n){return this.randomIntWithin(0,n.length)},n.prototype.randomArrayMember=function(n){return n[this.randomArrayIndex(n)]},n}();n.NumberMakr=t}(NumberMakr||(NumberMakr={})),function(n){"use strict";var t=function(){function n(n){this.globalCheckGenerators=n.globalCheckGenerators;this.hitCheckGenerators=n.hitCheckGenerators;this.hitFunctionGenerators=n.hitFunctionGenerators;this.groupNames=n.groupNames;this.keyNumQuads=n.keyNumQuads||"numquads";this.keyQuadrants=n.keyQuadrants||"quadrants";this.keyGroupName=n.keyGroupName||"group";this.hitChecks={};this.globalChecks={};this.hitFunctions={};this.cachedGroupNames={};this.cachedTypeNames={};this.checkHitsOf={}}return n.prototype.cacheHitCheckGroup=function(n){this.cachedGroupNames[n]||(this.cachedGroupNames[n]=!0,typeof this.globalCheckGenerators[n]!="undefined"&&(this.globalChecks[n]=this.cacheGlobalCheck(n)))},n.prototype.cacheHitCheckType=function(n,t){this.cachedTypeNames[n]||(typeof this.globalCheckGenerators[t]!="undefined"&&(this.globalChecks[n]=this.cacheGlobalCheck(t)),typeof this.hitCheckGenerators[t]!="undefined"&&(this.hitChecks[n]=this.cacheFunctionGroup(this.hitCheckGenerators[t])),typeof this.hitFunctionGenerators[t]!="undefined"&&(this.hitFunctions[n]=this.cacheFunctionGroup(this.hitFunctionGenerators[t])),this.cachedTypeNames[n]=!0,this.checkHitsOf[n]=this.generateHitsCheck(n).bind(this))},n.prototype.generateHitsCheck=function(n){return function(t){var e,i,o,u,r,f;if(typeof this.globalChecks[this.typeName]=="undefined"||this.globalChecks[this.typeName](t))for(u=0;u<t[this.keyNumQuads];u+=1)for(r=0;r<this.groupNames.length;r+=1)if(o=this.hitChecks[n][this.groupNames[r]],o)for(e=t[this.keyQuadrants][u].things[this.groupNames[r]],f=0;f<e.length;f+=1){if(i=e[f],t===i)break;(typeof this.globalChecks[i[this.keyGroupName]]=="undefined"||this.globalChecks[i[this.keyGroupName]](i))&&o(t,i)&&this.hitFunctions[n][i[this.keyGroupName]](t,i)}}},n.prototype.checkHit=function(n,t,i,r){var f=this.hitChecks[i],u;if(!f)throw new Error("No hit checks defined for "+i+".");if(u=f[r],!u)throw new Error("No hit check defined for "+i+" and "+r+".");return u(n,t)},n.prototype.cacheGlobalCheck=function(n){return this.globalCheckGenerators[n]()},n.prototype.cacheFunctionGroup=function(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t]());return i},n}();n.ThingHittr=t}(ThingHittr||(ThingHittr={})),function(n){"use strict";var t=function(){function n(n){if(this.directionOpposites={top:"bottom",right:"left",bottom:"top",left:"right"},this.directionSizing={top:"height",right:"width",bottom:"height",left:"width"},this.directionNames=["top","right","bottom","left"],this.sizingNames=["width","height"],typeof n.possibilities=="undefined")throw new Error("No possibilities given to WorldSeedr.");this.possibilities=n.possibilities;this.random=n.random||Math.random.bind(Math);this.onPlacement=n.onPlacement||console.log.bind(console,"Got:");this.clearGeneratedCommands()}return n.prototype.getPossibilities=function(){return this.possibilities},n.prototype.setPossibilities=function(n){this.possibilities=n},n.prototype.getOnPlacement=function(){return this.onPlacement},n.prototype.setOnPlacement=function(n){this.onPlacement=n},n.prototype.clearGeneratedCommands=function(){this.generatedCommands=[]},n.prototype.runGeneratedCommands=function(){this.onPlacement(this.generatedCommands)},n.prototype.generate=function(n,t){var i=this.possibilities[n];if(!i)throw new Error("No possibility exists under '"+n+"'");if(!i.contents)throw new Error("Possibility '"+n+"' has no possibile outcomes.");return this.generateChildren(i,this.objectCopy(t))},n.prototype.generateFull=function(n){var t=this.generate(n.title,n),i,r;if(t&&t.children)for(r=0;r<t.children.length;r+=1){i=t.children[r];switch(i.type){case"Known":this.generatedCommands.push(i);break;case"Random":this.generateFull(i)}}},n.prototype.generateChildren=function(n,t,i){i===void 0&&(i=undefined);var r=n.contents,f=r.spacing||0,e=this.objectMerge(n,t),u;i=r.direction||i;switch(r.mode){case"Random":u=this.generateChildrenRandom(r,e,i,f);break;case"Certain":u=this.generateChildrenCertain(r,e,i,f);break;case"Repeat":u=this.generateChildrenRepeat(r,e,i,f);break;case"Multiple":u=this.generateChildrenMultiple(r,e,i,f)}return this.wrapChoicePositionExtremes(u)},n.prototype.generateChildrenCertain=function(n,t,i,r){var u=this;return n.children.map(function(f){if(f.type==="Final")return u.parseChoiceFinal(n,f,t,i);var e=u.parseChoice(f,t,i);return e&&(e.type!=="Known"&&(e.contents=u.generate(e.title,t)),u.shrinkPositionByChild(t,e,i,r)),e}).filter(function(n){return n!==undefined})},n.prototype.generateChildrenRepeat=function(n,t,i,r){for(var o=n.children,s=[],f,u,e=0;this.positionIsNotEmpty(t,i);){if(f=o[e],f.type==="Final"?u=this.parseChoiceFinal(n,f,t,i):(u=this.parseChoice(f,t,i),u&&u.type!=="Known"&&(u.contents=this.generate(u.title,t))),u&&this.choiceFitsPosition(u,t))this.shrinkPositionByChild(t,u,i,r),s.push(u);else break;e+=1;e>=o.length&&(e=0)}return s},n.prototype.generateChildrenRandom=function(n,t,i,r){for(var f=[],u;this.positionIsNotEmpty(t,i);){if(u=this.generateChild(n,t,i),!u)break;if(this.shrinkPositionByChild(t,u,i,r),f.push(u),n.limit&&f.length>n.limit)return}return f},n.prototype.generateChildrenMultiple=function(n,t,i,r){var u=this;return n.children.map(function(n){var f=u.parseChoice(n,u.objectCopy(t),i);return i&&u.movePositionBySpacing(t,i,r),f})},n.prototype.generateChild=function(n,t,i){var r=this.chooseAmongPosition(n.children,t);return r?this.parseChoice(r,t,i):undefined},n.prototype.parseChoice=function(n,t,i){var f=n.title,u=this.possibilities[f],r={title:f,type:n.type,arguments:n.arguments instanceof Array?this.chooseAmong(n.arguments).values:n.arguments,width:undefined,height:undefined,top:undefined,right:undefined,bottom:undefined,left:undefined};this.ensureSizingOnChoice(r,n,u);this.ensureDirectionBoundsOnChoice(r,t);r[i]=r[this.directionOpposites[i]]+r[this.directionSizing[i]];switch(u.contents.snap){case"top":r.bottom=r.top-r.height;break;case"right":r.left=r.right-r.width;break;case"bottom":r.top=r.bottom+r.height;break;case"left":r.right=r.left+r.width}return n.stretch&&(r.arguments||(r.arguments={}),n.stretch.width&&(r.left=t.left,r.right=t.right,r.width=r.right-r.left,r.arguments.width=r.width),n.stretch.height&&(r.top=t.top,r.bottom=t.bottom,r.height=r.top-r.bottom,r.arguments.height=r.height)),this.copySchemaArguments(u,n,r),r},n.prototype.parseChoiceFinal=function(n,t,i){var r=this.possibilities[t.source],u={type:"Known",title:t.title,arguments:t.arguments,width:r.width,height:r.height,top:i.top,right:i.right,bottom:i.bottom,left:i.left};return this.copySchemaArguments(r,t,u),u},n.prototype.chooseAmong=function(n){if(!n.length)return undefined;if(n.length===1)return n[0];for(var r=this.randomPercentage(),i=0,t=0;t<n.length;t+=1)if(i+=n[t].percent,i>=r)return n[t]},n.prototype.chooseAmongPosition=function(n,t){var r=t.right-t.left,u=t.top-t.bottom,i=this;return this.chooseAmong(n.filter(function(n){return i.choiceFits(i.possibilities[n.title],r,u)}))},n.prototype.choiceFits=function(n,t,i){return n.width<=t&&n.height<=i},n.prototype.choiceFitsPosition=function(n,t){return this.choiceFits(n,t.right-t.left,t.top-t.bottom)},n.prototype.randomPercentage=function(){return Math.floor(this.random()*100)+1},n.prototype.randomBetween=function(n,t){return Math.floor(this.random()*(1+t-n))+n},n.prototype.objectCopy=function(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i},n.prototype.objectMerge=function(n,t){var r=this.objectCopy(n);for(var i in t)t.hasOwnProperty(i)&&!r.hasOwnProperty(i)&&(r[i]=t[i]);return r},n.prototype.positionIsNotEmpty=function(n,t){return t==="right"||t==="left"?n.left<n.right:n.top>n.bottom},n.prototype.shrinkPositionByChild=function(n,t,i,r){switch(i){case"top":n.bottom=t.top+this.parseSpacing(r);break;case"right":n.left=t.right+this.parseSpacing(r);break;case"bottom":n.top=t.bottom-this.parseSpacing(r);break;case"left":n.right=t.left-this.parseSpacing(r)}},n.prototype.movePositionBySpacing=function(n,t,i){i===void 0&&(i=0);var r=this.parseSpacing(i);switch(t){case"top":n.top+=r;n.bottom+=r;break;case"right":n.left+=r;n.right+=r;break;case"bottom":n.top-=r;n.bottom-=r;break;case"left":n.left-=r;n.right-=r}},n.prototype.parseSpacing=function(n){if(!n)return 0;switch(n.constructor){case Array:return n[0].constructor===Number?this.parseSpacingObject(this.randomBetween(n[0],n[1])):this.parseSpacingObject(this.chooseAmong(n).value);case Object:return this.parseSpacingObject(n);default:return n}},n.prototype.parseSpacingObject=function(n){if(n.constructor===Number)return n;var i=n.min,r=n.max,t=n.units||1;return this.randomBetween(i/t,r/t)*t},n.prototype.wrapChoicePositionExtremes=function(n){var t,i,r;if(!n||!n.length)return undefined;if(i=n[0],t={title:undefined,top:i.top,right:i.right,bottom:i.bottom,left:i.left,width:undefined,height:undefined,children:n},n.length===1)return t;for(r=1;r<n.length;r+=1){if(i=n[r],!Object.keys(i).length)return t;t.top=Math.max(t.top,i.top);t.right=Math.max(t.right,i.right);t.bottom=Math.min(t.bottom,i.bottom);t.left=Math.min(t.left,i.left)}return t.width=t.right-t.left,t.height=t.top-t.bottom,t},n.prototype.copySchemaArguments=function(n,t,i){var r=n.contents.argumentMap,u;if(r){i.arguments||(i.arguments={});for(u in r)r.hasOwnProperty(u)&&(i.arguments[r[u]]=t[u])}},n.prototype.ensureSizingOnChoice=function(n,t,i){var r;for(var u in this.sizingNames)this.sizingNames.hasOwnProperty(u)&&(r=this.sizingNames[u],n[r]=t.sizing&&typeof t.sizing[r]!="undefined"?t.sizing[r]:i[r])},n.prototype.ensureDirectionBoundsOnChoice=function(n,t){for(var i in this.directionNames)this.directionNames.hasOwnProperty(i)&&(n[this.directionNames[i]]=t[this.directionNames[i]])},n}();n.WorldSeedr=t}(WorldSeedr||(WorldSeedr={})),function(){function n(n,t){"use strict";var r=new i(n,t);return r.beautify()}function i(n,i){"use strict";function ri(n,t){var i=0;return n&&(i=n.indentation_level,!et()&&n.lineIndent_level>i&&(i=n.lineIndent_level)),{mode:t,parent:n,last_text:n?n.last_text:"",last_word:n?n.last_word:"",declaration_statement:!1,declaration_assignment:!1,in_html_comment:!1,multiline_frame:!1,if_block:!1,else_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:i,lineIndent_level:n?n.lineIndent_level:i,start_lineIndex:l.length,had_comment:!1,ternary_depth:0}}function ui(){return{text:[]}}function kt(n){if(n=n===undefined?!1:n,l.length)for(fi(l[l.length-1]);n&&l.length>1&&l[l.length-1].text.length===0;)l.pop(),fi(l[l.length-1])}function fi(n){while(n.text.length&&(n.text[n.text.length-1]===" "||n.text[n.text.length-1]===it||n.text[n.text.length-1]===ct))n.text.pop()}function dt(n){return n.replace(/^\s+|\s+$/g,"")}function hi(n){n=n.replace(/\x0d/g,"");for(var i=[],t=n.indexOf("\n");t!==-1;)i.push(n.substring(0,t)),n=n.substring(t+1),t=n.indexOf("\n");return n.length&&i.push(n),i}function et(){var n=l[l.length-1];return n.text.length===0}function ci(){if(et()){if(l.length===1)return!0;var n=l[l.length-2];return n.text.length===0}return!1}function ut(n){if(n=n===undefined?!1:n,e.wrap_line_length&&!n){var t=l[l.length-1],i=0;t.text.length>0&&(i=t.text.join("").length+s.length+(c?1:0),i>=e.wrap_line_length&&(n=!0))}(e.preserve_newlines&&tt||n)&&!et()&&a(!1,!0)}function a(n,t){if(c=!1,!t&&r.last_text!==";"&&r.last_text!==","&&r.last_text!=="="&&f!=="TK_OPERATOR")while(r.mode===h.Statement&&!r.if_block&&!r.do_block)nt();l.length===1&&et()||(n||!et())&&(r.multiline_frame=!0,l.push(ui()))}function li(){var n,t;if(et())if(n=l[l.length-1],e.keep_arrayIndentation&&ot(r.mode)&&tt)for(n.text.push(""),t=0;t<rt.length;t+=1)n.text.push(rt[t]);else ct&&n.text.push(ct),ai(r.indentation_level)}function ai(n){var i,t;if(l.length>1)for(i=l[l.length-1],r.lineIndent_level=n,t=0;t<n;t+=1)i.text.push(it)}function vi(){var n=l[l.length-1],t;c&&n.text.length&&(t=n.text[n.text.length-1],t!==" "&&t!==it&&n.text.push(" "))}function p(n){n=n||s;li();vi();c=!1;l[l.length-1].text.push(n)}function lt(){r.indentation_level+=1}function yi(){r.indentation_level>0&&(!r.parent||r.indentation_level>r.parent.indentation_level)&&(r.indentation_level-=1)}function ei(n){if(!n.multiline_frame)for(var i=n.start_lineIndex,r=0,t;i<l.length;)(t=l[i],i++,t.text.length!==0)&&(r=ct&&t.text[0]===ct?1:0,t.text[r]===it&&t.text.splice(r,1))}function at(n){r?(pt.push(r),k=r):k=ri(null,n);r=ri(k,n)}function ot(n){return n===h.ArrayLiteral}function vt(n){return v(n,[h.Expression,h.ForInitializer,h.Conditional])}function nt(){pt.length>0&&(k=r,r=pt.pop(),k.mode===h.Statement&&ei(k))}function wt(){return r.parent.mode===h.ObjectLiteral&&r.mode===h.Statement&&r.last_text===":"&&r.ternary_depth===0}function st(){return f==="TK_RESERVED"&&v(r.last_text,["var","let","const"])&&y==="TK_WORD"||f==="TK_RESERVED"&&r.last_text==="do"||f==="TK_RESERVED"&&r.last_text==="return"&&!tt||f==="TK_RESERVED"&&r.last_text==="else"&&!(y==="TK_RESERVED"&&s==="if")||f==="TK_END_EXPR"&&(k.mode===h.ForInitializer||k.mode===h.Conditional)||f==="TK_WORD"&&r.mode===h.BlockStatement&&!r.in_case&&!(s==="--"||s==="++")&&y!=="TK_WORD"&&y!=="TK_RESERVED"||r.mode===h.ObjectLiteral&&r.last_text===":"&&r.ternary_depth===0?(at(h.Statement),lt(),f==="TK_RESERVED"&&v(r.last_text,["var","let","const"])&&y==="TK_WORD"&&(r.declaration_statement=!0),wt()||ut(y==="TK_RESERVED"&&v(s,["do","for","if","while"])),!0):!1}function pi(n,t){for(var r,i=0;i<n.length;i++)if(r=dt(n[i]),r.charAt(0)!==t)return!1;return!0}function wi(n,t){for(var i=0,u=n.length,r;i<u;i++)if(r=n[i],r&&r.indexOf(t)!==0)return!1;return!0}function yt(n){return v(n,["case","return","do","if","throw","else"])}function v(n,t){for(var i=0;i<t.length;i+=1)if(t[i]===n)return!0;return!1}function bi(n){for(var e=!1,u="",r=0,f="",t=0,i;e||r<n.length;)if(i=n.charAt(r),r++,e){if(e=!1,i==="x")f=n.substr(r,2),r+=2;else if(i==="u")f=n.substr(r,4),r+=4;else{u+="\\"+i;continue}if(!f.match(/^[0123456789abcdefABCDEF]+$/))return n;if(t=parseInt(f,16),t>=0&&t<32){u+=i==="x"?"\\x"+f:"\\u"+f;continue}else if(t===34||t===39||t===92)u+="\\"+String.fromCharCode(t);else{if(i==="x"&&t>126&&t<=255)return n;u+=String.fromCharCode(t)}}else i==="\\"?e=!0:u+=i;return u}function ki(n){for(var t=u,i=o.charAt(t);v(i,bt)&&i!==n;){if(t++,t>=w)return!1;i=o.charAt(t)}return i===n}function oi(){var i,n,et,ot,a,ut,b,lt,nt,ft,p;if(g=0,u>=w)return["","TK_EOF"];for(tt=!1,rt=[],n=o.charAt(u),u+=1;v(n,bt);){if(n==="\n"?(g+=1,rt=[]):g&&(n===it?rt.push(it):n!=="\r"&&rt.push(" ")),u>=w)return["","TK_EOF"];n=o.charAt(u);u+=1}if(t.isIdentifierChar(o.charCodeAt(u-1))){if(u<w)while(t.isIdentifierChar(o.charCodeAt(u)))if(n+=o.charAt(u),u+=1,u===w)break;return u!==w&&n.match(/^[0-9]+[Ee]$/)&&(o.charAt(u)==="-"||o.charAt(u)==="+")?(et=o.charAt(u),u+=1,ot=oi(),n+=et+ot[0],[n,"TK_WORD"]):!(f==="TK_DOT"||f==="TK_RESERVED"&&v(r.last_text,["set","get"]))&&v(n,ni)?n==="in"?[n,"TK_OPERATOR"]:[n,"TK_RESERVED"]:[n,"TK_WORD"]}if(n==="("||n==="[")return[n,"TK_START_EXPR"];if(n===")"||n==="]")return[n,"TK_END_EXPR"];if(n==="{")return[n,"TK_START_BLOCK"];if(n==="}")return[n,"TK_END_BLOCK"];if(n===";")return[n,"TK_SEMICOLON"];if(n==="/"){if(a="",ut=!0,o.charAt(u)==="*"){if(u+=1,u<w)while(u<w&&!(o.charAt(u)==="*"&&o.charAt(u+1)&&o.charAt(u+1)==="/"))if(n=o.charAt(u),a+=n,(n==="\n"||n==="\r")&&(ut=!1),u+=1,u>=w)break;return u+=2,ut&&g===0?["/*"+a+"*/","TKInLINE_COMMENT"]:["/*"+a+"*/","TK_BLOCK_COMMENT"]}if(o.charAt(u)==="/"){for(a=n;o.charAt(u)!=="\r"&&o.charAt(u)!=="\n";)if(a+=o.charAt(u),u+=1,u>=w)break;return[a,"TK_COMMENT"]}}if(n==="`"||n==="'"||n==='"'||(n==="/"||e.e4x&&n==="<"&&o.slice(u-1).match(/^<([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*\/?\s*>/))&&(f==="TK_RESERVED"&&yt(r.last_text)||f==="TK_END_EXPR"&&v(k.mode,[h.Conditional,h.ForInitializer])||v(f,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var y=n,c=!1,st=!1;if(i=n,u<w)if(y==="/"){for(b=!1;c||b||o.charAt(u)!==y;)if(i+=o.charAt(u),c?c=!1:(c=o.charAt(u)==="\\",o.charAt(u)==="["?b=!0:o.charAt(u)==="]"&&(b=!1)),u+=1,u>=w)return[i,"TK_STRING"]}else if(e.e4x&&y==="<"){var ct=/<(\/?)([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*(\/?)\s*>/g,d=o.slice(u-1),s=ct.exec(d);if(s&&s.index===0){for(lt=s[2],nt=0;s;){var vt=!!s[1],at=s[2],pt=!!s[s.length-1]||at.slice(0,8)==="![CDATA[";if(at!==lt||pt||(vt?--nt:++nt),nt<=0)break;s=ct.exec(d)}return ft=s?s.index+s[0].length:d.length,u+=ft-1,[d.slice(0,ft),"TK_STRING"]}}else while(c||o.charAt(u)!==y)if(i+=o.charAt(u),c?((o.charAt(u)==="x"||o.charAt(u)==="u")&&(st=!0),c=!1):c=o.charAt(u)==="\\",u+=1,u>=w)return[i,"TK_STRING"];if(u+=1,i+=y,st&&e.unescape_strings&&(i=bi(i)),y==="/")while(u<w&&v(o.charAt(u),gt))i+=o.charAt(u),u+=1;return[i,"TK_STRING"]}if(n==="#"){if(l.length===1&&l[0].text.length===0&&o.charAt(u)==="!"){for(i=n;u<w&&n!=="\n";)n=o.charAt(u),i+=n,u+=1;return[dt(i)+"\n","TK_UNKNOWN"]}if(p="#",u<w&&v(o.charAt(u),ti)){do n=o.charAt(u),p+=n,u+=1;while(u<w&&n!=="#"&&n!=="=");return n==="#"||(o.charAt(u)==="["&&o.charAt(u+1)==="]"?(p+="[]",u+=2):o.charAt(u)==="{"&&o.charAt(u+1)==="}"&&(p+="{}",u+=2)),[p,"TK_WORD"]}}if(n==="<"&&o.substring(u-1,u+3)==="<!--"){for(u+=3,n="<!--";o.charAt(u)!=="\n"&&u<w;)n+=o.charAt(u),u++;return r.in_html_comment=!0,[n,"TK_COMMENT"]}if(n==="-"&&r.in_html_comment&&o.substring(u-1,u+2)==="-->")return r.in_html_comment=!1,u+=2,["-->","TK_COMMENT"];if(n===".")return[n,"TK_DOT"];if(v(n,ht)){while(u<w&&v(n+o.charAt(u),ht))if(n+=o.charAt(u),u+=1,u>=w)break;return n===","?[n,"TK_COMMA"]:n==="="?[n,"TK_EQUALS"]:[n,"TK_OPERATOR"]}return[n,"TK_UNKNOWN"]}function di(){st();var n=h.Expression;if(s==="["){if(f==="TK_WORD"||r.last_text===")"){f==="TK_RESERVED"&&v(r.last_text,ft)&&(c=!0);at(n);p();lt();e.spaceIn_paren&&(c=!0);return}n=h.ArrayLiteral;ot(r.mode)&&(r.last_text==="["||r.last_text===","&&(d==="]"||d==="}"))&&(e.keep_arrayIndentation||a())}else f==="TK_RESERVED"&&r.last_text==="for"?n=h.ForInitializer:f==="TK_RESERVED"&&v(r.last_text,["if","while"])&&(n=h.Conditional);r.last_text===";"||f==="TK_START_BLOCK"?a():f==="TK_END_EXPR"||f==="TK_START_EXPR"||f==="TK_END_BLOCK"||r.last_text==="."?ut(tt):f==="TK_RESERVED"&&s==="("||f==="TK_WORD"||f==="TK_OPERATOR"?f==="TK_RESERVED"&&(r.last_word==="function"||r.last_word==="typeof")||r.last_text==="*"&&d==="function"?e.jslint_happy&&(c=!0):f==="TK_RESERVED"&&(v(r.last_text,ft)||r.last_text==="catch")&&e.space_before_conditional&&(c=!0):c=!0;s==="("&&(f==="TK_EQUALS"||f==="TK_OPERATOR")&&(wt()||ut());at(n);p();e.spaceIn_paren&&(c=!0);lt()}function gi(){while(r.mode===h.Statement)nt();r.multiline_frame&&ut(s==="]"&&ot(r.mode)&&!e.keep_arrayIndentation);e.spaceIn_paren&&(f!=="TK_START_EXPR"||e.spaceIn_empty_paren?c=!0:(kt(),c=!1));s==="]"&&e.keep_arrayIndentation?(p(),nt()):(nt(),p());ei(k);r.do_while&&k.mode===h.Conditional&&(k.mode=h.Expression,r.do_block=!1,r.do_while=!1)}function nr(){at(h.BlockStatement);var n=ki("}"),t=n&&r.last_word==="function"&&f==="TK_END_EXPR";e.brace_style==="expand"?f!=="TK_OPERATOR"&&(t||f==="TK_EQUALS"||f==="TK_RESERVED"&&yt(r.last_text)&&r.last_text!=="else")?c=!0:a(!1,!0):f!=="TK_OPERATOR"&&f!=="TK_START_EXPR"?f==="TK_START_BLOCK"?a():c=!0:ot(k.mode)&&r.last_text===","&&(d==="}"?c=!0:a());p();lt()}function tr(){while(r.mode===h.Statement)nt();var n=f==="TK_START_BLOCK";e.brace_style==="expand"?n||a():n||(ot(r.mode)&&e.keep_arrayIndentation?(e.keep_arrayIndentation=!1,a(),e.keep_arrayIndentation=!0):a());nt();p()}function si(){if(st()||!tt||vt(r.mode)||f==="TK_OPERATOR"&&r.last_text!=="--"&&r.last_text!=="++"||f==="TK_EQUALS"||!e.preserve_newlines&&f==="TK_RESERVED"&&v(r.last_text,["var","let","const","set","get"])||a(),r.do_block&&!r.do_while){if(y==="TK_RESERVED"&&s==="while"){c=!0;p();c=!0;r.do_while=!0;return}a();r.do_block=!1}if(r.if_block)if(r.else_block||y!=="TK_RESERVED"||s!=="else"){while(r.mode===h.Statement)nt();r.if_block=!1;r.else_block=!1}else r.else_block=!0;if(y==="TK_RESERVED"&&(s==="case"||s==="default"&&r.in_case_statement)){a();(r.case_body||e.jslint_happy)&&(yi(),r.case_body=!1);p();r.in_case=!0;r.in_case_statement=!0;return}if(y==="TK_RESERVED"&&s==="function"&&((v(r.last_text,["}",";"])||et()&&!v(r.last_text,["[","{",":","=",","]))&&(ci()||r.had_comment||(a(),a(!0))),f==="TK_RESERVED"||f==="TK_WORD"?f==="TK_RESERVED"&&v(r.last_text,["get","set","new","return"])?c=!0:a():f==="TK_OPERATOR"||r.last_text==="="?c=!0:vt(r.mode)||a()),(f==="TK_COMMA"||f==="TK_START_EXPR"||f==="TK_EQUALS"||f==="TK_OPERATOR")&&(wt()||ut()),y==="TK_RESERVED"&&s==="function"){p();r.last_word=s;return}if(b="NONE",f==="TK_END_BLOCK"?y==="TK_RESERVED"&&v(s,["else","catch","finally"])?e.brace_style==="expand"||e.brace_style==="end-expand"?b="NEWLINE":(b="SPACE",c=!0):b="NEWLINE":f==="TK_SEMICOLON"&&r.mode===h.BlockStatement?b="NEWLINE":f==="TK_SEMICOLON"&&vt(r.mode)?b="SPACE":f==="TK_STRING"?b="NEWLINE":f==="TK_RESERVED"||f==="TK_WORD"||r.last_text==="*"&&d==="function"?b="SPACE":f==="TK_START_BLOCK"?b="NEWLINE":f==="TK_END_EXPR"&&(c=!0,b="NEWLINE"),y==="TK_RESERVED"&&v(s,ft)&&r.last_text!==")"&&(b=r.last_text==="else"?"SPACE":"NEWLINE"),y==="TK_RESERVED"&&v(s,["else","catch","finally"]))if(f!=="TK_END_BLOCK"||e.brace_style==="expand"||e.brace_style==="end-expand")a();else{kt(!0);var n=l[l.length-1];n.text[n.text.length-1]!=="}"&&a();c=!0}else b==="NEWLINE"?f==="TK_RESERVED"&&yt(r.last_text)?c=!0:f!=="TK_END_EXPR"?f==="TK_START_EXPR"&&y==="TK_RESERVED"&&v(s,["var","let","const"])||r.last_text===":"||(y==="TK_RESERVED"&&s==="if"&&r.last_word==="else"&&r.last_text!=="{"?c=!0:a()):y==="TK_RESERVED"&&v(s,ft)&&r.last_text!==")"&&a():ot(r.mode)&&r.last_text===","&&d==="}"?a():b==="SPACE"&&(c=!0);p();r.last_word=s;y==="TK_RESERVED"&&s==="do"&&(r.do_block=!0);y==="TK_RESERVED"&&s==="if"&&(r.if_block=!0)}function ir(){for(st()&&(c=!1);r.mode===h.Statement&&!r.if_block&&!r.do_block;)nt();p();r.mode===h.ObjectLiteral&&(r.mode=h.BlockStatement)}function rr(){st()?c=!0:f==="TK_RESERVED"||f==="TK_WORD"?c=!0:f==="TK_COMMA"||f==="TK_START_EXPR"||f==="TK_EQUALS"||f==="TK_OPERATOR"?wt()||ut():a();p()}function ur(){st();r.declaration_statement&&(r.declaration_assignment=!0);c=!0;p();c=!0}function fr(){if(r.declaration_statement){vt(r.parent.mode)&&(r.declaration_assignment=!1);p();r.declaration_assignment?(r.declaration_assignment=!1,a(!1,!0)):c=!0;return}p();r.mode===h.ObjectLiteral||r.mode===h.Statement&&r.parent.mode===h.ObjectLiteral?(r.mode===h.Statement&&nt(),a()):c=!0}function er(){s===":"&&r.mode===h.BlockStatement&&d==="{"&&(f==="TK_WORD"||f==="TK_RESERVED")&&(r.mode=h.ObjectLiteral);st();var n=!0,t=!0;if(f==="TK_RESERVED"&&yt(r.last_text)){c=!0;p();return}if(s==="*"&&f==="TK_DOT"&&!d.match(/^\d+$/)){p();return}if(s===":"&&r.in_case){r.case_body=!0;lt();p();a();r.in_case=!1;return}if(s==="::"){p();return}tt&&(s==="--"||s==="++")&&a(!1,!0);f==="TK_OPERATOR"&&ut();v(s,["--","++","!","~"])||v(s,["-","+"])&&(v(f,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||v(r.last_text,ft)||r.last_text===",")?(n=!1,t=!1,r.last_text===";"&&vt(r.mode)&&(n=!0),(f==="TK_RESERVED"||f==="TK_END_EXPR")&&(n=!0),(r.mode===h.BlockStatement||r.mode===h.Statement)&&(r.last_text==="{"||r.last_text===";")&&a()):s===":"?r.ternary_depth===0?(r.mode===h.BlockStatement&&(r.mode=h.ObjectLiteral),n=!1):r.ternary_depth-=1:s==="?"?r.ternary_depth+=1:s==="*"&&f==="TK_RESERVED"&&r.last_text==="function"&&(n=!1,t=!1);c=c||n;p();c=t}function or(){var n=hi(s),t,i=!1,r=!1,u=rt.join(""),f=u.length;for(a(!1,!0),n.length>1&&(pi(n.slice(1),"*")?i=!0:wi(n.slice(1),u)&&(r=!0)),p(n[0]),t=1;t<n.length;t++)a(!1,!0),i?p(" "+dt(n[t])):r&&n[t].length>f?p(n[t].substring(f)):l[l.length-1].text.push(n[t]);a(!1,!0)}function sr(){c=!0;p();c=!0}function hr(){tt?a(!1,!0):kt(!0);c=!0;p();a(!1,!0)}function cr(){st();f==="TK_RESERVED"&&yt(r.last_text)?c=!0:ut(r.last_text===")"&&e.break_chained_methods);p()}function lr(){p();s[s.length-1]==="\n"&&a()}var o,l,s,y,f,d,it,r,k,pt,bt,gt,ht,u,ft,ni,ti,b,tt,c,w,g,rt,ii,h,e,ct="";for(bt="\n\r\t ".split(""),gt="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split(""),ti="0123456789".split(""),ht="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! ~ , : ? ^ ^= |= :: =>",ht+=" <%= <% %> <?= <? ?>",ht=ht.split(" "),ft="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,yield".split(","),ni=ft.concat(["do","in","else","get","set","new","catch","finally","typeof"]),h={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},ii={TK_START_EXPR:di,TK_END_EXPR:gi,TK_START_BLOCK:nr,TK_END_BLOCK:tr,TK_WORD:si,TK_RESERVED:si,TK_SEMICOLON:ir,TK_STRING:rr,TK_EQUALS:ur,TK_OPERATOR:er,TK_COMMA:fr,TK_BLOCK_COMMENT:or,TKInLINE_COMMENT:sr,TK_COMMENT:hr,TK_DOT:cr,TK_UNKNOWN:lr},i=i?i:{},e={},i.spaceAfter_anon_function!==undefined&&i.jslint_happy===undefined&&(i.jslint_happy=i.spaceAfter_anon_function),i.braces_on_own_line!==undefined&&(e.brace_style=i.braces_on_own_line?"expand":"collapse"),e.brace_style=i.brace_style?i.brace_style:e.brace_style?e.brace_style:"collapse",e.brace_style==="expand-strict"&&(e.brace_style="expand"),e.indent_size=i.indent_size?parseInt(i.indent_size,10):4,e.indent_char=i.indent_char?i.indent_char:" ",e.preserve_newlines=i.preserve_newlines===undefined?!0:i.preserve_newlines,e.break_chained_methods=i.break_chained_methods===undefined?!1:i.break_chained_methods,e.max_preserve_newlines=i.max_preserve_newlines===undefined?0:parseInt(i.max_preserve_newlines,10),e.spaceIn_paren=i.spaceIn_paren===undefined?!1:i.spaceIn_paren,e.spaceIn_empty_paren=i.spaceIn_empty_paren===undefined?!1:i.spaceIn_empty_paren,e.jslint_happy=i.jslint_happy===undefined?!1:i.jslint_happy,e.keep_arrayIndentation=i.keep_arrayIndentation===undefined?!1:i.keep_arrayIndentation,e.space_before_conditional=i.space_before_conditional===undefined?!0:i.space_before_conditional,e.unescape_strings=i.unescape_strings===undefined?!1:i.unescape_strings,e.wrap_line_length=i.wrap_line_length===undefined?0:parseInt(i.wrap_line_length,10),e.e4x=i.e4x===undefined?!1:i.e4x,i.indent_with_tabs&&(e.indent_char="\t",e.indent_size=1),it="";e.indent_size>0;)it+=e.indent_char,e.indent_size-=1;while(n&&(n.charAt(0)===" "||n.charAt(0)==="\t"))ct+=n.charAt(0),n=n.substring(1);o=n;w=n.length;f="TK_START_BLOCK";d="";l=[ui()];c=!1;rt=[];pt=[];at(h.BlockStatement);u=0;this.beautify=function(){for(var i,n,o,u,t;;){if(i=oi(),s=i[0],y=i[1],y==="TK_EOF"){while(r.mode===h.Statement)nt();break}if(o=e.keep_arrayIndentation&&ot(r.mode),tt=g>0,o)for(n=0;n<g;n+=1)a(n>0);else if(e.max_preserve_newlines&&g>e.max_preserve_newlines&&(g=e.max_preserve_newlines),e.preserve_newlines&&g>1)for(a(),n=1;n<g;n+=1)a(!0);ii[y]();y!=="TKInLINE_COMMENT"&&y!=="TK_COMMENT"&&y!=="TK_BLOCK_COMMENT"&&y!=="TK_UNKNOWN"&&(d=r.last_text,f=y,r.last_text=s);r.had_comment=y==="TKInLINE_COMMENT"||y==="TK_COMMENT"||y==="TK_BLOCK_COMMENT"}for(u=l[0].text.join(""),t=1;t<l.length;t++)u+="\n"+l[t].text.join("");return u.replace(/[\r\n ]+$/,"")}}var t={};(function(n){var t="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",i=new RegExp("["+t+"]"),r=new RegExp("["+t+"̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿]"),u=n.isIdentifierStart=function(n){return n<65?n===36:n<91?!0:n<97?n===95:n<123?!0:n>=170&&i.test(String.fromCharCode(n))},f=n.isIdentifierChar=function(n){return n<48?n===36:n<58?!0:n<65?!1:n<91?!0:n<97?n===95:n<123?!0:n>=170&&r.test(String.fromCharCode(n))}})(t);typeof define=="function"&&define.amd?define([],function(){return{js_beautify:n}}):typeof exports!="undefined"?exports.js_beautify=n:typeof window!="undefined"?window.js_beautify=n:typeof global!="undefined"&&(global.js_beautify=n)}();__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){"use strict";var t=function(n){function t(t){t===void 0&&(t={});n.call(this,{customs:t,constantsSource:t.constantsSource,constants:t.constants,requirements:{global:{AudioPlayr:"References/AudioPlayr/AudioPlayr.ts",ChangeLinr:"References/ChangeLinr/ChangeLinr.ts",FPSAnalyzr:"References/FPSAnalyzr/FPSAnalyzr.ts",GamesRunnr:"References/GamesRunnr/GamesRunnr.ts",GroupHoldr:"References/GroupHoldr/GroupHoldr.ts",InputWritr:"References/InputWritr/InputWritr.ts",LevelEditr:"References/LevelEditr/LevelEditr.ts",NumberMakr:"References/NumberMakr/NumberMakr.ts",MapScreenr:"References/MapScreenr/MapScreenr.ts",MapsHandlr:"References/MapsHandlr/MapsHandlr.ts",ModAttachr:"References/ModAttachr/ModAttachr.ts",ObjectMakr:"References/ObjectMakr/ObjectMakr.ts",PixelDrawr:"References/PixelDrawr/PixelDrawr.ts",PixelRendr:"References/PixelRendr/PixelRendr.ts",QuadsKeepr:"References/QuadsKeepr/QuadsKeepr.ts",StatsHoldr:"References/StatsHoldr/StatsHoldr.ts",StringFilr:"References/StringFilr/StringFilr.ts",ThingHittr:"References/ThingHittr/ThingHittr.ts",TimeHandlr:"References/TimeHandlr/TimeHandlr.ts"}}});this.resets=["resetObjectMaker","resetPixelRender","resetTimeHandler","resetStatsHolder","resetAudioPlayer","resetQuadsKeeper","resetGamesRunner","resetGroupHolder","resetThingHitter","resetMapScreener","resetPixelDrawer","resetNumberMaker","resetMapsCreator","resetMapsHandler","resetInputWriter","resetLevelEditor","resetWorldSeeder","resetModAttacher","startModAttacher","resetContainer"]}return __extends(t,n),t.prototype.reset=function(n,t){EightBittr.EightBittr.prototype.reset(n,n.resets,t)},t.prototype.resetTimed=function(n,t){return EightBittr.EightBittr.prototype.resetTimed(n,n.resets,t)},t.prototype.resetObjectMaker=function(n){n.ObjectMaker=new ObjectMakr.ObjectMakr(n.proliferate({properties:{Quadrant:{EightBitter:n,GameStarter:n},Thing:{EightBitter:n,GameStarter:n}}},n.settings.objects))},t.prototype.resetQuadsKeeper=function(n,t){var i=t.width/(n.settings.quadrants.numCols-3),r=t.height/(n.settings.quadrants.numRows-2);n.QuadsKeeper=new QuadsKeepr.QuadsKeepr(n.proliferate({ObjectMaker:n.ObjectMaker,createCanvas:n.createCanvas,quadrantWidth:i,quadrantHeight:r,startLeft:-i,startHeight:-r,onAdd:n.onAreaSpawn.bind(n,n),onRemove:n.onAreaUnspawn.bind(n,n)},n.settings.quadrants))},t.prototype.resetPixelRender=function(n){n.PixelRender=new PixelRendr.PixelRendr(n.proliferate({scale:n.scale,QuadsKeeper:n.QuadsKeeper,unitsize:n.unitsize},n.settings.sprites))},t.prototype.resetPixelDrawer=function(n){n.PixelDrawer=new PixelDrawr.PixelDrawr(n.proliferate({PixelRender:n.PixelRender,MapScreener:n.MapScreener,createCanvas:n.createCanvas,unitsize:n.unitsize,generateObjectKey:n.generateObjectKey},n.settings.renderer))},t.prototype.resetTimeHandler=function(n){n.TimeHandler=new TimeHandlr.TimeHandlr(n.proliferate({classAdd:n.addClass,classRemove:n.removeClass},n.settings.events))},t.prototype.resetAudioPlayer=function(n){n.AudioPlayer=new AudioPlayr.AudioPlayr(n.proliferate({StatsHolder:n.StatsHolder},n.settings.audio))},t.prototype.resetGamesRunner=function(n){n.GamesRunner=new GamesRunnr.GamesRunnr(n.proliferate({adjustFramerate:!0,interval:1e3/60,scope:n,onPlay:n.onGamePlay.bind(n,n),onPause:n.onGamePause.bind(n,n),FPSAnalyzer:new FPSAnalyzr.FPSAnalyzr},n.settings.runner))},t.prototype.resetStatsHolder=function(n){n.StatsHolder=new StatsHoldr.StatsHoldr(n.proliferate({callbackArgs:[n]},n.settings.statistics))},t.prototype.resetGroupHolder=function(n){n.GroupHolder=new GroupHoldr.GroupHoldr(n.settings.groups)},t.prototype.resetThingHitter=function(n){n.ThingHitter=new ThingHittr.ThingHittr(n.proliferate({scope:n},n.settings.collisions))},t.prototype.resetMapScreener=function(n,t){n.MapScreener=new MapScreenr.MapScreenr({EightBitter:n,unitsize:n.unitsize,width:t.width,height:t.height,variableArgs:[n],variables:n.settings.maps.screenVariables})},t.prototype.resetNumberMaker=function(n){n.NumberMaker=new NumberMakr.NumberMakr},t.prototype.resetMapsCreator=function(n){n.MapsCreator=new MapsCreatr.MapsCreatr({ObjectMaker:n.ObjectMaker,groupTypes:n.settings.maps.groupTypes,macros:n.settings.maps.macros,entrances:n.settings.maps.entrances,maps:n.settings.maps.library,scope:n})},t.prototype.resetMapsHandler=function(n){n.MapsHandler=new MapsHandlr.MapsHandlr({MapsCreator:n.MapsCreator,MapScreener:n.MapScreener,screenAttributes:n.settings.maps.screenAttributes,onSpawn:n.settings.maps.onSpawn,onUnspawn:n.settings.maps.onUnspawn})},t.prototype.resetInputWriter=function(n){n.InputWriter=new InputWritr.InputWritr(n.proliferate({canTrigger:n.canInputsTrigger.bind(n,n)},n.settings.input.InputWritrArgs))},t.prototype.resetLevelEditor=function(n){n.LevelEditor=new LevelEditr.LevelEditr(n.proliferate({GameStarter:n,beautifier:js_beautify},n.settings.editor))},t.prototype.resetWorldSeeder=function(n){n.WorldSeeder=new WorldSeedr.WorldSeedr(n.proliferate({random:n.NumberMaker.random.bind(n.NumberMaker),onPlacement:n.mapPlaceRandomCommands.bind(n,n)},n.settings.generator))},t.prototype.resetModAttacher=function(n){n.ModAttacher=new ModAttachr.ModAttachr(n.proliferate({scopeDefault:n,StatsHoldr:n.StatsHolder},n.settings.mods))},t.prototype.startModAttacher=function(n,t){var i=t.mods,r;if(i)for(r in i)i.hasOwnProperty(r)&&i[r]&&n.ModAttacher.enableMod(r);n.ModAttacher.fireEvent("onReady",n,n)},t.prototype.resetContainer=function(n,t){n.container=n.createElement("div",{className:"EightBitter",style:n.proliferate({position:"relative",width:t.width+"px",height:t.height+"px"},t.style)});n.canvas=n.createCanvas(t.width,t.height);n.PixelDrawer.setCanvas(n.canvas);n.container.appendChild(n.canvas)},t.prototype.scrollWindow=function(n,i){var r=t.prototype.ensureCorrectCaller(this);(n=n|0,i=i|0,n||i)&&(r.MapScreener.shift(n,i),r.shiftAll(-n,-i),r.QuadsKeeper.shiftQuadrants(-n,-i))},t.prototype.scrollThing=function(n,t,i){var r=n.left,u=n.top;n.GameStarter.scrollWindow(t,i);n.GameStarter.setLeft(n,r);n.GameStarter.setTop(n,u)},t.prototype.onAreaSpawn=function(n,t,i,r,u,f){n.MapsHandler.spawnMap(t,(i+n.MapScreener.top)/n.unitsize,(r+n.MapScreener.left)/n.unitsize,(u+n.MapScreener.top)/n.unitsize,(f+n.MapScreener.left)/n.unitsize)},t.prototype.onAreaUnspawn=function(n,t,i,r,u,f){n.MapsHandler.unspawnMap(t,(i+n.MapScreener.top)/n.unitsize,(r+n.MapScreener.left)/n.unitsize,(u+n.MapScreener.top)/n.unitsize,(f+n.MapScreener.left)/n.unitsize)},t.prototype.addThing=function(n,t,i){t===void 0&&(t=0);i===void 0&&(i=0);var r;if(r=typeof n=="string"||n instanceof String?this.ObjectMaker.make(n):n.constructor===Array?this.ObjectMaker.make.apply(this.ObjectMaker,n):n,arguments.length>2?(r.GameStarter.setLeft(r,t),r.GameStarter.setTop(r,i)):arguments.length>1&&r.GameStarter.setLeft(r,t),r.GameStarter.updateSize(r),r.GameStarter.GroupHolder.getFunctions().add[r.groupType](r),r.placed=!0,r.onThingAdd)r.onThingAdd(r);if(r.GameStarter.PixelDrawer.setThingSprite(r),r.onThingAdded)r.onThingAdded(r);return r.GameStarter.ModAttacher.fireEvent("onAddThing",r,t,i),r},t.prototype.thingProcess=function(n,t,i,r){var f=4,e,u;if(n.title=n.title||t,n.width&&!n.spritewidth&&(n.spritewidth=r.spritewidth||r.width),n.height&&!n.spriteheight&&(n.spriteheight=r.spriteheight||r.height),e=Math.floor(n.width*(n.GameStarter.unitsize/n.GameStarter.QuadsKeeper.getQuadrantWidth())),e>0&&(f+=(e+1)*f/2),e=Math.floor(n.height*n.GameStarter.unitsize/n.GameStarter.QuadsKeeper.getQuadrantHeight()),e>0&&(f+=(e+1)*f/2),n.maxquads=f,n.quadrants=new Array(f),n.spritewidth=n.spritewidth||n.width,n.spriteheight=n.spriteheight||n.height,n.spritewidthpixels=n.spritewidth*n.GameStarter.unitsize,n.spriteheightpixels=n.spriteheight*n.GameStarter.unitsize,n.canvas=n.GameStarter.createCanvas(n.spritewidthpixels,n.spriteheightpixels),n.context=n.canvas.getContext("2d"),n.imageData=n.context.getImageData(0,0,n.spritewidthpixels,n.spriteheightpixels),n.opacity!==1&&n.GameStarter.setOpacity(n,n.opacity),n.attributes&&n.GameStarter.thingProcessAttributes(n,n.attributes),n.onThingMake)n.onThingMake(n,i);n.GameStarter.setSize(n,n.width,n.height);n.GameStarter.setClassInitial(n,n.name||n.title);n.spriteCycle&&(u=n.spriteCycle,n.GameStarter.TimeHandler.addClassCycle(n,u[0],u[1]||null,u[2]||null));(u=n.spriteCycleSynched)&&n.GameStarter.TimeHandler.addClassCycleSynched(n,u[0],u[1]||null,u[2]||null);n.flipHoriz&&n.GameStarter.flipHoriz(n);n.flipVert&&n.GameStarter.flipVert(n);n.GameStarter.ModAttacher.fireEvent("onThingMake",n.GameStarter,n,t,i,r)},t.prototype.thingProcessAttributes=function(n,t){for(var i in t)n[i]&&(n.GameStarter.proliferate(n,t[i]),n.name?n.name+=" "+i:n.name=n.title+" "+i)},t.prototype.mapPlaceRandomCommands=function(n,t){for(var e=n.MapsCreator,u=n.MapsHandler,o=u.getPreThings(),s=u.getArea(),h=u.getMap(),i,f,r=0;r<t.length;r+=1)i=t[r],f={thing:i.title,x:i.left,y:i.top},i.arguments&&n.proliferateHard(f,i.arguments,!0),e.analyzePreSwitch(f,o,s,h)},t.prototype.onGamePlay=function(n){n.AudioPlayer.resumeAll();n.ModAttacher.fireEvent("onGamePlay")},t.prototype.onGamePause=function(n){n.AudioPlayer.pauseAll();n.ModAttacher.fireEvent("onGamePause")},t.prototype.canInputsTrigger=function(){return!0},t.prototype.gameStart=function(){this.ModAttacher.fireEvent("onGameStart")},t.prototype.markChanged=function(n){n.changed=!0},t.prototype.shiftVert=function(n,t,i){EightBittr.EightBittr.prototype.shiftVert(n,t);i||n.GameStarter.markChanged(n)},t.prototype.shiftHoriz=function(n,t,i){EightBittr.EightBittr.prototype.shiftHoriz(n,t);i||n.GameStarter.markChanged(n)},t.prototype.setTop=function(n,t){EightBittr.EightBittr.prototype.setTop(n,t);n.GameStarter.markChanged(n)},t.prototype.setRight=function(n,t){EightBittr.EightBittr.prototype.setRight(n,t);n.GameStarter.markChanged(n)},t.prototype.setBottom=function(n,t){EightBittr.EightBittr.prototype.setBottom(n,t);n.GameStarter.markChanged(n)},t.prototype.setLeft=function(n,t){EightBittr.EightBittr.prototype.setLeft(n,t);n.GameStarter.markChanged(n)},t.prototype.shiftBoth=function(n,t,i,r){t=t||0;i=i||0;n.noshiftx||(n.parallaxHoriz?n.GameStarter.shiftHoriz(n,n.parallaxHoriz*t,r):n.GameStarter.shiftHoriz(n,t,r));n.noshifty||(n.parallaxVert?n.GameStarter.shiftVert(n,n.parallaxVert*i,r):n.GameStarter.shiftVert(n,i,r))},t.prototype.shiftThings=function(n,t,i,r){for(var u=n.length-1;u>=0;u-=1)n[u].GameStarter.shiftBoth(n[u],t,i,r)},t.prototype.shiftAll=function(n,i){var r=t.prototype.ensureCorrectCaller(this);r.GroupHolder.callAll(r,r.shiftThings,n,i,!0)},t.prototype.setWidth=function(n,t,i,r){n.width=t;n.unitwidth=t*n.GameStarter.unitsize;i&&(n.spritewidth=t,n.spritewidthpixels=t*n.GameStarter.unitsize);r&&n.GameStarter.updateSize(n);n.GameStarter.markChanged(n)},t.prototype.setHeight=function(n,t,i,r){n.height=t;n.unitheight=t*n.GameStarter.unitsize;i&&(n.spriteheight=t,n.spriteheightpixels=t*n.GameStarter.unitsize);r&&n.GameStarter.updateSize(n);n.GameStarter.markChanged(n)},t.prototype.setSize=function(n,t,i,r,u){n.GameStarter.setWidth(n,t,r,u);n.GameStarter.setHeight(n,i,r,u)},t.prototype.updatePosition=function(n){n.GameStarter.shiftHoriz(n,n.xvel);n.GameStarter.shiftVert(n,n.yvel)},t.prototype.updateSize=function(n){n.unitwidth=n.width*n.GameStarter.unitsize;n.unitheight=n.height*n.GameStarter.unitsize;n.spritewidthpixels=n.spritewidth*n.GameStarter.unitsize;n.spriteheightpixels=n.spriteheight*n.GameStarter.unitsize;n.canvas.width=n.spritewidthpixels;n.canvas.height=n.spriteheightpixels;n.GameStarter.PixelDrawer.setThingSprite(n);n.GameStarter.markChanged(n)},t.prototype.reduceWidth=function(n,t,i){n.right-=t;n.width-=t/n.GameStarter.unitsize;i?n.GameStarter.updateSize(n):n.GameStarter.markChanged(n)},t.prototype.reduceHeight=function(n,t,i){n.top+=t;n.height-=t/n.GameStarter.unitsize;i?n.GameStarter.updateSize(n):n.GameStarter.markChanged(n)},t.prototype.increaseHeight=function(n,t,i){n.top-=t;n.height+=t/n.GameStarter.unitsize;n.unitheight=n.height*n.GameStarter.unitsize;i?n.GameStarter.updateSize(n):n.GameStarter.markChanged(n)},t.prototype.increaseWidth=function(n,t,i){n.right+=t;n.width+=t/n.GameStarter.unitsize;n.unitwidth=n.width*n.GameStarter.unitsize;i?n.GameStarter.updateSize(n):n.GameStarter.markChanged(n)},t.prototype.thingPauseVelocity=function(n,t){n.xvelOld=n.xvel||0;n.yvelOld=n.yvel||0;n.nofallOld=n.nofall||!1;n.nocollideOld=n.nocollide||!1;n.movementOld=n.movement||n.movementOld;n.nofall=n.nocollide=!0;n.xvel=n.yvel=0;t||(n.movement=undefined)},t.prototype.thingResumeVelocity=function(n,t){t||(n.xvel=n.xvelOld||0,n.yvel=n.yvelOld||0);n.movement=n.movementOld||n.movement;n.nofall=n.nofallOld||!1;n.nocollide=n.nocollideOld||!1},t.prototype.generateObjectKey=function(n){return n.GameStarter.MapsHandler.getArea().setting+" "+n.groupType+" "+n.title+" "+n.className},t.prototype.setClass=function(n,t){n.className=t;n.GameStarter.PixelDrawer.setThingSprite(n);n.GameStarter.markChanged(n)},t.prototype.setClassInitial=function(n,t){n.className=t},t.prototype.addClass=function(n,t){n.className+=" "+t;n.GameStarter.PixelDrawer.setThingSprite(n);n.GameStarter.markChanged(n)},t.prototype.addClasses=function(n){for(var t,r,u,f=[],i=1;i<arguments.length;i++)f[i-1]=arguments[i];for(r=0;r<f.length;r+=1)for(t=f[r],(t.constructor===String||typeof t=="string")&&(t=t.split(" ")),u=t.length-1;u>=0;u-=1)n.GameStarter.addClass(n,t[u])},t.prototype.removeClass=function(n,t){t&&(t.indexOf(" ")!==-1&&n.GameStarter.removeClasses(n,t),n.className=n.className.replace(new RegExp(" "+t,"gm"),""),n.GameStarter.PixelDrawer.setThingSprite(n))},t.prototype.removeClasses=function(n){for(var t,r,u,f=[],i=1;i<arguments.length;i++)f[i-1]=arguments[i];for(r=0;r<f.length;r+=1)for(t=f[r],(t.constructor===String||typeof t=="string")&&(t=t.split(" ")),u=t.length-1;u>=0;--u)n.GameStarter.removeClass(n,t[u])},t.prototype.hasClass=function(n,t){return n.className.indexOf(t)!==-1},t.prototype.switchClass=function(n,t,i){n.GameStarter.removeClass(n,t);n.GameStarter.addClass(n,i)},t.prototype.flipHoriz=function(n){n.flipHoriz=!0;n.GameStarter.addClass(n,"flipped")},t.prototype.flipVert=function(n){n.flipVert=!0;n.GameStarter.addClass(n,"flip-vert")},t.prototype.unflipHoriz=function(n){n.flipHoriz=!1;n.GameStarter.removeClass(n,"flipped")},t.prototype.unflipVert=function(n){n.flipVert=!1;n.GameStarter.removeClass(n,"flip-vert")},t.prototype.setOpacity=function(n,t){n.opacity=t;n.GameStarter.markChanged(n)},t.prototype.ensureCorrectCaller=function(n){if(!(n instanceof t))throw new Error("A function requires the scope ('this') to be the manipulated GameStartr object. Unfortunately, 'this' is a "+typeof this+".");return n},t.prototype.arrayDeleteThing=function(n,t,i){if((i===void 0&&(i=t.indexOf(n)),i!==-1)&&(t.splice(i,1),typeof n.onDelete=="function"))n.onDelete(n)},t.prototype.takeScreenshot=function(n,i){i===void 0&&(i="image/png");var r=t.prototype.ensureCorrectCaller(this),u=r.createElement("a",{download:n+"."+i.split("/")[1],href:r.canvas.toDataURL(i).replace(i,"image/octet-stream")});u.click()},t.prototype.addPageStyles=function(n){var e=t.prototype.ensureCorrectCaller(this),u=e.createElement("style",{type:"text/css"}),r="",i,f;for(i in n)if(n.hasOwnProperty(i)){r+=i+" { \r\n";for(f in n[i])n[i].hasOwnProperty(f)&&(r+="  "+f+": "+n[i][f]+";\r\n");r+="}\r\n"}u.styleSheet?u.style.cssText=r:u.appendChild(document.createTextNode(r));document.querySelector("head").appendChild(u)},t}(EightBittr.EightBittr);n.GameStartr=t}(GameStartr||(GameStartr={})),function(n){"use strict";var i=function(){function n(n){this.documentElement=document.documentElement;this.requestFullScreen=(this.documentElement.requestFullScreen||this.documentElement.webkitRequestFullScreen||this.documentElement.mozRequestFullScreen||this.documentElement.msRequestFullscreen||function(){console.warn("Not able to request full screen...")}).bind(this.documentElement);this.cancelFullScreen=(this.documentElement.cancelFullScreen||this.documentElement.webkitCancelFullScreen||this.documentElement.mozCancelFullScreen||this.documentElement.msCancelFullScreen||function(){console.warn("Not able to cancel full screen...")}).bind(document);this.customs=n.customs||{};this.GameStartrConstructor=n.GameStartrConstructor;this.settings=n;this.helpSettings=this.settings.helpSettings;this.globalName=n.globalName;this.importSizes(n.sizes);this.gameNameAlias=this.helpSettings.globalNameAlias||"{%%%%GAME%%%%}";this.gameElementSelector=n.gameElementSelector||"#game";this.gameControlsSelector=n.gameControlsSelector||"#controls";this.log=n.log||console.log.bind(console);this.isFullScreen=!1;this.setCurrentSize(this.sizes[n.sizeDefault]);this.allPossibleKeys=n.allPossibleKeys||["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","up","right","down","left","space","shift","ctrl"];this.GameStartrConstructor.prototype.proliferate(this.customs,this.currentSize,!0);this.resetGameStarter(n,this.customs)}return n.prototype.resetGameStarter=function(n,t){t===void 0&&(t={});this.loadGameStarter(this.fixCustoms(t||{}));window[n.globalName||"GameStarter"]=this.GameStarter;this.GameStarter.UserWrapper=this;this.loadGenerators();this.loadControls(n.schemas);n.styleSheet&&this.GameStarter.addPageStyles(n.styleSheet);this.resetPageVisibilityHandlers();this.GameStarter.gameStart()},n.prototype.getGameStartrConstructor=function(){return this.GameStartrConstructor},n.prototype.getGameStarter=function(){return this.GameStarter},n.prototype.getStatsHolder=function(){return this.StatsHolder},n.prototype.getSettings=function(){return this.settings},n.prototype.getCustoms=function(){return this.customs},n.prototype.getHelpSettings=function(){return this.helpSettings},n.prototype.getGlobalName=function(){return this.globalName},n.prototype.getGameNameAlias=function(){return this.gameNameAlias},n.prototype.getAllPossibleKeys=function(){return this.allPossibleKeys},n.prototype.getSizes=function(){return this.sizes},n.prototype.getCurrentSize=function(){return this.currentSize},n.prototype.getIsFullScreen=function(){return this.isFullScreen},n.prototype.getIsPageHidden=function(){return this.isPageHidden},n.prototype.getLog=function(){return this.log},n.prototype.getGenerators=function(){return this.generators},n.prototype.getDocumentElement=function(){return this.documentElement},n.prototype.getRequestFullScreen=function(){return this.requestFullScreen},n.prototype.getCancelFullScreen=function(){return this.cancelFullScreen},n.prototype.setCurrentSize=function(n){if(typeof n=="string"||n.constructor===String){if(!this.sizes.hasOwnProperty(n))throw new Error("Size "+n+" does not exist on the UserWrappr.");n=this.sizes[n]}this.customs=this.fixCustoms(this.customs);n.full?(this.requestFullScreen(),this.isFullScreen=!0):this.isFullScreen&&(this.cancelFullScreen(),this.isFullScreen=!1);this.currentSize=n;this.GameStarter&&(this.GameStarter.container.parentNode.removeChild(this.GameStarter.container),this.resetGameStarter(this.settings,this.customs))},n.prototype.displayHelpMenu=function(){this.helpSettings.openings.forEach(this.logHelpText.bind(this))},n.prototype.displayHelpOptions=function(){this.logHelpText("To focus on a group, enter `"+this.globalName+'.UserWrapper.displayHelpOption("<group-name>");`');Object.keys(this.helpSettings.options).forEach(this.displayHelpGroupSummary.bind(this));this.logHelpText("\nTo focus on a group, enter `"+this.globalName+'.UserWrapper.displayHelpOption("<group-name>");`')},n.prototype.displayHelpGroupSummary=function(n){var i=this.helpSettings.options[n],r,u=0,t;for(this.log("\n"+n),t=0;t<i.length;t+=1)u=Math.max(u,this.filterHelpText(i[t].title).length);for(t=0;t<i.length;t+=1)r=i[t],this.log(this.padTextRight(this.filterHelpText(r.title),u)+" ... "+r.description)},n.prototype.displayHelpOption=function(n){for(var e=this.helpSettings.options[n],t,r,u,i,f=0;f<e.length;f+=1){if(t=e[f],u=0,this.logHelpText(t.title+" -- "+t.description),t.usage&&this.logHelpText(t.usage),t.examples){for(i=0;i<t.examples.length;i+=1)r=t.examples[i],u=Math.max(u,this.filterHelpText("    "+r.code).length);for(i=0;i<t.examples.length;i+=1)r=t.examples[i],this.logHelpText(this.padTextRight(this.filterHelpText("    "+r.code),u)+"  // "+r.comment)}this.log("\n")}},n.prototype.logHelpText=function(n){this.log(this.filterHelpText(n))},n.prototype.filterHelpText=function(n){return n.replace(new RegExp(this.gameNameAlias,"g"),this.globalName)},n.prototype.padTextRight=function(n,t){var i=1+t-n.length;return i<=0?n:n+Array.call(Array,i).join(" ")},n.prototype.importSizes=function(n){var t;this.sizes=this.GameStartrConstructor.prototype.proliferate({},n);for(t in this.sizes)this.sizes.hasOwnProperty(t)&&(this.sizes[t].name=this.sizes[t].name||t)},n.prototype.fixCustoms=function(n){var t=this.GameStartrConstructor.prototype.proliferate({},n);return this.GameStartrConstructor.prototype.proliferate(t,this.currentSize),isFinite(t.width)||(t.width=document.body.clientWidth),isFinite(t.height)||(t.height=t.full?screen.height:this.isFullScreen?window.innerHeight-140:window.innerHeight,t.height-=84),t},n.prototype.resetPageVisibilityHandlers=function(){document.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this))},n.prototype.handleVisibilityChange=function(){switch(document.visibilityState){case"hidden":this.onPageHidden();return;case"visible":this.onPageVisible();return;default:return}},n.prototype.onPageHidden=function(){this.GameStarter.GamesRunner.getPaused()||(this.isPageHidden=!0,this.GameStarter.GamesRunner.pause())},n.prototype.onPageVisible=function(){this.isPageHidden&&(this.isPageHidden=!1,this.GameStarter.GamesRunner.play())},n.prototype.loadGameStarter=function(n){var t=document.querySelector(this.gameElementSelector);this.GameStarter&&this.GameStarter.GamesRunner.pause();this.GameStarter=new this.GameStartrConstructor(n);t.textContent="";t.appendChild(this.GameStarter.container);this.GameStarter.proliferate(document.body,{onkeydown:this.GameStarter.InputWriter.makePipe("onkeydown","keyCode"),onkeyup:this.GameStarter.InputWriter.makePipe("onkeyup","keyCode")});this.GameStarter.proliferate(t,{onmousedown:this.GameStarter.InputWriter.makePipe("onmousedown","which"),oncontextmenu:this.GameStarter.InputWriter.makePipe("oncontextmenu",null,!0)})},n.prototype.loadGenerators=function(){this.generators={OptionsButtons:new t.OptionsButtonsGenerator(this),OptionsTable:new t.OptionsTableGenerator(this),LevelEditor:new t.LevelEditorGenerator(this),MapsGrid:new t.MapsGridGenerator(this)}},n.prototype.loadControls=function(n){var i=document.querySelector(this.gameControlsSelector),r=n.length,t;for(this.StatsHolder=new StatsHoldr.StatsHoldr({prefix:this.globalName+"::UserWrapper::StatsHolder",proliferate:this.GameStarter.proliferate,createElement:this.GameStarter.createElement}),i.textContent="",i.className="length-"+r,t=0;t<r;t+=1)i.appendChild(this.loadControlDiv(n[t]))},n.prototype.loadControlDiv=function(n){var t=document.createElement("div"),r=document.createElement("h4"),i=document.createElement("div");return t.className="control",t.id="control-"+n.title,r.textContent=n.title,i.className="control-inner",i.appendChild(this.generators[n.generator].generate(n)),t.appendChild(r),t.appendChild(i),t.onmouseover=setTimeout.bind(undefined,function(){t.setAttribute("active","on")},35),t.onmouseout=function(){t.setAttribute("active","off")},t},n}(),t;n.UserWrappr=i,function(n){var t=function(){function n(n){this.UserWrapper=n;this.GameStarter=this.UserWrapper.getGameStarter()}return n.prototype.generate=function(){throw new Error("AbstractOptionsGenerator is abstract. Subclass it.");},n.prototype.getParentControlDiv=function(n){return n.className==="control"?n:n.parentNode?this.getParentControlDiv(n.parentElement):undefined},n.prototype.ensureLocalStorageValue=function(n,t,i){if(n.constructor===Array){this.ensureLocalStorageValues(n,t,i);return}var r=n,f=i.title+"::"+t.title,e=t.source.call(this,this.GameStarter).toString(),u;if(r.setAttribute("localStorageKey",f),this.GameStarter.StatsHolder.addItem(f,{storeLocally:!0,valueDefault:e}),u=this.GameStarter.StatsHolder.getItem(f),u!==""&&u!==r.value)if(r.value=u,r.setValue)r.setValue(u);else if(r.onchange)r.onchange(undefined);else if(r.onclick)r.onclick(undefined)},n.prototype.ensureLocalStorageValues=function(n,t,i){for(var o=i.title+"::"+t.title,s=t.source.call(this,this.GameStarter),f,e,r,u=0;u<n.length;u+=1)if(f=o+"::"+u,r=n[u],r.setAttribute("localStorageKey",f),this.GameStarter.StatsHolder.addItem(f,{storeLocally:!0,valueDefault:s[u]}),e=this.GameStarter.StatsHolder.getItem(f),e!==""&&e!==r.value)if(r.value=e,r.onchange)r.onchange(undefined);else if(r.onclick)r.onclick(undefined)},n.prototype.storeLocalStorageValue=function(n,t){var i=n.getAttribute("localStorageKey");i&&this.GameStarter.StatsHolder.setItem(i,t)},n}(),i,r,u,f;n.AbstractOptionsGenerator=t;i=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.generate=function(n){var r=document.createElement("div"),o=n.options instanceof Function?n.options.call(self,this.GameStarter):n.options,u=Object.keys(o),h=n.keyActive||"active",f="select-option options-button-option",e=this,s,t,i;for(r.className="select-options select-options-buttons",i=0;i<u.length;i+=1)s=o[u[i]],t=document.createElement("div"),t.className=f,t.textContent=u[i],t.onclick=function(n,t){e.getParentControlDiv(t).getAttribute("active")==="on"&&(n.callback.call(e,e.GameStarter,n,t),t.getAttribute("option-enabled")==="true"?(t.setAttribute("option-enabled","false"),t.className=f+" option-disabled"):(t.setAttribute("option-enabled","true"),t.className=f+" option-enabled"))}.bind(undefined,n,t),s[h]?(t.className+=" option-enabled",t.setAttribute("option-enabled","true")):n.assumeInactive?(t.className+=" option-disabled",t.setAttribute("option-enabled","false")):t.setAttribute("option-enabled","true"),r.appendChild(t);return r},t}(t);n.OptionsButtonsGenerator=i;r=function(n){function t(){n.apply(this,arguments);this.optionTypes={Boolean:this.setBooleanInput,Keys:this.setKeyInput,Number:this.setNumberInput,Select:this.setSelectInput,ScreenSize:this.setScreenSizeInput}}return __extends(t,n),t.prototype.generate=function(n){var u=document.createElement("div"),s=document.createElement("table"),r,o,t,f,e,h,i;if(u.className="select-options select-options-table",n.options)for(i=0;i<n.options.length;i+=1)t=document.createElement("tr"),f=document.createElement("td"),e=document.createElement("td"),r=n.options[i],f.className="options-label-"+r.type,f.textContent=r.title,e.className="options-cell-"+r.type,t.appendChild(f),t.appendChild(e),h=this.optionTypes[n.options[i].type].call(this,e,r,n),r.storeLocally&&this.ensureLocalStorageValue(h,r,n),s.appendChild(t);if(u.appendChild(s),n.actions)for(i=0;i<n.actions.length;i+=1)t=document.createElement("div"),o=n.actions[i],t.className="select-option options-button-option",t.textContent=o.title,t.onclick=o.action.bind(this,this.GameStarter),u.appendChild(t);return u},t.prototype.setBooleanInput=function(n,t){var r=t.source.call(this,this.GameStarter),u=r?"enabled":"disabled",i=this;return n.className="select-option options-button-option option-"+u,n.textContent=r?"on":"off",n.onclick=function(){n.setValue(n.textContent==="off")},n.setValue=function(r){r.constructor===String&&(r==="false"||r==="off"?r=!1:(r==="true"||r==="on")&&(r=!0));r?(t.enable.call(i,i.GameStarter),n.textContent="on",n.className=n.className.replace("disabled","enabled")):(t.disable.call(i,i.GameStarter),n.textContent="off",n.className=n.className.replace("enabled","disabled"));t.storeLocally&&i.storeLocalStorageValue(n,r.toString())},n},t.prototype.setKeyInput=function(n,t){for(var e=t.source.call(this,this.GameStarter),o=[],i,f=this,u,r=0;r<e.length;r+=1){for(i=document.createElement("select"),i.className="options-key-option",u=0;u<this.UserWrapper.getAllPossibleKeys().length;u+=1)i.appendChild(new Option(this.UserWrapper.getAllPossibleKeys()[u]));i.value=i.valueOld=e[r].toLowerCase();i.onchange=function(n){t.callback.call(f,f.GameStarter,n.valueOld,n.value);t.storeLocally&&f.storeLocalStorageValue(n,n.value)}.bind(undefined,i);o.push(i);n.appendChild(i)}return o},t.prototype.setNumberInput=function(n,t){var i=document.createElement("input"),r=this;return i.type="number",i.value=Number(t.source.call(r,r.GameStarter)).toString(),i.min=(t.minimum||0).toString(),i.max=(t.maximum||Math.max(t.minimum+10,10)).toString(),i.onchange=i.oninput=function(){i.checkValidity()&&t.update.call(r,r.GameStarter,i.value);t.storeLocally&&r.storeLocalStorageValue(i,i.value)},n.appendChild(i),i},t.prototype.setSelectInput=function(n,t){for(var i=document.createElement("select"),f=t.options(this.GameStarter),r=this,u=0;u<f.length;u+=1)i.appendChild(new Option(f[u]));return i.value=t.source.call(r,r.GameStarter),i.onchange=function(){t.update.call(r,r.GameStarter,i.value);i.blur();t.storeLocally&&r.storeLocalStorageValue(i,i.value)},n.appendChild(i),i},t.prototype.setScreenSizeInput=function(n,t,i){var r=this;return t.options=function(){return Object.keys(r.UserWrapper.getSizes())},t.source=function(){return r.UserWrapper.getCurrentSize().name},t.update=function(n,t){if(t===r.UserWrapper.getCurrentSize())return undefined;r.UserWrapper.setCurrentSize(t)},r.setSelectInput(n,t,i)},t}(t);n.OptionsTableGenerator=r;u=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.generate=function(){var n=document.createElement("div"),i=document.createElement("div"),t=document.createElement("div"),r=document.createElement("div"),u=this.createUploaderDiv(),f=this;return n.className="select-options select-options-level-editor",i.className="select-option-title",i.textContent="Create your own custom levels:",t.className="select-option select-option-large options-button-option",t.innerHTML="Start the <br /> Level Editor!",t.onclick=function(){f.GameStarter.LevelEditor.enable()},r.className="select-option-title",r.innerHTML="<em>- or -<\/em><br />",n.appendChild(i),n.appendChild(t),n.appendChild(r),n.appendChild(u),n},t.prototype.createUploaderDiv=function(){var n=document.createElement("div"),t=document.createElement("input");return n.className="select-option select-option-large options-button-option",n.textContent="Click to upload and continue your editor files!",n.setAttribute("textOld",n.textContent),t.type="file",t.className="select-upload-input",t.onchange=this.handleFileDrop.bind(this,t,n),n.ondragenter=this.handleFileDragEnter.bind(this,n),n.ondragover=this.handleFileDragOver.bind(this,n),n.ondragleave=t.ondragend=this.handleFileDragLeave.bind(this,n),n.ondrop=this.handleFileDrop.bind(this,t,n),n.onclick=t.click.bind(t),n.appendChild(t),n},t.prototype.handleFileDragEnter=function(n,t){t.dataTransfer&&(t.dataTransfer.dropEffect="copy");n.className+=" hovering"},t.prototype.handleFileDragOver=function(n,t){return t.preventDefault(),!1},t.prototype.handleFileDragLeave=function(n,t){t.dataTransfer&&(t.dataTransfer.dropEffect="none");n.className=n.className.replace(" hovering","")},t.prototype.handleFileDrop=function(n,t,i){var f=n.files||i.dataTransfer.files,r=f[0],u=new FileReader;this.handleFileDragLeave(n,i);i.preventDefault();i.stopPropagation();u.onprogress=this.handleFileUploadProgress.bind(this,r,t);u.onloadend=this.handleFileUploadCompletion.bind(this,r,t);u.readAsText(r)},t.prototype.handleFileUploadProgress=function(n,t,i){var r;i.lengthComputable&&(r=Math.round(i.loaded/i.total*100),r>100&&(r=100),t.innerText="Uploading '"+n.name+"' ("+r+"%)...")},t.prototype.handleFileUploadCompletion=function(n,t,i){this.GameStarter.LevelEditor.handleUploadCompletion(i);t.innerText=t.getAttribute("textOld")},t}(t);n.LevelEditorGenerator=u;f=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.generate=function(n){var t=document.createElement("div");return t.className="select-options select-options-maps-grid",n.rangeX&&n.rangeY&&t.appendChild(this.generateRangedTable(n)),n.extras&&this.appendExtras(t,n),t},t.prototype.generateRangedTable=function(n){for(var i=this,e=document.createElement("table"),o=n.rangeX,s=n.rangeY,r,t,f,u=s[0];u<=s[1];u+=1){for(r=document.createElement("tr"),r.className="maps-grid-row",f=o[0];f<=o[1];f+=1)t=document.createElement("td"),t.className="select-option maps-grid-option maps-grid-option-range",t.textContent=u+"-"+f,t.onclick=function(n){i.getParentControlDiv(t).getAttribute("active")==="on"&&n()}.bind(i,n.callback.bind(i,i.GameStarter,n,t)),r.appendChild(t);e.appendChild(r)}return e},t.prototype.appendExtras=function(n,t){var i,r,f,u;for(f in t.extras)if(t.extras.hasOwnProperty(f)&&(r=t.extras[f],i=document.createElement("div"),i.className="select-option maps-grid-option maps-grid-option-extra",i.textContent=r.title,i.setAttribute("value",r.title),i.onclick=r.callback.bind(this,this.GameStarter,t,i),n.appendChild(i),r.extraElements))for(u=0;u<r.extraElements.length;u+=1)n.appendChild(this.GameStarter.createElement.apply(this.GameStarter,r.extraElements[u]))},t}(t);n.MapsGridGenerator=f}(t=n.UISchemas||(n.UISchemas={}))}(UserWrappr||(UserWrappr={}));
//# sourceMappingURL=UserWrappr-0.2.0.min.js.map
